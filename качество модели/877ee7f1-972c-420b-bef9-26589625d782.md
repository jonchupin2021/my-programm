<font color='blue' size=5><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>

<font color='blue'>–ü—Ä–∏–≤–µ—Ç, –ê–ª–µ–∫—Å–∞–Ω–¥—Ä! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ü–∞–≤–µ–ª –ì—Ä–∏–≥–æ—Ä—å–µ–≤, –∏ —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç.<br>–ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å - –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —Ç–æ–±–æ–π –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—É.<br>–°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É! –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—â–∞—Ç—å—Å—è –Ω–∞ ¬´—Ç—ã¬ª.</font>
<details>
	<summary><u>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–º –º–æ–º–µ–Ω—Ç–∞–º (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ)</u>‚§µ</summary>
<font color='blue'>–Ø –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ü–≤–µ—Ç–∞, —á—Ç–æ–±—ã –±—ã–ª–æ —É–¥–æ–±–Ω–µ–µ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—Ç—å –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</font>


---


<font color='blue'>—Å–∏–Ω–∏–π —Ç–µ–∫—Å—Ç - –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è</font>

<font color='green'>‚úîÔ∏è –∏ –∑–µ–ª–µ–Ω—ã–π —Ç–µ–∫—Å—Ç - –≤—Å–µ –æ—Ç–ª–∏—á–Ω–æ</font>

<font color='orange'>‚ö†Ô∏è –∏ –æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ç–µ–∫—Å—Ç - —Å–¥–µ–ª–∞–Ω–æ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –æ–¥–Ω–∞–∫–æ –µ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –Ω–∞ —á—Ç–æ —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ</font>

<font color='red'>‚ùå –∏ –∫—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç - –µ—Å—Ç—å –Ω–µ–¥–æ—á–µ—Ç—ã</font>


</details>    
</br>
<font color='blue'>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Å–ª—É—á–∞–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–∞–±–æ—Ç—ã, —Ç–∞–∫ –±—É–¥–µ—Ç –ø—Ä–æ—â–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, –∫–∞–∫–∏–µ –±—ã–ª–∏ –Ω–µ–¥–æ—á–µ—Ç—ã, –∞ —Ç–∞–∫–∂–µ —Å—Ä–∞–∑—É —É–≤–∏–¥–µ—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ. </font>

<font color='blue'>–û—Ç–≤–µ—Ç—ã –Ω–∞ –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ª—É—á—à–µ —Ç–æ–∂–µ –ø–æ–º–µ—á–∞—Ç—å.
–ù–∞–ø—Ä–∏–º–µ—Ä:</font><font color='purple'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞</b></font>

<font color='blue'><b>–î–∞–≤–∞–π —Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å!</b></font>

<font color='blue' size=3><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2</b></font>

<font color='blue'>–ü—Ä–∏–≤–µ—Ç –µ—â–µ —Ä–∞–∑. –°–ø–∞—Å–∏–±–æ, –∑–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ —Ä–∞–±–æ—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è. –¢–æ–ª—å–∫–æ –æ–±–æ–∑–Ω–∞—á–∏–º, —á—Ç–æ —ç—Ç–æ –≤—Ç–æ—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è.</font>

<font color='blue' size=3><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3</b></font>

<font color='blue'>–ü—Ä–∏–≤–µ—Ç –µ—â–µ —Ä–∞–∑. –°–ø–∞—Å–∏–±–æ, –∑–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ —Ä–∞–±–æ—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.</font>

*–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞: —É–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–∏–±—ã–ª—å –º–∞–≥–∞–∑–∏–Ω–∞. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–¥–µ—Ä–∂–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤. 
    *–†–µ—à–µ–Ω–∏–µ: –ø–æ –¥–∞–Ω–Ω—ã–º –ø–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º —Å–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å –æ–ø–∏—Å—ã–≤–∞—é—â–∏—é –∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (—É–ø–∞–¥–µ—Ç –ª–∏ –æ–Ω–∞ –∏–ª–∏ –Ω–µ—Ç). –û—Ü–µ–Ω–∏—Ç—å –¥–æ—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–æ—Å—è—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –∏ –Ω–∞–π—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –ò—Å–ø–æ–ª—å–∑—É—è –º–æ–¥–µ–ª—å —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. 


##  –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö


```python
!pip install shap -q
!pip install phik  -q
!pip install matplotlib==3.5.0 -q
!pip install scikit-learn==1.3.2 -q
```


```python

import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import phik 
import shap
from sklearn.linear_model import LogisticRegression
from sklearn.neighbors import KNeighborsClassifier
from sklearn.svm import SVC
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import train_test_split, RandomizedSearchCV
from sklearn.preprocessing import MinMaxScaler, OneHotEncoder, OrdinalEncoder, StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.compose import ColumnTransformer
from sklearn.metrics import roc_auc_score
pd.set_option('display.max_columns', None)
%matplotlib inline
market_file = pd.read_csv('/datasets/market_file.csv')
market_money = pd.read_csv('/datasets/market_money.csv')
market_time = pd.read_csv('/datasets/market_time.csv')
money = pd.read_csv('/datasets/money.csv', sep=';', decimal=',')
```

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚úîÔ∏è\
<font color='green'> –•–æ—Ä–æ—à–µ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤! \
–ò–º–ø–æ—Ä—Ç—ã —Å–æ–±—Ä–∞–Ω—ã –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ, —Å–≥—Ä—É–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –ú–æ–∂–Ω–æ –µ—â—ë —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≥—Ä—É–ø–ø—ã –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π.</font>

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚ö†Ô∏è\
<font color='darkorange'> –ü–∏–ø—ã –∏ –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –ª—É—á—à–µ —Ä–∞–∑–º–µ—â–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –∏–º–ø–æ—Ä—Ç–æ–≤, —á—Ç–æ –±—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–¥, –µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–æ–ø–æ–ª–Ω—è—Ç—å –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç—ã.</font>

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>

–ü–æ—Å–º–æ—Ç—Ä–∏–º —Ñ–∞–π–ª—ã

–í–Ω–∞—á–∞–ª–µ –ø–µ—Ä–≤—ã–π


```python
market_file.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>–¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞</th>
      <th>–†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–û—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>–°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>215348</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–¥–∞</td>
      <td>3.4</td>
      <td>5</td>
      <td>121</td>
      <td>0.00</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>215349</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–¥–∞</td>
      <td>4.4</td>
      <td>4</td>
      <td>819</td>
      <td>0.75</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>215350</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>4.9</td>
      <td>3</td>
      <td>539</td>
      <td>0.14</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>215351</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç—Ç</td>
      <td>–¥–∞</td>
      <td>3.2</td>
      <td>5</td>
      <td>896</td>
      <td>0.99</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>215352</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>5.1</td>
      <td>3</td>
      <td>1064</td>
      <td>0.94</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




```python
market_file.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1300 entries, 0 to 1299
    Data columns (total 13 columns):
     #   Column                               Non-Null Count  Dtype  
    ---  ------                               --------------  -----  
     0   id                                   1300 non-null   int64  
     1   –ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å            1300 non-null   object 
     2   –¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞                          1300 non-null   object 
     3   –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–æ–±—â–∞—Ç—å                   1300 non-null   object 
     4   –ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å                   1300 non-null   float64
     5   –ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å                 1300 non-null   int64  
     6   –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                         1300 non-null   int64  
     7   –ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏                    1300 non-null   float64
     8   –ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è                 1300 non-null   object 
     9   –°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç  1300 non-null   int64  
     10  –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª   1300 non-null   int64  
     11  –û—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞                       1300 non-null   int64  
     12  –°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç                     1300 non-null   int64  
    dtypes: float64(2), int64(7), object(4)
    memory usage: 132.2+ KB



```python
market_money.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ü–µ—Ä–∏–æ–¥</th>
      <th>–í—ã—Ä—É—á–∫–∞</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>215348</td>
      <td>–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>215348</td>
      <td>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>3293.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>215348</td>
      <td>–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>215349</td>
      <td>–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>4472.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>215349</td>
      <td>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>4971.6</td>
    </tr>
  </tbody>
</table>
</div>




```python
market_money.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 3900 entries, 0 to 3899
    Data columns (total 3 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   id       3900 non-null   int64  
     1   –ü–µ—Ä–∏–æ–¥   3900 non-null   object 
     2   –í—ã—Ä—É—á–∫–∞  3900 non-null   float64
    dtypes: float64(1), int64(1), object(1)
    memory usage: 91.5+ KB


–û—à–∏–±–æ–∫ –∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–µ—Ç


```python
market_time.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ü–µ—Ä–∏–æ–¥</th>
      <th>–º–∏–Ω—É—Ç</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>215348</td>
      <td>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>215348</td>
      <td>–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>215349</td>
      <td>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>215349</td>
      <td>–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>215350</td>
      <td>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div>




```python
market_time.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2600 entries, 0 to 2599
    Data columns (total 3 columns):
     #   Column  Non-Null Count  Dtype 
    ---  ------  --------------  ----- 
     0   id      2600 non-null   int64 
     1   –ü–µ—Ä–∏–æ–¥  2600 non-null   object
     2   –º–∏–Ω—É—Ç   2600 non-null   int64 
    dtypes: int64(2), object(1)
    memory usage: 61.1+ KB


–û—à–∏–±–æ–∫ –∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–µ—Ç


```python
money.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ü—Ä–∏–±—ã–ª—å</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>215348</td>
      <td>0.98</td>
    </tr>
    <tr>
      <th>1</th>
      <td>215349</td>
      <td>4.16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>215350</td>
      <td>3.13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>215351</td>
      <td>4.87</td>
    </tr>
    <tr>
      <th>4</th>
      <td>215352</td>
      <td>4.21</td>
    </tr>
  </tbody>
</table>
</div>




```python
money.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1300 entries, 0 to 1299
    Data columns (total 2 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   id       1300 non-null   int64  
     1   –ü—Ä–∏–±—ã–ª—å  1300 non-null   float64
    dtypes: float64(1), int64(1)
    memory usage: 20.4 KB


–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É.

–î–∞–Ω–Ω—ã–µ –≥–æ—Ç–æ–≤—ã –∫ –¥–∞–ª—å–Ω–µ–π—â–µ–º—É –∞–Ω–∞–ª–∏–∑—É

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚úîÔ∏è\
<font color='green'>–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø–µ—Ä–≤–∏—á–Ω—ã–π –æ—Å–º–æ—Ç—Ä –ø—Ä–æ–≤–µ–¥–µ–Ω.</font>

## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤


```python
# –≤—ã–≤–µ–¥–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–µ—Ä–≤–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
market_file.columns
```




    Index(['id', '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å', '–¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞', '–†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–æ–±—â–∞—Ç—å',
           '–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å', '–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å', '–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
           '–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', '–ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è',
           '–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
           '–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', '–û—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞',
           '–°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç'],
          dtype='object')



–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞–¥–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–∞–∫ —á—Ç–æ–±—ã –æ—â–∏–±–æ–∫ –≤ –∏—Ö –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –Ω–µ –±—ã–ª–æ. –î–ª—è —ç—Ç–æ–≥–æ –≤—Å–µ –ü—Ä–æ–ø–∏—Å–Ω—ã–µ –±—É–∫–≤—ã –∏ –ø—Ä–æ–±–µ–ª—ã –Ω–∞–¥–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å—Ç—Ä–æ—á–Ω—ã–µ –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è.


```python
market_file.columns=[ x.lower().replace(' ','_') for x in market_file.columns ]
market_file.columns
```




    Index(['id', '–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å', '—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞', '—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å',
           '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å', '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å', '–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
           '–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', '–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è',
           '—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
           '–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', '–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞',
           '—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç'],
          dtype='object')



<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
<font color='green'> –û—Ç–ª–∏—á–Ω–æ!  üëç</font>

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ùå\
<font color='red'> ~~–ù—É–∂–Ω–æ –¥–∞–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º (–∫–æ–ª–æ–Ω–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã). –¢–≤–æ–∏–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º –±—É–¥—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥—Ä—É–≥–∏–µ –ª—é–¥–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–µ–Ω–∞ –±—É–¥—É—Ç —Å–∏–ª—å–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–æ–¥–∞.~~</font>


<font color='purpure'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞: </b></font> ‚ùå\
<font color='purpure'>–í—Å–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —è–≤–ª—è—é—Ç—Å—è –ª–∏–±–æ –∞–±–≤–µ–∞—Ç—É—Ä–∞–º–∏ –ª–∏–±–æ —Å–≤—è–∑–∞–Ω—ã —Å –∑–Ω–∞—á–µ–Ω–∏—è–º. –ß—Ç–æ–±—ã –ø—Ä–æ—â–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è.</font>

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚ùå\
<font color='red'><s>–Ø –ø–æ–Ω–∏–º–∞—é —Ç–≤–æ—é —Ç–æ—á–∫—É –∑—Ä–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–∏, –∏ –Ω–∞–ª–∏—á–∏–µ —Å–ª–æ–≤–∞—Ä—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–º–æ–≥–∞–µ—Ç –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, —Å—Ç–æ–∏—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –∫—Ä–æ–º–µ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞, –≤–∞–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –µ–≥–æ –ª–µ–≥–∫–æ—Å—Ç—å –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ. –ß–∏—Ç–∞–µ–º—ã–µ –∏–º–µ–Ω–∞ —Å–Ω–∏–∂–∞—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –±—É–¥—É—â–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∫–∞–∫ —è—Å–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç —Å–º—ã—Å–ª –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –∫–æ–¥ –±—É–¥–µ—Ç –∞—É–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è, –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –¥—Ä—É–≥–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.

<font color='red'>–ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ç–≤–æ–π —Å–ª–æ–≤–∞—Ä—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —à–∞–≥ –≤ –ø—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. –î–ª—è –Ω–æ–≤—ã—Ö —á–ª–µ–Ω–æ–≤ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ —ç—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π –ø—É—Ç–∞–Ω–∏—Ü—ã –∏ —É–≤–µ–ª–∏—á–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç. –ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–∑–≤–æ–ª—è—Ç –ª–µ–≥–∫–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –æ—Ç –æ–¥–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫ –¥—Ä—É–≥–æ–º—É –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ —Å–ª–æ–≤–∞—Ä—é.</font>

<font color='red'>–ò–º–µ–Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É (lower) –∏ –∑–∞–º–µ–Ω–∏—Ç—å –ø—Ä–æ–±–µ–ª—ã –Ω–∞ –ø–æ–¥—á—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è (replace). –≠—Ç–æ –ø—Ä–æ—â–µ –∏ —á–∏—Ç–∞–±–µ–ª—å–Ω–µ–µ, —á–µ–º —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å —Å–ª–æ–≤–∞—Ä—å. –ò –Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç PEP. –ö–∞–∫ —Ç–µ–±–µ —Ç–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç?</s></font>


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å
market_file.sample(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>206</th>
      <td>215554</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>3.4</td>
      <td>3</td>
      <td>1017</td>
      <td>0.35</td>
      <td>–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>935</th>
      <td>216283</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>5.7</td>
      <td>5</td>
      <td>471</td>
      <td>0.19</td>
      <td>–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã</td>
      <td>4</td>
      <td>2</td>
      <td>4</td>
      <td>8</td>
    </tr>
    <tr>
      <th>119</th>
      <td>215467</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>4.4</td>
      <td>4</td>
      <td>503</td>
      <td>0.90</td>
      <td>–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1079</th>
      <td>216427</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>3.9</td>
      <td>5</td>
      <td>513</td>
      <td>0.30</td>
      <td>–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>9</td>
    </tr>
    <tr>
      <th>390</th>
      <td>215738</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–Ω–µ—Ç</td>
      <td>4.6</td>
      <td>5</td>
      <td>187</td>
      <td>0.23</td>
      <td>–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



–ø–æ–≤—Ç–æ—Ä–∏–º –¥–ª—è –¥—Ä—É–≥–∏—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤


```python
# –≤—ã–≤–µ–¥–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –≤—Ç–æ—Ä–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
market_money.columns
```




    Index(['id', '–ü–µ—Ä–∏–æ–¥', '–í—ã—Ä—É—á–∫–∞'], dtype='object')



–ü—Ä–∏–≤–µ–¥–µ–º –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∫ —Å—Ç—Ä–æ—á–Ω—ã–º –±—É–∫–≤–∞–º. –ò–∑–º–µ–Ω–∏–º –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å —Å—É—Ç—å.


```python
column_mapping = {
    '–ü–µ—Ä–∏–æ–¥': '–º–µ—Å—è—Ü',
    '–í—ã—Ä—É—á–∫–∞': '–ø—Ä–∏–±—ã–ª—å'
}

market_money.rename(columns=column_mapping, inplace=True)
```


```python
#—Ç–µ–ø–µ—Ä—å –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ñ–∞–π–ª, –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
market_money.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–º–µ—Å—è—Ü</th>
      <th>–ø—Ä–∏–±—ã–ª—å</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>215348</td>
      <td>–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>215348</td>
      <td>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>3293.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>215348</td>
      <td>–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>215349</td>
      <td>–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>4472.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>215349</td>
      <td>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>4971.6</td>
    </tr>
  </tbody>
</table>
</div>



–ø–æ—Å–º–æ—Ç—Ä–∏–º —Ç—Ä–µ—Ç–∏–π —Ñ–∞–π–ª


```python
# –≤—ã–≤–µ–¥–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç—Ä–µ—Ç—å–µ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
market_time.columns
```




    Index(['id', '–ü–µ—Ä–∏–æ–¥', '–º–∏–Ω—É—Ç'], dtype='object')



–ò–∑–º–µ–Ω–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —ç—Ç–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞.


```python
column_mapping = {
    '–ü–µ—Ä–∏–æ–¥': '–º–µ—Å—è—Ü',
    '–º–∏–Ω—É—Ç': '–º–∏–Ω—É—Ç—ã'
}

market_time.rename(columns=column_mapping, inplace=True)
```


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å
market_time.sample(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–º–µ—Å—è—Ü</th>
      <th>–º–∏–Ω—É—Ç—ã</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1835</th>
      <td>216265</td>
      <td>–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1095</th>
      <td>215895</td>
      <td>–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>11</td>
    </tr>
    <tr>
      <th>229</th>
      <td>215462</td>
      <td>–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1500</th>
      <td>216098</td>
      <td>–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>15</td>
    </tr>
    <tr>
      <th>251</th>
      <td>215473</td>
      <td>–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –≤—ã–≤–µ–¥–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —á–µ—Ç–≤–µ—Ä—Ç–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
money.columns
```




    Index(['id', '–ü—Ä–∏–±—ã–ª—å'], dtype='object')




```python
# –ø—Ä–∏–≤–µ–¥–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫ –Ω–æ—Ä–º–∞
money.rename(columns={'–ü—Ä–∏–±—ã–ª—å': '–ø—Ä–∏–±—ã–ª—å'}, inplace=True)
```


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å
money.sample(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø—Ä–∏–±—ã–ª—å</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>618</th>
      <td>215966</td>
      <td>2.35</td>
    </tr>
    <tr>
      <th>1270</th>
      <td>216618</td>
      <td>4.15</td>
    </tr>
    <tr>
      <th>416</th>
      <td>215764</td>
      <td>3.58</td>
    </tr>
    <tr>
      <th>615</th>
      <td>215963</td>
      <td>4.50</td>
    </tr>
    <tr>
      <th>47</th>
      <td>215395</td>
      <td>3.28</td>
    </tr>
  </tbody>
</table>
</div>



–ë—ã–ª–æ –∏–∑–º–µ–Ω–∏–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤, –ø—Ä–∏–≤–µ–ª–∏ –∏—Ö –∫ –æ–±—â–µ–ø—Ä–∏–Ω—è—Ç–æ–º—É –≤–∏–¥—É.
–ü—Ä–æ–¥–æ–ª–∂–∏–º –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö.
–ü–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –Ω–∞—á–Ω–µ–º –ø–æ–∏—Å–∫ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –∞–Ω–æ–º–∞–ª–∏–π.

–î–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–∞–ª–∏—á–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö, —á—Ç–æ–±—ã –≤—ã—è–≤–∏—Ç—å –æ–ø–µ—á–∞—Ç–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö.


```python
market_file.head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>215348</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–¥–∞</td>
      <td>3.4</td>
      <td>5</td>
      <td>121</td>
      <td>0.0</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Å—Ç—Ä–æ–∫–∏) –≤ –ø–µ—Ä–≤–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ
print("–î–∞—Ç–∞—Ñ—Ä–µ–π–º market_file")
for i in ['–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å','—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞','—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å','–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è']:
    print('—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞',i,':',market_file[i].unique())
```

    –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_file
    —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å : ['–°–Ω–∏–∑–∏–ª–∞—Å—å' '–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å']
    —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ —Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞ : ['–ø—Ä–µ–º–∏—É–º' '—Å—Ç–∞–Ω–¥–∞—Ä—Ç—Ç' '—Å—Ç–∞–Ω–¥–∞—Ä—Ç']
    —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ —Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å : ['–¥–∞' '–Ω–µ—Ç']
    —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è : ['–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π' '–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å' '–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã'
     '–¢–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã –∏ –∑–¥–æ—Ä–æ–≤—å—è' '–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞'
     '–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞']


–ò—Ç–∞–∫, –≤ —Å—Ç–æ–ª–±—Ü–µ `—Å–µ—Ä–≤–∏—Å` –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ `market_file` –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞—Å—å –æ–ø–µ—á–∞—Ç–∫–∞ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ `—Å—Ç–∞–Ω–¥–∞—Ä—Ç`, –∏—Å–ø—Ä–∞–≤–∏–º –µ–µ.


```python
market_file['—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞'] = market_file['—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞'].replace('—Å—Ç–∞–Ω–¥–∞—Ä—Ç—Ç', '—Å—Ç–∞–Ω–¥–∞—Ä—Ç')
```

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å
market_file['—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞'].unique()
```




    array(['–ø—Ä–µ–º–∏—É–º', '—Å—Ç–∞–Ω–¥–∞—Ä—Ç'], dtype=object)



–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –æ–ø–µ—á–∞—Ç–∫–∏ –≤ –ø–µ—Ä–≤–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.


```python
# —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Ç–æ—Ä–æ–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º
market_money.head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–º–µ—Å—è—Ü</th>
      <th>–ø—Ä–∏–±—ã–ª—å</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>215348</td>
      <td>–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å—Ç–æ–ª–±–µ—Ü "–º–µ—Å—è—Ü"
print("–î–∞—Ç–∞—Ñ—Ä–µ–π–º market_money \n","–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–µ –º–µ—Å—è—Ü:",market_money['–º–µ—Å—è—Ü'].unique())

```

    –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_money 
     –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–µ –º–µ—Å—è—Ü: ['–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü' '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü' '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü']


–ò—Ç–∞–∫, –≤ —Å—Ç–æ–ª–±—Ü–µ `period` –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ `market_money` –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞—Å—å –æ–ø–µ—á–∞—Ç–∫–∞ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ `–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü`, –≤ —Å–ª–æ–≤–µ –ø—Ä–æ–ø—É—â–µ–Ω–∞ –±—É–∫–≤–∞ `–î` (–ø—Ä–∏—Å—Ç–∞–≤–∫–∞ "–ø—Ä–µ–¥", –ø–∏—à–µ–º "–ø—Ä–µ–î–ø—Ä–µ–¥—ã–¥—É—â–∏–π"), –∏—Å–ø—Ä–∞–≤–∏–º –æ—à–∏–±–∫—É.


```python
market_money['–º–µ—Å—è—Ü'] = market_money['–º–µ—Å—è—Ü'].replace('–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü')
```

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å
market_money['–º–µ—Å—è—Ü'].unique()
```




    array(['–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü', '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü'],
          dtype=object)



–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –æ–ø–µ—á–∞—Ç–∫–∏ –≤–æ –≤—Ç–æ—Ä–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.


```python
# —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç—Ä–µ—Ç–∏–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º
print("–î–∞—Ç–∞—Ñ—Ä–µ–π–º market_time \n","–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–µ –º–µ—Å—è—Ü:",market_time['–º–µ—Å—è—Ü'].unique())

```

    –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_time 
     –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–µ –º–µ—Å—è—Ü: ['—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü' '–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü']


–í —Å—Ç–æ–ª–±—Ü–µ `period` –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ `market_time` –º—ã –≤–∏–¥–∏–º –æ–ø–µ—á–∞—Ç–∫—É –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ `–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü` (–±—É–∫–≤–∞ `—Ü` –≤–º–µ—Å—Ç–æ –±—É–∫–≤—ã `—É`), –∏—Å–ø—Ä–∞–≤–∏–º –µ–µ.


```python
market_time['–º–µ—Å—è—Ü'] = market_time['–º–µ—Å—è—Ü'].replace('–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü', '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü')
```

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å
market_time['–º–µ—Å—è—Ü'].unique()
```




    array(['—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü', '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü'], dtype=object)



–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –æ–ø–µ—á–∞—Ç–∫–∏ –≤ —Ç—Ä–µ—Ç—å–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.

–í —á–µ—Ç–≤–µ—Ä—Ç–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –Ω–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–ø–µ—á–∞—Ç–∫–∏ –Ω–µ –±—É–¥–µ–º.

–ü—Ä–æ–≤–µ—Ä–∏–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –Ω–∞ —è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã.


```python
market_file.duplicated().sum()
```




    0




```python
market_money.duplicated().sum()
```




    0




```python
market_time.duplicated().sum()
```




    0




```python
money.duplicated().sum()
```




    0



–Ø–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –ø—Ä–µ–¥–æ—Ç—Å–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã.

**–í—ã–≤–æ–¥**

–í —Ö–æ–¥–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª–∏ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Å —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è –Ω–∞ —Å–ª–æ–≤–æ –∏–ª–∏ –∞–±–≤–µ–∞—Ç—É—Ä—É, —Å –Ω–∏–∂–Ω–∏–º–∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è–º–∏ –∏ –±–µ–∑ –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤. –î–∞–ª–µ–µ –±—ã–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –æ–ø–µ—á–∞—Ç–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞—è–≤–ª–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º, –ø–æ—ç—Ç–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è. –ü—Ä–æ–¥–æ–ª–∂–∏–º —Ä–∞–±–æ—Ç—É.

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚úîÔ∏è <br>
<font color='green'>–ó–¥–æ—Ä–æ–≤–æ, —á—Ç–æ –Ω–µ –∑–∞–±—ã–≤–∞–µ—à—å –ø—Ä–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã.</font>

## –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º `market_file`


```python
# –ø—Ä–æ—Å–º–æ—Ç—Ä–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_file
market_file.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>1300.0</td>
      <td>215997.500000</td>
      <td>375.421985</td>
      <td>215348.0</td>
      <td>215672.75</td>
      <td>215997.50</td>
      <td>216322.25</td>
      <td>216647.00</td>
    </tr>
    <tr>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <td>1300.0</td>
      <td>4.253769</td>
      <td>1.014814</td>
      <td>0.9</td>
      <td>3.70</td>
      <td>4.20</td>
      <td>4.90</td>
      <td>6.60</td>
    </tr>
    <tr>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <td>1300.0</td>
      <td>4.011538</td>
      <td>0.696868</td>
      <td>3.0</td>
      <td>4.00</td>
      <td>4.00</td>
      <td>4.00</td>
      <td>5.00</td>
    </tr>
    <tr>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <td>1300.0</td>
      <td>601.898462</td>
      <td>249.856289</td>
      <td>110.0</td>
      <td>405.50</td>
      <td>606.00</td>
      <td>806.00</td>
      <td>1079.00</td>
    </tr>
    <tr>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <td>1300.0</td>
      <td>0.319808</td>
      <td>0.249843</td>
      <td>0.0</td>
      <td>0.17</td>
      <td>0.24</td>
      <td>0.30</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <td>1300.0</td>
      <td>3.270000</td>
      <td>1.355350</td>
      <td>1.0</td>
      <td>2.00</td>
      <td>3.00</td>
      <td>4.00</td>
      <td>6.00</td>
    </tr>
    <tr>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <td>1300.0</td>
      <td>2.840000</td>
      <td>1.971451</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>3.00</td>
      <td>4.00</td>
      <td>10.00</td>
    </tr>
    <tr>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <td>1300.0</td>
      <td>4.185385</td>
      <td>1.955298</td>
      <td>0.0</td>
      <td>3.00</td>
      <td>4.00</td>
      <td>6.00</td>
      <td>9.00</td>
    </tr>
    <tr>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <td>1300.0</td>
      <td>8.176923</td>
      <td>3.978126</td>
      <td>1.0</td>
      <td>5.00</td>
      <td>8.00</td>
      <td>11.00</td>
      <td>20.00</td>
    </tr>
  </tbody>
</table>
</div>



–ò–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º—ã –≤–∏–¥–∏–º, —á—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ **—Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π** (`–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å`) –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤, —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `4.25` –µ–¥., —Å—Ä–µ–¥–Ω–µ–µ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ** (`–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å`) –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è ‚Äî `4` –µ–¥.

–í **—Å—Ä–µ–¥–Ω–µ–º** –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–∞–π—Ç–æ–º –º–∞–≥–∞–∑–∏–Ω–∞ **—Å –º–æ–º–µ–Ω—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏** (`–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å`) –æ–∫–æ–ª–æ 2—Ö –ª–µ—Ç (`602` –¥–Ω—è), **–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è** –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∞–π—Ç–æ–º —Å –º–æ–º–µ–Ω—Ç–∞ —Ä–µ—à–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ 4 –º–µ—Å (`110` –¥–Ω–µ–π), **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è** ‚Äî –æ–∫–æ–ª–æ 3—Ö –ª–µ—Ç (`1079` –¥–Ω–µ–π).

–°—Ä–µ–¥–Ω—è—è **—Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–∞—è –¥–æ–ª—è –ø–æ–∫—É–ø–æ–∫ –ø–æ –∞–∫—Ü–∏–∏ –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–∫—É–ø–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤** (`–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏`) —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `0.32`, –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–∫—Ü–∏—è–º–∏ (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è `0.0`), –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å–µ –ø–æ–∫—É–ø–∞—é—Ç –ø–æ –∞–∫—Ü–∏–∏ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è `0.99`).

–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–≥–æ, **—Å–∫–æ–ª—å–∫–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª –∑–∞ –≤–∏–∑–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞** (`—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç`), —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `3.27` –µ–¥., **–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** —Ä–∞–≤–Ω–æ `1 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏`, **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ** ‚Äî `6 –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º`.

**–û–±—â–µ–µ —á–∏—Å–ª–æ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞** (`–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª	`) –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `2.84` –µ–¥., –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî `0`, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ ‚Äî `10`.

**–ß–∏—Å–ª–æ —Å–±–æ–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Å–Ω—É–ª–∏—Å—å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –≤–æ –≤—Ä–µ–º—è –ø–æ—Å–µ—â–µ–Ω–∏—è —Å–∞–π—Ç–∞** (`–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞`), –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `4.2` –µ–¥., –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Å–∞–π—Ç–æ–º –º–æ–∂–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫ (**–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** ‚Äî `0`), –Ω–æ –∏–Ω–æ–≥–¥–∞ —Å–±–æ–µ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ (**–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** ‚Äî `9`).

–í —Å—Ä–µ–¥–Ω–µ–º **—Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –∑–∞ –æ–¥–∏–Ω –≤–∏–∑–∏—Ç –Ω–∞ —Å–∞–π—Ç –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞**(`—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç	`), —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `8.2`—Å—Ç—Ä., **–º–∏–Ω–∏–º—É–º** –∑–∞ –≤–∏–∑–∏—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª—å —Å–º–æ—Ç—Ä–∏—Ç `1 —Å—Ç—Ä.`, –∞ **–º–∞–∫—Å–∏–º—É–º** ‚Äî `20 —Å—Ç—Ä.`

#### –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ –Ω–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏–∏: –±—É–¥–µ–º —Å—Ç—Ä–æ–∏—Ç—å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –∏ —è—â–∏–∫–∏ —Å —É—Å–∞–º–∏ –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ —Ä–∞–∑—Ä–µ–∑–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ (—Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏), —Ä–∞–∑–¥–µ–ª–∏–º –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –Ω–∞ –¥–≤–∞ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞: –≤ –æ–¥–Ω–æ–º –æ—Å—Ç–∞–Ω—É—Ç—Å—è –æ–±—ä–µ–∫—Ç—ã —Å–æ —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é (`decr`), –≤–æ –≤—Ç–æ—Ä–æ–º ‚Äî —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –Ω–∞ –ø—Ä–µ–∂–Ω–µ–º —É—Ä–æ–≤–Ω–µ (`stab`). —Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤—ã–¥–µ–ª–∏—Ç—å –Ω—É–∂–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.


```python
# –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –¥–∞–Ω–Ω—ã–º–∏, –≥–¥–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∑–∏–ª–∞—Å—å
decr = market_file.query("–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å == '–°–Ω–∏–∑–∏–ª–∞—Å—å'")
decr.shape #–ø–æ—Å–º–æ—Ç—Ä–∏–º —Ä–∞–∑–º–µ—Ä
```




    (498, 13)




```python
# –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –¥–∞–Ω–Ω—ã–º–∏, –≥–¥–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ –ø—Ä–µ–∂–Ω–µ–º —É—Ä–æ–≤–Ω–µ
stab = market_file.query("–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å == '–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å'")
stab.shape #–æ–ø—Ä–µ–ª–¥–µ–ª–∏–º —Å–∫–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —Å –ø–æ–Ω–∏–∂–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é
```




    (802, 13)



–î–∞—Ç–∞—Ñ—Ä–µ–π–º, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Å—Ç–∞–ª–∞—Å—å –Ω–∞ –ø—Ä–µ–∂–Ω–µ–º —É—Ä–æ–≤–Ω–µ, –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –≤—Ç–æ—Ä–æ–≥–æ. –ù–æ –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ –Ω–∞–¥–æ –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–¥–∏—Ç—å –æ–±—â–∏–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏.

–ü—Ä–∏—Å—Ç—É–ø–∏–º –∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é –≥—Ä–∞—Ñ–∏–∫–æ–≤. –î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞: —Å –ø–æ–¥–ø–∏—Å—è–º–∏ –∏ —Ü–≤–µ—Ç–æ–º.


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º
def plot_hist(df1, df2, column):
    plt.figure(figsize=(10, 6))

    # –¥–ª—è —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    plt.subplot(1, 2, 2)
    plt.hist(df1[column], bins=10, alpha=0.5, color="blue")
    plt.title("–°–Ω–∏–∂–µ–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å")
    plt.xlabel(column)
    plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")

    # –¥–ª—è –ø—Ä–µ–∂–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    plt.subplot(1, 2, 1)
    plt.hist(df2[column], bins=10, alpha=0.5, color="green")
    plt.title("–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏")
    plt.xlabel(column)
    plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")

    plt.tight_layout()
    plt.show()
    
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —è—â–∏–∫–æ–≤ —Å —É—Å–∞–º–∏     
def plot_box(df1, df2, column):
    plt.figure(figsize=(10, 6))

    # –¥–ª—è —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    plt.subplot(1, 2, 2)
    sns.boxplot(data=df1, y=column, color='blue')
    plt.title("–°–Ω–∏–∂–µ–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å")
    plt.ylabel(column)

    # –¥–ª—è –ø—Ä–µ–∂–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    plt.subplot(1, 2, 1)
    sns.boxplot(data=df2, y=column, color='green')
    plt.title("–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏")
    plt.ylabel(column)

    plt.tight_layout()
    plt.show()

# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å—Ç–æ–ª–±—á–∞—Ç—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º
def plot_cat(df1, df2, column):
    plt.figure(figsize=(15, 6))
    
    # –¥–ª—è —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    plt.subplot(1, 2, 2)
    if column == '–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è':
        colors = {
            '–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π': 'magenta',
            '–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å': 'blue',
            '–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã': 'green',
            '–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞':'red' ,
            '–¢–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã –∏ –∑–¥–æ—Ä–æ–≤—å—è': 'yellow',
            '–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞': 'pink'
        }
        df1_grouped = df1[column].value_counts(normalize=True)[
            ['–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π', '–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å', '–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã', 
             '–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞', '–¢–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã –∏ –∑–¥–æ—Ä–æ–≤—å—è', '–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞']
        ]
        df1_grouped.plot(kind='bar', color=[colors[x] for x in df1_grouped.index])
        for i, v in enumerate(df1_grouped):
            plt.text(i, v, str(round(v * 100, 2)) + "%", ha='center', va='bottom')
    else:
        colors = ['blue', 'green']
        df1[column].value_counts(normalize=True).plot(kind='bar', color=colors)
        for i, v in enumerate(df1[column].value_counts(normalize=True)):
            plt.text(i, v, str(round(v * 100, 2)) + "%", ha='center', va='bottom')
    
    plt.title("–°–Ω–∏–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏")
    plt.xlabel(column)
    plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞ (%)")
    
    # –¥–ª—è –ø—Ä–µ–∂–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    plt.subplot(1, 2, 1)
    if column == '–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è':
        df2_grouped = df2[column].value_counts(normalize=True)[
            ['–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π', '–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å', '–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã',
             '–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞', '–¢–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã –∏ –∑–¥–æ—Ä–æ–≤—å—è', '–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞']
        ]
        df2_grouped.plot(kind='bar', color=[colors[x] for x in df2_grouped.index])
        for i, v in enumerate(df2_grouped):
            plt.text(i, v, str(round(v * 100, 2)) + "%", ha='center', va='bottom')
    else:
        df2[column].value_counts(normalize=True).plot(kind='bar', color=colors)
        for i, v in enumerate(df2[column].value_counts(normalize=True)):
            plt.text(i, v, str(round(v * 100, 2)) + "%", ha='center', va='bottom')
    
    plt.title("–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏")
    plt.xlabel(column)
    plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞ (%)")

    plt.show()
```


```python
market_file.head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>215348</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–¥–∞</td>
      <td>3.4</td>
      <td>5</td>
      <td>121</td>
      <td>0.0</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –≤—ã–±–µ—Ä–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
market_file_num = ['–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å', '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å',
               '–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', '—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
               '–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', '–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞', '—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç']
market_file_cat = ['—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞', '—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å', '–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è']
```

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º **–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** —Å —É—á–µ—Ç–æ–º —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
for col in market_file_num:
    plot_hist(decr, stab, col)
```


    
![png](output_91_0.png)
    



    
![png](output_91_1.png)
    



    
![png](output_91_2.png)
    



    
![png](output_91_3.png)
    



    
![png](output_91_4.png)
    



    
![png](output_91_5.png)
    



    
![png](output_91_6.png)
    



    
![png](output_91_7.png)
    



```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —è—â–∏–∫–∏ —Å —É—Å–∞–º–∏
for col in market_file_num:
    plot_box(decr, stab, col)
```


    
![png](output_92_0.png)
    



    
![png](output_92_1.png)
    



    
![png](output_92_2.png)
    



    
![png](output_92_3.png)
    



    
![png](output_92_4.png)
    



    
![png](output_92_5.png)
    



    
![png](output_92_6.png)
    



    
![png](output_92_7.png)
    


<u>**–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –≥—Ä–∞—Ñ–∏–∫–∞–º –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**</u>
    –ü–æ–∫–∞–ø–∞—Ç–µ–ª–∏ —Å –ø—Ä–µ–∂–Ω–µ–π –∏ —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ –º–∞–≥–∞–∑–∏–Ω–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤—Ä–µ–º—è, —Ç–∞–∫ –∫–∞–∫ –∏—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ö–æ–∂–∏.
    –ò–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤–∏–¥–Ω–æ, —á—Ç–æ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü** —É —Ç–µ—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, —É –∫–æ–≥–æ —É–ø–∞–ª–∞ –∞–∫—Ç–∏–≤–Ω–æ—Ç—å –±–æ–ª—å—à–µ —á–µ–º —É –∞–∫—Ç–∏–≤–Ω—ã—Ö, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ **—Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –∑–∞ —à–µ—Å—Ç—å –º–µ—Å—è—Ü–µ–≤** —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ. –í–æ–∑–º–æ–∂–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã –ø–æ–¥—Ö–æ–¥ –æ—Ç—Ç–æ–ª–∫–Ω—É–ª –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.
    **–î–æ–ª—è –ø–æ–∫—É–ø–æ–∫ –ø–æ –∞–∫—Ü–∏–∏** —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –±–æ–ª—å—à–µ —á–µ–º —Ç–µ –∫—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏–ª –µ—ë.
    –ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ —Å –ø—Ä–µ–∂–Ω–∏–º —É—Ä–æ–≤–Ω–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –±–æ–ª—å—à–µ–µ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∑–∞ –≤–∏–∑–∏—Ç** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏ —Å–æ —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é.
    **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–∞—Ö** —É –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —Å–æ —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –±–æ–ª—å—à–µ, —á–µ–º —É –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –í–µ—Ä–æ—è—Ç–Ω–æ, –æ–Ω–∏ –æ–∂–∏–¥–∞—é—Ç –∫–∞–∫–∏—Ö-—Ç–æ –∞–∫—Ü–∏–π –∏–ª–∏ —Å–∫–∏–¥–æ–∫ –Ω–∞ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ª–∏–±–æ –±–æ–ª–µ–µ –ø—Ä–∏–≤–µ—Ä–µ–¥–ª–∏–≤—ã.
    –ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–±–æ–µ–≤ –≤ —Ä–∞–±–æ—Ç–µ —Å–∞–π—Ç–∞**. –í–∏–¥–Ω–æ, —á—Ç–æ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å —Å–∞–π—Ç–æ–º —É –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å–æ —Å–Ω–∏–∂–µ–Ω–Ω–æ–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–±–æ–µ–≤ –¥–∞–∂–µ –º–µ–Ω—å—à–µ, —á–µ–º —É —Ç–µ—Ö, –∫—Ç–æ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∞–∫—Ç–∏–≤–Ω–æ –¥–µ–ª–∞–µ—Ç –ø–æ–∫—É–ø–∫–∏, –∞ —Å–±–æ–∏ –≤—Ä—è–¥–ª–∏ –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.
    –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø–æ–∫—É–ø–∞–µ–ª–∏ —Å –ø—Ä–µ–∂–Ω–∏–º —É—Ä–æ–≤–Ω–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –ø–æ—á—Ç–∏ –≤ –¥–≤–∞ –±–æ–ª—å—à–µ–µ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü —Å–∞–π—Ç–∞** –º–∞–≥–∞–∑–∏–Ω–∞ –∑–∞ –≤–∏–∑–∏—Ç. –í–æ–∑–º–æ–∂–Ω–æ, –æ–Ω–∏ –∏—â—É—Ç —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∏ —É –Ω–∏—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏–ª –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω—É–∂–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞.

  

–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º **–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** —Å —É—á–µ—Ç–æ–º —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
for col in market_file_cat:
    plot_cat(decr, stab, col)
```


    
![png](output_96_0.png)
    



    
![png](output_96_1.png)
    



    
![png](output_96_2.png)
    


<u>**–í—ã–≤–æ–¥—ã –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –≥—Ä–∞—Ñ–∏–∫–∞–º –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**</u>

**–¢–∏–ø –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è** –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∏ **—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É** –Ω–µ —Å–∏–ª—å–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ —Å–Ω–∏–∂–µ–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –∞ –≤–æ—Ç **–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤** –¥–ª—è –ø–æ–∫—É–ø–∫–∏ —Å–ª–µ–¥—É–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å .

–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ —Å –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã —É—Ä–æ–≤–Ω–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞–ª–∏ –±–æ–ª—å—à–µ –≤–µ—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ <u>—Ç–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã –∏ –∑–¥–æ—Ä–æ–≤—å—è</u> –∏ <u>–º–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</u> —á–µ–º —Ç–µ —É –∫–æ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∑–∏–ª–∞—Å—å. –í–µ—Ä–æ—è—Ç–Ω–µ–π –≤—Å–µ–≥–æ –ª—é–¥–∏ –ª–∏–±–æ —Ä–µ—à–∏–ª–∏ —Å–≤–æ–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ –∑–¥–æ—Ä–æ–≤—å–µ–º –∏ –∫—Ä–∞—Å—Ç–æ–π –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏, –∏–ª–∏ –æ–Ω–∏ –∑–¥–æ—Ä–æ–≤—ã –∏ –∫—Ä–∞—Å–∏–≤—ã –∏ –∏–º –Ω–µ –Ω—É–∂–Ω–∞ –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤—ã—Ä—ã. –ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —É –Ω–∏—Ö —Ç–æ–∂–µ —É–∂–µ –µ—Å—Ç—å –∏ –ø–æ–∫—É–ø–∞—Ç—å –µ—ë –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

–ü–æ–∫—É–ø–∫–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ–º–Ω–æ–≥–æ –ø–æ–¥—Ä–æ—Å–ª–∞.

### –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º market_money


```python
# –ø—Ä–æ—Å–º–æ—Ç—Ä–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_money
market_money.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>3900.0</td>
      <td>215997.500000</td>
      <td>375.325686</td>
      <td>215348.0</td>
      <td>215672.75</td>
      <td>215997.5</td>
      <td>216322.25</td>
      <td>216647.0</td>
    </tr>
    <tr>
      <th>–ø—Ä–∏–±—ã–ª—å</th>
      <td>3900.0</td>
      <td>5025.696051</td>
      <td>1777.704104</td>
      <td>0.0</td>
      <td>4590.15</td>
      <td>4957.5</td>
      <td>5363.00</td>
      <td>106862.2</td>
    </tr>
  </tbody>
</table>
</div>



–í –¥–∞–Ω–Ω–æ–º —Ñ–∞–π–ª–µ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü. –ù–æ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –º–∞–∫—Å–∏–º—É–º –ø—Ä–∏–±—ã–ª–∏ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π, –æ–Ω –≤ –¥–≤–∞–¥—Ü–∞—Ç—å —Ä–∞–∑ –±–æ–ª—å—à–µ —á–µ–º –∫–≤–∞–Ω—Ç–∏–ª—å 75%. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã. –ù–∞–π–¥–µ–º –∏—Ö.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É
plt.figure(figsize=(10, 5))
sns.set()
sns.histplot(market_money['–ø—Ä–∏–±—ã–ª—å'], kde=True, bins=1000, color='green')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏')
plt.xlabel('–í—ã—Ä—É—á–∫–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.show()
```


    
![png](output_101_0.png)
    



```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —è—â–∏–∫ —Å —É—Å–∞–º–∏
plt.figure(figsize=(10, 5))
sns.boxplot(x=market_money['–ø—Ä–∏–±—ã–ª—å'], color='green')
plt.title(f'–Ø—â–∏–∫ —Å —É—Å–∞–º–∏ –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–∞ "–í—ã—Ä—É—á–∫–∞"')
plt.xlabel('–í—ã—Ä—É—á–∫–∞')
plt.show();
```


    
![png](output_102_0.png)
    


–í–∏–¥–Ω–æ, —á—Ç–æ –ø–æ—á—Ç–∏ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–±—ã–ª–∏ –º–µ–Ω—å—à–µ 10000, –Ω–æ –±–æ–ª—å—à–µ 3000. –ï—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã, –∏—Ö –Ω–∞–¥–æ —É–¥–∞–ª–∏—Ç—å.


```python
market_money = market_money[(market_money['–ø—Ä–∏–±—ã–ª—å'] <= 10000) & (market_money['–ø—Ä–∏–±—ã–ª—å'] >= 3000)]
```

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'>–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —è–≤–Ω—ã–π –≤—ã–±—Ä–æ—Å.
–ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å, –∞ –º–æ–∂–Ω–æ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞.</font>

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'>–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã üëå</font>


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–∞
market_money['–ø—Ä–∏–±—ã–ª—å'].max()
```




    7799.4



–≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º, —Ç–∞–∫ —á—Ç–æ  –µ—â–µ —Ä–∞–∑ –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —è—â–∏–∫ —Å —É—Å–∞–º–∏
plt.figure(figsize=(10, 5))
sns.boxplot(x=market_money['–ø—Ä–∏–±—ã–ª—å'], color='green')
plt.title(f'–Ø—â–∏–∫ —Å —É—Å–∞–º–∏ –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–∞ "–í—ã—Ä—É—á–∫–∞"')
plt.xlabel('–í—ã—Ä—É—á–∫–∞')
plt.xlim(0, 10000)
plt.show();
```


    
![png](output_109_0.png)
    


<u>**–í—ã–≤–æ–¥ –ø–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É `market_money`**</u>

–í —Ö–æ–¥–µ –∏–∑—É—á–µ–Ω–∏—è —ç—Ç–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ –±—ã–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –≤—ã–±—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–π –º–æ–≥ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –¥–∞–ª—å–Ω–µ–π—à—É—é —Ä–∞–±–æ—Ç—É —Å –¥–∞–Ω–Ω—ã–º–∏. –≠—Ç–æ—Ç –≤—ã–±—Ä–æ—Å –±—ã–ª —É–¥–∞–ª–µ–Ω.

### –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º market_time


```python
# –ø—Ä–æ—Å–º–æ—Ç—Ä–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_time
market_time.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>2600.0</td>
      <td>215997.500000</td>
      <td>375.349754</td>
      <td>215348.0</td>
      <td>215672.75</td>
      <td>215997.5</td>
      <td>216322.25</td>
      <td>216647.0</td>
    </tr>
    <tr>
      <th>–º–∏–Ω—É—Ç—ã</th>
      <td>2600.0</td>
      <td>13.336154</td>
      <td>4.080198</td>
      <td>4.0</td>
      <td>10.00</td>
      <td>13.0</td>
      <td>16.00</td>
      <td>23.0</td>
    </tr>
  </tbody>
</table>
</div>



–î–∞–Ω–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–∏–Ω –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∏–Ω—É—Ç.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É
plt.figure(figsize=(10, 5))
sns.set()
sns.histplot(market_time['–º–∏–Ω—É—Ç—ã'], kde=True, bins=10, color='green')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏')
plt.xlabel('–í—Ä–µ–º—è')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.show();
```


    
![png](output_114_0.png)
    



```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —è—â–∏–∫ —Å —É—Å–∞–º–∏
plt.figure(figsize=(10, 5))
sns.boxplot(x=market_time['–º–∏–Ω—É—Ç—ã'], color='green')
plt.title(f'–Ø—â–∏–∫ —Å —É—Å–∞–º–∏ –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–∞ "–í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ"')
plt.xlabel('–í—Ä–µ–º—è')
plt.show();
```


    
![png](output_115_0.png)
    


<u>**–í—ã–≤–æ–¥ –ø–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É `market_time`**</u>
–í—Ä–µ–º—è, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –Ω–∞ —Å–∞–π—Ç–µ, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–µ—Ç. 
–í **—Å—Ä–µ–¥–Ω–µ–º** –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –ø—Ä–æ–≤–æ–¥—è—Ç –Ω–∞ —Å–∞–π—Ç–µ –ø—Ä–∏–º–µ—Ä–Ω–æ `13` –º–∏–Ω—É—Ç, **–º–∞–∫—Å–∏–º—É–º** ‚Äî `23` –º–∏–Ω—É—Ç—ã, **–º–∏–Ω–∏–º—É–º** ‚Äî `4` –º–∏–Ω—É—Ç—ã.

### –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º money


```python
# –ø—Ä–æ—Å–º–æ—Ç—Ä–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ money
money.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>1300.0</td>
      <td>215997.500000</td>
      <td>375.421985</td>
      <td>215348.00</td>
      <td>215672.75</td>
      <td>215997.500</td>
      <td>216322.25</td>
      <td>216647.00</td>
    </tr>
    <tr>
      <th>–ø—Ä–∏–±—ã–ª—å</th>
      <td>1300.0</td>
      <td>3.996631</td>
      <td>1.013722</td>
      <td>0.86</td>
      <td>3.30</td>
      <td>4.045</td>
      <td>4.67</td>
      <td>7.43</td>
    </tr>
  </tbody>
</table>
</div>



–î–∞–Ω–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–∏–Ω –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫. –≠—Ç–æ –ø—Ä–∏–±—ã–ª—å.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É
plt.figure(figsize=(10, 5))
sns.set()
sns.histplot(money['–ø—Ä–∏–±—ã–ª—å'], kde=True, bins=10, color='green')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏')
plt.xlabel('–ü—Ä–∏–±—ã–ª—å')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.show();
```


    
![png](output_120_0.png)
    



```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —è—â–∏–∫ —Å —É—Å–∞–º–∏
plt.figure(figsize=(10, 5))
sns.boxplot(x=money['–ø—Ä–∏–±—ã–ª—å'], color='green')
plt.title(f'–Ø—â–∏–∫ —Å —É—Å–∞–º–∏ –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–∞ "–ü—Ä–∏–±—ã–ª—å"')
plt.xlabel('–ü—Ä–∏–±—ã–ª—å')
plt.show();
```


    
![png](output_121_0.png)
    


<u>**–í—ã–≤–æ–¥ –ø–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É `money`**</u>

–ó–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –≤—ã–±—Ä–æ—Å—ã –µ—Å—Ç—å, –Ω–æ –æ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏, –æ–≥—Ä–æ–º–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ—Ç.

### –û–±—â–∏–π –≤—ã–≤–æ–¥ –ø–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö

–ë—ã–ª –ø—Ä–æ–≤–µ–¥–µ–Ω –∞–Ω–∞–ª–∏–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤–æ –≤—Å–µ—Ö –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö, –∏–∑—É—á–µ–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å —É—á–µ—Ç–æ–º —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ ‚Äî –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –í–æ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –≤—ã–±—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ö–æ–∂–∏ —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º–∏.

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'>–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —á–∞—Å—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: –º–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —Ñ—É–Ω–∫—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–µ—à—å –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.</font>

## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –Ω–µ –º–µ–Ω–µ–µ —Ç—Ä–µ—Ö –º–µ—Å—è—Ü–µ–≤, –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–∏–±—ã–ª–∏ –±—ã–ª–∏ –∑–∞ –≤—Å–µ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞.

–ü–æ—ç—Ç–æ–º—É –≤—ã–ø–æ–ª–Ω–∏–º —Å–ª–µ–¥—É—é—â–µ–µ: 
* —Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ –≤—ã—Ä—É—á–∫–µ –∑–∞ 3 –º–µ—Å—è—Ü–∞ –∏–∑ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ `market_money`, 
* —Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ –≤—ã—Ä—É—á–∫–µ –∑–∞ 2 –º–µ—Å—è—Ü–∞ –∏–∑ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ `market_time`,
* –æ–±—ä–µ–¥–∏–Ω–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–º `market_file`,
* —É–¥–∞–ª–∏–º –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–π –∏–∑ –∫–æ–ª–æ–Ω–æ–∫ –ø—Ä–∏–±—ã–ª–∏ –∑–∞ 3 –º–µ—Å—è—Ü–∞.


```python
# —Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ –≤—ã—Ä—É—á–∫–µ –∏–∑ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_money, —Å —Ü–µ–ª—å—é –Ω–∞–π—Ç–∏ –≤—ã—Ä—É—á–∫—É –∑–∞ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞
pivot_table_market_money = pd.pivot_table(market_money, index='id', values='–ø—Ä–∏–±—ã–ª—å', columns='–º–µ—Å—è—Ü')
pivot_table_market_money.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>–º–µ—Å—è—Ü</th>
      <th>–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>215348</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>3293.1</td>
    </tr>
    <tr>
      <th>215349</th>
      <td>4472.0</td>
      <td>5216.0</td>
      <td>4971.6</td>
    </tr>
    <tr>
      <th>215350</th>
      <td>4826.0</td>
      <td>5457.5</td>
      <td>5058.4</td>
    </tr>
    <tr>
      <th>215351</th>
      <td>4793.0</td>
      <td>6158.0</td>
      <td>6610.4</td>
    </tr>
    <tr>
      <th>215352</th>
      <td>4594.0</td>
      <td>5807.5</td>
      <td>5872.5</td>
    </tr>
  </tbody>
</table>
</div>



–ß—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è –∏–∑–º–µ–Ω–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤


```python
column_mapping = {
    '–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü': '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
    '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü': '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
    '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü': '–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü'
}

pivot_table_market_money.rename(columns=column_mapping, inplace=True)
```


```python
# —Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ –≤—ã—Ä—É—á–∫–µ –∏–∑ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_time, –Ω–∞–π—Ç–∏ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–µ –Ω–∞ —Å–∞–π—Ç–µ –∑–∞ –¥–≤–∞ –º–µ—Å—è—Ü–∞
pivot_table_market_time = pd.pivot_table(market_time, index='id', values='–º–∏–Ω—É—Ç—ã', columns='–º–µ—Å—è—Ü')
pivot_table_market_time.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>–º–µ—Å—è—Ü</th>
      <th>–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>215348</th>
      <td>13</td>
      <td>14</td>
    </tr>
    <tr>
      <th>215349</th>
      <td>12</td>
      <td>10</td>
    </tr>
    <tr>
      <th>215350</th>
      <td>8</td>
      <td>13</td>
    </tr>
    <tr>
      <th>215351</th>
      <td>11</td>
      <td>13</td>
    </tr>
    <tr>
      <th>215352</th>
      <td>8</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>



<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚úîÔ∏è\
<font color='green'> –û—Ç–ª–∏—á–Ω–æ!  –†–∞–∑–≤–µ—Ä–Ω—É–ª–∏ —Ç–∞–±–ª–∏—Ü—ã.</font>


```python
column_mapping = {
    '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü': '–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
    '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü': '–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü'
}

pivot_table_market_time.rename(columns=column_mapping, inplace=True)
```


```python
# –æ–±—ä–µ–¥–∏–Ω–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–º market_file
merged_market_file = market_file.merge(pivot_table_market_money, on='id', how='left')
```

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> –í–µ—Ä–Ω–æ, –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü –Ω—É–∂–Ω–æ –ø—Ä–∏–≤—è–∑–∞—Ç—å—Å—è –∫ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É `"id"`.</font>


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
merged_market_file.sample(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>178</th>
      <td>215526</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>3.1</td>
      <td>4</td>
      <td>572</td>
      <td>0.29</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>1</td>
      <td>8</td>
      <td>8</td>
      <td>5</td>
      <td>4508.0</td>
      <td>5880.5</td>
      <td>6713.8</td>
    </tr>
    <tr>
      <th>82</th>
      <td>215430</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>2.9</td>
      <td>4</td>
      <td>824</td>
      <td>0.29</td>
      <td>–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞</td>
      <td>2</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>4712.0</td>
      <td>5289.5</td>
      <td>5780.9</td>
    </tr>
    <tr>
      <th>648</th>
      <td>215996</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–¥–∞</td>
      <td>4.4</td>
      <td>3</td>
      <td>807</td>
      <td>0.14</td>
      <td>–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>9</td>
      <td>4667.0</td>
      <td>4284.5</td>
      <td>4083.0</td>
    </tr>
    <tr>
      <th>408</th>
      <td>215756</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>5.4</td>
      <td>4</td>
      <td>923</td>
      <td>0.15</td>
      <td>–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>10</td>
      <td>4943.0</td>
      <td>5205.5</td>
      <td>5563.0</td>
    </tr>
    <tr>
      <th>425</th>
      <td>215773</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>5.1</td>
      <td>5</td>
      <td>831</td>
      <td>0.12</td>
      <td>–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>10</td>
      <td>5103.0</td>
      <td>4515.0</td>
      <td>4135.4</td>
    </tr>
  </tbody>
</table>
</div>




```python
merged_market_file = merged_market_file.merge(pivot_table_market_time, on='id', how='left')
```


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
merged_market_file.sample(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1078</th>
      <td>216426</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>3.3</td>
      <td>3</td>
      <td>712</td>
      <td>0.13</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
      <td>8</td>
      <td>4522.0</td>
      <td>4090.0</td>
      <td>3845.6</td>
      <td>19</td>
      <td>14</td>
    </tr>
    <tr>
      <th>674</th>
      <td>216022</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>4.5</td>
      <td>4</td>
      <td>662</td>
      <td>0.16</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>13</td>
      <td>4981.0</td>
      <td>4906.0</td>
      <td>4971.0</td>
      <td>18</td>
      <td>11</td>
    </tr>
    <tr>
      <th>266</th>
      <td>215614</td>
      <td>–°–Ω–∏–∑–∏–ª–∞—Å—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>4.0</td>
      <td>3</td>
      <td>952</td>
      <td>0.22</td>
      <td>–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞</td>
      <td>4</td>
      <td>5</td>
      <td>1</td>
      <td>5</td>
      <td>4767.0</td>
      <td>5808.0</td>
      <td>6593.2</td>
      <td>14</td>
      <td>11</td>
    </tr>
    <tr>
      <th>723</th>
      <td>216071</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>5.5</td>
      <td>5</td>
      <td>930</td>
      <td>0.17</td>
      <td>–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>4341.0</td>
      <td>4812.0</td>
      <td>5350.2</td>
      <td>16</td>
      <td>11</td>
    </tr>
    <tr>
      <th>660</th>
      <td>216008</td>
      <td>–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>6.1</td>
      <td>4</td>
      <td>953</td>
      <td>0.26</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>10</td>
      <td>4999.0</td>
      <td>5690.5</td>
      <td>6419.8</td>
      <td>8</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏–≤—à–µ–≥–æ—Å—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ (–∫–æ–ª-–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å –Ω–∞ 5, –∫–∞–∫ –∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª–æ—Å—å)
merged_market_file.shape
```




    (1300, 18)



–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ. —Ç–µ–ø–µ—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∫–∞–∑–∞–Ω–æ, —Å–∫–æ–ª—å–∫–æ –æ–Ω –ø–æ—Ç—Ä–∞—Ç–∏–ª –≤ –ø—Ä–æ—Å–ª–µ–¥–Ω–∏–∏ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞ –∏ —Å–∫–æ–ª—å–∫–æ –æ–Ω –ø—Ä–æ–≤–µ–ª –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Å–∞–π—Ç–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–∞
–ò–∑—É—á–∏–º –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ.


```python
merged_market_file.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 1300 entries, 0 to 1299
    Data columns (total 18 columns):
     #   Column                               Non-Null Count  Dtype  
    ---  ------                               --------------  -----  
     0   id                                   1300 non-null   int64  
     1   –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å            1300 non-null   object 
     2   —Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞                          1300 non-null   object 
     3   —Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å                   1300 non-null   object 
     4   –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å                   1300 non-null   float64
     5   –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å                 1300 non-null   int64  
     6   –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                         1300 non-null   int64  
     7   –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏                    1300 non-null   float64
     8   –ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è                 1300 non-null   object 
     9   —Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç  1300 non-null   int64  
     10  –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª   1300 non-null   int64  
     11  –æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞                       1300 non-null   int64  
     12  —Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç                     1300 non-null   int64  
     13  –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü         1297 non-null   float64
     14  –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü             1293 non-null   float64
     15  –≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                1297 non-null   float64
     16  –≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü               1300 non-null   int64  
     17  –≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                  1300 non-null   int64  
    dtypes: float64(5), int64(9), object(4)
    memory usage: 193.0+ KB


–ö–∞–∫ –≤–∏–¥–∏–º, –≤ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –≤—Ä–∏—à–ª–∏ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ `market_money`. –ü–æ—Å—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ –∏—Ö. 


```python
merged_market_file.isna().sum()
```




    id                                     0
    –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å              0
    —Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞                            0
    —Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å                     0
    –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å                     0
    –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å                   0
    –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                           0
    –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏                      0
    –ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è                   0
    —Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç    0
    –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª     0
    –æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞                         0
    —Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç                       0
    –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü           3
    –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü               7
    –≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                  3
    –≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü                 0
    –≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                    0
    dtype: int64



–ü—Ä–æ–ø—É—Å–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö, –æ—Ç—Ä–∞–∂–∞—é—â–∏—Ö –ø—Ä–∏–±—ã–ª—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞ (`–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü`, `–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü`, `–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü`), –∏ –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–±—ä–µ–∫—Ç—ã –º–æ–∂–Ω–æ —Å–º–µ–ª–æ —É–¥–∞–ª–∏—Ç—å. 


```python
merged_market_file = merged_market_file.dropna()
merged_market_file.isna().sum()
```




    id                                     0
    –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å              0
    —Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞                            0
    —Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å                     0
    –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å                     0
    –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å                   0
    –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                           0
    –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏                      0
    –ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è                   0
    —Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç    0
    –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª     0
    –æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞                         0
    —Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç                       0
    –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü           0
    –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü               0
    –≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                  0
    –≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü                 0
    –≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                    0
    dtype: int64



–ü—Ä–æ–ø—É—Å–∫–∏ —É–¥–∞–ª–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞–ª–∏—á–∏–µ —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.


```python
merged_market_file.duplicated().sum()
```




    0



–Ø–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.

**–í—ã–≤–æ–¥**

–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ–π —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –æ—Ç–æ–±—Ä–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –Ω–µ –º–µ–Ω–µ–µ —Ç—Ä—ë—Ö –º–µ—Å—è—Ü–µ–≤, —Ç–æ –µ—Å—Ç—å —Ç–∞–∫–∏—Ö, –∫–æ—Ç–æ—Ä—ã–µ —á—Ç–æ-–ª–∏–±–æ –ø–æ–∫—É–ø–∞–ª–∏ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥. –ü—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü –¥–∞–Ω–Ω–∞—è —Ü–µ–ª—å –±—ã–ª–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞: –º—ã –ø–æ–ª—É—á–∏–ª–∏ –ø–æ–ª–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Å—Ä–æ–∫.

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>

## –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–ù–∞–ø–æ–º–Ω–∏–º –∫–∞–∫–∏–µ –µ—Å—Ç—å —Å—Ç–æ–ª–±—Ü—ã –≤ –æ–±—ä–µ–¥–∏–Ω–Ω–æ–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ.


```python
merged_market_file.columns
```




    Index(['id', '–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å', '—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞', '—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å',
           '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å', '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å', '–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
           '–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', '–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è',
           '—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
           '–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', '–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞',
           '—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç', '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
           '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü',
           '–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü'],
          dtype='object')



–ú–∞—Ç—Ä–∏—Ü–∞ Phik —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –≤ –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –º–∞—Ç—Ä–∏—Ü—É, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∞ –º–æ–∂–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –Ω–µ —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏, –Ω–æ –∏ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. –ê –Ω–∞–º —ç—Ç—É –Ω—É–∂–Ω–æ —Å —Ü–µ–ª—å—é –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö.


```python
# —Å–æ–∑–¥–∞–¥–∏–º –∫–æ–ø–∏—é –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ –±–µ–∑ —Å—Ç–æ–ª–±—Ü–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–∞–≥–∞–∑–∏–Ω–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
merged_market_file_copy = merged_market_file.drop('id', axis=1)
# –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
ic=['–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å', '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å', '–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
       '–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', 
       '—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
       '–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', '–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞',
       '—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç', '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
       '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü',
       '–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü']
# —Ä–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Phik
correlation_matrix = phik.phik_matrix(merged_market_file_copy, interval_cols=ic)

# –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
plt.figure(figsize=(20, 15))
sns.heatmap(correlation_matrix, annot=True, cmap="coolwarm")

plt.title("–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (Phik)")
plt.show();
```


    
![png](output_154_0.png)
    


- –î–ª—è –æ—Ü–µ–Ω–∫–∏ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —à–∫–∞–ª—É –ß–µ–¥–¥–æ–∫–∞. –í–µ—Å—å–º–∞ –≤—ã—Å–æ–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—é –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –æ—Ç `0.9` –¥–æ `0.95` –ø–æ –º–æ–¥—É–ª—é. –ó–¥–µ—Å—å —Ç–∞–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º—ã –Ω–µ –Ω–∞–±–ª—é–¥–∞–µ–º.
- –ò—Å—Ö–æ–¥—è –∏–∑ –ø–æ–ª—É—á–∏–≤—à–µ–≥–æ—Å—è –≥—Ä–∞—Ñ–∏–∫–∞, –º—ã –≤–∏–¥–∏–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é (`0.7‚Äî0.9` - –≤—ã—Å–æ–∫–∞—è –ø–æ —à–∫–∞–ª–µ –ß–µ–¥–¥–æ–∫–∞) –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–µ–∂–¥—É `–ø—Ä–∏–±—ã–ª—å—é –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü` –∏ `–ø—Ä–∏–±—ã–ª—å—é –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü` ‚Äî `0.85` –∏ –º–µ–∂–¥—É `–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é`  –∏ `–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∑–∞ –≤–∏–∑–∏—Ç` ‚Äî `0.75`.
- –¢–∞–∫–∂–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø—Ä–∏–µ–º–ª–µ–º–∞—è (`0.5‚Äî0.7`- –∑–∞–º–µ—Ç–Ω–∞—è –ø–æ —à–∫–∞–ª–µ –ß–µ–¥–¥–æ–∫–∞) –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –º–µ–∂–¥—É `–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é`  –∏ `–≤—Ä–µ–º–µ–Ω–µ–º –≤ –º–∏–Ω—É—Ç–∞—Ö, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∞ —Å–∞–π—Ç–µ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü`  ‚Äî `0.68`, –º–µ–∂–¥—É `–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é`  –∏ `–≤—Ä–µ–º–µ–Ω–µ–º –≤ –º–∏–Ω—É—Ç–∞—Ö, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∞ —Å–∞–π—Ç–µ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü`  ‚Äî `0.58`, –º–µ–∂–¥—É `–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é`  –∏ `—Å—Ä–µ–¥–Ω–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∑–∞ –≤–∏–∑–∏—Ç –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü**  –∏ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –∫–æ–º–ø–∞–Ω–∏–∏—Å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤`  ‚Äî `0.54`, –º–µ–∂–¥—É `–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é`  –∏ `–∞–∫—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø–æ–∫—É–ø–∫–∞–º–∏`  ‚Äî `0.51`, –º–µ–∂–¥—É `–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é`  –∏ `–≤—ã—Ä—É—á–∫–æ–π –∑–∞ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü`  –∏ `–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞` -- –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–º–µ—é—Ç –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é –∫–æ—Ä–µ–ª—è—Ü–∏—é –∏–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ –∏–º–µ—é—Ç –µ—ë (–ø–æ —à–∫–∞–ª–µ –ß–µ–¥–¥–æ–∫–∞ —ç—Ç–æ —Å–ª–∞–±–∞—è –∏ —É–º–µ—Ä–µ–Ω–Ω–∞—è).

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'>–ó–¥–æ—Ä–æ–≤–æ,—á—Ç–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ `phik` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</font>

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤

–ü–æ—Å–∫–æ–ª—å–∫—É —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ **–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** (`–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å`) —É –Ω–∞—Å —è–≤–ª—è–µ—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º, –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∑–∞–º–µ–Ω–∏–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: `–°–Ω–∏–∑–∏–ª–∞—Å—å` –Ω–∞ `1`, `–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å` –Ω–∞ `0`.


```python
merged_market_file['–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å'] = merged_market_file['–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å'].apply(lambda x: 1 if x == '–°–Ω–∏–∑–∏–ª–∞—Å—å' else (0 if x == '–ü—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å' else x))
```

–£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∑–∞–º–µ–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.


```python
merged_market_file.sample(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>361</th>
      <td>215709</td>
      <td>1</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>4.6</td>
      <td>5</td>
      <td>352</td>
      <td>0.89</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>6</td>
      <td>4755.0</td>
      <td>5221.5</td>
      <td>5606.3</td>
      <td>12</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>



–ü—Ä–∏—Å—Ç—É–ø–∏–º –∫ —Å–æ–∑–¥–∞–Ω–∏—é –ø–∞–π–ø–ª–∞–π–Ω–∞.

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–º–µ—Ç—Ä–∏–∫—É ROC-AUC** (Receiver Operating Characteristic - Area Under the Curve) ‚Äî —ç—Ç–æ –º–µ—Ç—Ä–∏–∫–∞ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ —Ä–∞–∑–ª–∏—á–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –∫–ª–∞—Å—Å–æ–≤. –û–Ω–∞ –∏–∑–º–µ—Ä—è–µ—Ç –ø–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–æ–ª–µ–π –≤–µ—Ä–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –¥–æ–ª–µ–π –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ß–µ–º –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ ROC-AUC, —Ç–µ–º –ª—É—á—à–µ –º–æ–¥–µ–ª—å –ø—Ä–æ–≤–æ–¥–∏—Ç —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –∫–ª–∞—Å—Å–∞–º–∏.

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>


```python
# —Ä–∞–∑–¥–µ–ª–∏–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é (80%) –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ (20%), –∑–∞–¥–∞–¥–∏–º —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤
# –æ–ø—Ä–µ–¥–µ–ª–∏–º random_state
RANDOM_STATE = 42
TEST_SIZE = 0.2

X_train, X_test, y_train, y_test = train_test_split(
    merged_market_file.drop(['id','–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å'], axis=1),
    merged_market_file['–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å'],
    test_size = TEST_SIZE, 
    random_state = RANDOM_STATE,
    stratify = merged_market_file['–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å']
)

# –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–∞–∑–º–µ—Ä –ø–æ–ª—É—á–∏–≤—à–∏—Ö—Å—è –≤—ã–±–æ—Ä–æ–∫
print(X_train.shape, X_test.shape)
```

    (1032, 16) (258, 16)


—Ä–∞–∑–¥–µ–ª–∏–º —Å—Ç–æ–ª–±—Ü—ã –Ω–∞ —Ç—Ä–∏ —á–∞—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Å –Ω–∏–º–∏.


```python
# —Å–æ–∑–¥–∞–¥–∏–º —Å–ø–∏—Å–∫–∏ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

ohe_columns = ['–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è']#–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö
ord_columns = ['—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞', '—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å']# –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—è–¥–∫–æ—ã—Ö
num_columns = [
    '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å', '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å',
    '–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', '—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
    '–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', '–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞', '—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç',
    '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
    '–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü', '–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
    '–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü'
]#–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
```


```python
# —É –Ω–∞—Å –Ω–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö, –ø–æ—ç—Ç–æ–º—É SimpleImputer –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ –±—É–¥–µ–º

# –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
ohe_pipe = Pipeline(
    [('ohe', OneHotEncoder(drop='first', handle_unknown='error', sparse_output=False))]
)

# –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
ord_pipe = Pipeline(
    [('ord', OrdinalEncoder(
        categories=[
            ['—Å—Ç–∞–Ω–¥–∞—Ä—Ç', '–ø—Ä–µ–º–∏—É–º'],
            ['–Ω–µ—Ç', '–¥–∞'],
        ],
        handle_unknown='use_encoded_value', unknown_value=np.nan
    ))]
)

# –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
num_pipe = Pipeline(
    [('scaler', StandardScaler())]
)

# –æ–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –ø–∞–π–ø–ª–∞–π–Ω—ã —Å –ø–æ–º–æ—â—å—é ColumnTransformer
data_preprocessor = ColumnTransformer([
    ('ohe', ohe_pipe, ohe_columns),
    ('ord', ord_pipe, ord_columns),
    ('num', num_pipe, num_columns)
], remainder='passthrough')

# –∏—Ç–æ–≥–æ–≤—ã–π –ø–∞–π–ø–ª–∞–π–Ω
pipe_final = Pipeline([
    ('preprocessor', data_preprocessor),
    ('model', DecisionTreeClassifier(random_state=RANDOM_STATE))
])
```

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>

–°–æ–∑–¥–∞–¥–∏–º —Å–ª–æ–≤–∞—Ä—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤


```python
param_grid = [
    # —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –º–æ–¥–µ–ª–∏ KNeighborsClassifier()
    {
        'model': [KNeighborsClassifier()],
        'model__n_neighbors': range(3, 8),
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']
    },
    
    # —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –º–æ–¥–µ–ª–∏ DecisionTreeClassifier()
    {
        'model': [DecisionTreeClassifier(random_state=RANDOM_STATE)],
        'model__max_depth': range(1, 10),
        'model__min_samples_split': range(2, 10),
        'model__min_samples_leaf': range(2, 10),
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']    
    },
    
    # —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –º–æ–¥–µ–ª–∏ LogisticRegression()
    {
        'model': [LogisticRegression(random_state=RANDOM_STATE, solver='liblinear', penalty='l1')],
        'model__C': range(1, 7), 
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']
    },
    
    # —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –º–æ–¥–µ–ª–∏ SVC()
    {
        'model': [SVC(random_state=RANDOM_STATE, probability=True)],
        'model__C': [0.01, 0.1, 1, 10],
        'model__kernel': ['linear', 'rbf', 'sigmoid', 'poly'], 
        'model__gamma': [0.01, 0.1, 1, 10],
        'model__degree': [2, 3, 4],
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough'] 
    }
]
```

–¢–µ–ø–µ—Ä—å –Ω–∞–π–¥–µ–º –ª—É—á—à–µ—é –º–æ–¥–µ–ª—å –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–∞–º—ã—Ö –ø—Ä–º–∞–µ–Ω—è–µ–º—ã—Ö: **KNeighborsClassifier**, **DecisionTreeClassifier**, **LogisticRegression** –∏  **SVC**.


```python
random_search = RandomizedSearchCV(
    pipe_final,
    param_grid,
    cv=5,
    scoring='roc_auc',
    n_jobs=-1,
    random_state=RANDOM_STATE)

random_search.fit(X_train, y_train)

print('–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\n\n', random_search.best_estimator_)
print('–ú–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:', random_search.best_score_)

probabilities = random_search.predict_proba(X_test)
probabilities_one = probabilities[:, 1]
print('–ü–ª–æ—â–∞–¥—å ROC-–∫—Ä–∏–≤–æ–π:', roc_auc_score(y_test, probabilities_one))
```

    –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
    
     Pipeline(steps=[('preprocessor',
                     ColumnTransformer(remainder='passthrough',
                                       transformers=[('ohe',
                                                      Pipeline(steps=[('ohe',
                                                                       OneHotEncoder(drop='first',
                                                                                     sparse_output=False))]),
                                                      ['–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è']),
                                                     ('ord',
                                                      Pipeline(steps=[('ord',
                                                                       OrdinalEncoder(categories=[['—Å—Ç–∞–Ω–¥–∞—Ä—Ç',
                                                                                                   '–ø—Ä–µ–º–∏—É–º'],
                                                                                                  ['–Ω–µ—Ç',
                                                                                                   '–¥–∞']],
                                                                                      handle_unknown='use_encoded_value',
                                                                                      unknown_value=nan))]),
                                                      ['—Ç–∏...
                                                       '–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏',
                                                       '—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
                                                       '–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª',
                                                       '–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞',
                                                       '—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç',
                                                       '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
                                                       '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
                                                       '–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü',
                                                       '–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
                                                       '–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü'])])),
                    ('model',
                     SVC(C=1, degree=4, gamma=1, kernel='linear', probability=True,
                         random_state=42))])
    –ú–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.901351529535865
    –ü–ª–æ—â–∞–¥—å ROC-–∫—Ä–∏–≤–æ–π: 0.896875


<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚úîÔ∏è\
<font color='green'>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –≤–µ—Ä–Ω–æ.</font>

**–í—ã–≤–æ–¥**

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ **SVC** (Support Vector Classifier ‚Äî –º–µ—Ç–æ–¥ –æ–ø–æ—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤) —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
- `C` (–ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏) —Ä–∞–≤–µ–Ω `1`,
- `degree` (—Å—Ç–µ–ø–µ–Ω—å –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —è–¥—Ä–∞) —Ä–∞–≤–Ω–∞ `4`,
- `gamma` (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–ª–∏—è–Ω–∏—è) —Ä–∞–≤–µ–Ω `1`,
- `kernel` (—è–¥—Ä–æ) –∑–∞–¥–∞–Ω–æ `linear` (–ª–∏–Ω–µ–π–Ω–æ–µ),
- `probability`(–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É) –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ `True`,
- `random_state` —Ä–∞–≤–Ω–æ `42`.
–ú–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å –ø—Ä–∏–º–µ—Ä–Ω–æ`0.9`, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –≤–ø–æ–ª–Ω–µ –æ–∂–∏–±–∞–µ–º–æ —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ.
–ó–Ω–∞—á–µ–Ω–∏–µ **–ø–ª–æ—â–∞–¥–∏ –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π (ROC-AUC)** —Ä–∞–≤–Ω–æ–µ —Å –ø—Ä–∏–º–µ—Ä–Ω–æ `0.9` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–ª–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö–æ—Ä–æ—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.



## –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–í –¥–∞–ª—å–Ω–µ–π—â–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ—Ü–µ–Ω–∫—É –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ SHAP.


–°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ `shap.plots.bar` –æ—Ç—Ä–∞–∂–∞–µ—Ç –æ–±—â–∏–π –≤–∫–ª–∞–¥ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –ø—Ä–æ–≥–Ω–æ–∑—ã –º–æ–¥–µ–ª–∏. –û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω–∏–µ SHAP-–∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–∞ –ø–æ –≤—Å–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º. –î–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ä–µ–¥–Ω–∏—Ö –±–µ—Ä—É—Ç –∑–Ω–∞—á–µ–Ω–∏—è –®–µ–ø–ª–∏ –ø–æ –º–æ–¥—É–ª—é, —á—Ç–æ–±—ã –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Å–≤–æ–¥–∏–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∫ –Ω—É–ª—é.


```python
X_train = pipe_final.named_steps['preprocessor'].fit_transform(X_train)# –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏

```


```python
# –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
X_test = pipe_final.named_steps['preprocessor'].transform(X_test)
#X_test
```


```python
# —Å–æ–∑–¥–∞–¥–∏–º –æ–±—ä–µ–∫—Ç explainer
explainer = shap.LinearExplainer(random_search.best_estimator_.named_steps['model'], X_test)
# –ø–æ–ª—É—á–∏–º –∏–º–µ–Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
feature_names = pipe_final.named_steps['preprocessor'].get_feature_names_out()
```


```python
# —Å–æ–∑–¥–∞–¥–∏–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏–º–µ–Ω–∞–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
X_test = pd.DataFrame(X_test, columns=feature_names)
```


```python
# –ø–æ—Å—á–∏—Ç–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è SHAP –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
shap_values = explainer(X_test)
shap_values[0]
```




    .values =
    array([-0.05464016, -0.00543771,  0.07225091,  0.05240022,  0.03711223,
            0.15162457,  0.01448094, -0.27677957, -0.00184025,  0.01609077,
           -0.17459833,  0.07839075, -0.22524776, -0.04002904, -0.13545595,
           -0.01935824, -0.04003447,  0.0749173 , -0.09082248,  0.13921005])
    
    .base_values =
    -0.4506280476403346
    
    .data =
    array([ 1.        ,  0.        ,  0.        ,  0.        ,  0.        ,
            1.        ,  1.        ,  1.23146135, -0.04844324,  0.71739954,
           -0.35825082, -0.18653763, -0.94543949,  0.9308136 ,  0.19268892,
            0.01544383, -0.18660389, -0.3642643 ,  0.11189596, -0.54088133])




```python
# –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è SHAP –≤ –≤–∏–¥–µ –≥—Ä–∞—Ñ–∏–∫–∞ "–æ—Å–∏–Ω–æ–µ –≥–Ω–µ–∑–¥–æ"
shap.plots.beeswarm(shap_values,max_display=20)
```


    
![png](output_183_0.png)
    



```python
shap.plots.bar(shap_values,max_display=20)
# –°—Ç—Ä–∞–Ω–Ω–æ, —ç—Ç–æ—Ç –≥—Ä–∞—Ñ–∏–∫ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ—Ç —Å–ª—É—á–∞—è –∫ —Å–ª—É—á–∏—é.
```


    
![png](output_184_0.png)
    


<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> \
<font color='blue'> –ó–¥–µ—Å—å –Ω—É–∂–Ω–∞ matplotlib==3.5.0 </font>

**–í—ã–≤–æ–¥**
- –°–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –≤–ª–∏—è—é—Ç –≤–ª–∏—è—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –∑–∞ –≤–∏–∑–∏—Ç, –≤—Ä–µ–º—è, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–µ –Ω–∞ —Å–∞–π—Ç–µ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∏ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ, —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–∞—è –¥–æ–ª—è –ø–æ–∫—É–ø–æ–∫ –ø–æ –∞–∫—Ü–∏–∏ –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–∫—É–ø–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤, —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º –∑–∞ –≤–∏–∑–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞. 
- –í—ã—Ä—É—á–∫–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π, –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü, –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –∞ —Ç–∞–∫–∂–µ –∏—Ö –≤–ª–∏—è–Ω–∏–µ –Ω–µ —Ç–∞–∫ –∑–Ω–∞—á–∏–º–æ. –ü–æ—ç—Ç–æ–º—É –∏—Ö –º–æ–∂–Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å.
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ –∏ —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤ –Ω–µ —Ç–∞–∫ –∑–Ω–∞—á–∏–º—ã.
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ—Å—É—â–µ—Å—Ç–≤–µ–Ω—ã, –∏—Ö –≤–ª–∏—è–Ω–∏–µ  –º–æ–∂–Ω–æ –ø—Ä–µ–Ω–µ–±—Ä–µ—á.      


<u>**–ù–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –º–æ–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏—Ö –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏–π**:</u>

1. –í—Ä–µ–º—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–µ –Ω–∞ —Å–∞–π—Ç–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –æ–∫–∞–∑—ã–≤–∞—é—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –≠—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –¥–æ–ª–≥–∏–π –ø–æ–∏—Å–∫ –Ω—É–∂–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –æ–Ω–∏ –æ—Ç–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ—Ç –Ω–∏—Ö –∏–ª–∏ –ø–æ–∫—É–ø–∞—é—Ç –≤ –¥—Ä—É–≥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–¥–æ —É–ª—É—á—à–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –Ω–∞ —Å–∞–π—Ç–µ, —á—Ç–æ–±—ã –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏ –º–æ–≥–ª–∏ –ª–µ–≥–∫–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –∏—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–æ–¥—É–∫—Ç—ã. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –±–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å —Ç–æ–≤–∞—Ä, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã —Å –ø–æ–º–æ—â—å—é –∑–∞–¥–∞–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –≤—ã–¥–µ–ª—è–ª–∏ –º–µ–Ω—å—à–∏–π –∫—Ä—É–≥ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—Ö–æ–¥–∏–ª–∏ –Ω—É–∂–Ω—ã–π

2. –í–∏–¥–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –∞–∫—Ü–∏–π –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π, —á—Ç–æ –≥–æ–≤–æ—Ä–∏ —Ç –æ —Ç–æ–º, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–æ–Ω–∞—è—Ç—å –∞–∫—Ü–∏–∏ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è. –ù–æ —Ç–∞–∫ –∫–∞–∫ –∞–∫—Ü–∏–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–∫—Ü–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è.

3. –¢–∞–∫, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ –¥–ª—è –¥–∞–ª—å–Ω–µ–Ω–π—â–µ–≥–æ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ü–∏–π.

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>

## –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π

–ö–∞–∫ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø—É–Ω–∫—Ç–µ –∞–∫—Ü–∏–∏ –≤–ª–∏—è—é—Ç –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –ù–æ –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞, –¥–ª—è –∞–∫—Ü–∏–π –Ω–∞–¥–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –≤–ª–∏—è—é—Ç –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

–ù–∞—à–µ–π —Ü–µ–ª—å—é —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—ã—Å–æ–∫–æ–π –ø—Ä–∏–±—ã–ª–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–ø–∞–¥–∞ –ø–æ–∫—É–ø–∞–∏—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥–æ –ª–∏—à—å —Ç–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —É –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ø–∞–¥–∞ –∏ –≤—ã—Å–æ–∫–∏–µ —Ç—Ä–∞—Ç—ã (–æ–Ω–∏ –∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —Ö–æ—á–µ—Ç—Å—è –æ—Ç–ø—É—Å–∫–∞—Ç—å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ).

–í—ã–ø–æ–ª–Ω–∏–º —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. 
–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç `cust_seg` –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥—É—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ `merged_market_file`. 

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚ùå\
<font color='red'> ~~–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç –ø–æ –¥–≤—É–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –∏ –ø—Ä–∏–±—ã–ª—å), –¥–ª—è —ç—Ç–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä—É–µ–º –¥–≤–∞ –ø–æ—Ä–æ–≥–∞ –ø–æ —ç—Ç–∏–º –æ—Å—è–º.\
–≠—Ç–æ, —É—Å–ª–æ–≤–Ω–æ, —Ç–µ —Å –∫–µ–º –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Ä–∞–±–æ—Ç–∞—Ç—å.\
–ó–∞—Ç–µ–º –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≥—Ä—É–ø–ø—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ –∞–∫—Ü–∏–æ–Ω–Ω—ã–º –ø–æ–∫—É–ø–∫–∞–º) –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —ç—Ç–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å–æ –≤—Å–µ–º–∏ –æ—Å—Ç–∞–ª—å–Ω—å–Ω—ã–º–∏–º –ø–æ –¥—Ä—É–≥–∏–º —Ñ–∞–∫—Ç–æ—Ä–∞–º, –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–∏–π (–º–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–ª–∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞—Ç—å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã). –ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.~~</font>


```python
cust_seg = merged_market_file.copy()
cust_seg.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>215349</td>
      <td>1</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–¥–∞</td>
      <td>4.4</td>
      <td>4</td>
      <td>819</td>
      <td>0.75</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>4472.0</td>
      <td>5216.0</td>
      <td>4971.6</td>
      <td>12</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>215350</td>
      <td>1</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>4.9</td>
      <td>3</td>
      <td>539</td>
      <td>0.14</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
      <td>4826.0</td>
      <td>5457.5</td>
      <td>5058.4</td>
      <td>8</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div>



–î–æ–±–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã—Ä—É—á–∫–∏.


```python
cust_seg=cust_seg.merge(money,how='inner')
```


```python
cust_seg.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 1290 entries, 0 to 1289
    Data columns (total 19 columns):
     #   Column                               Non-Null Count  Dtype  
    ---  ------                               --------------  -----  
     0   id                                   1290 non-null   int64  
     1   –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å            1290 non-null   int64  
     2   —Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞                          1290 non-null   object 
     3   —Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å                   1290 non-null   object 
     4   –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å                   1290 non-null   float64
     5   –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å                 1290 non-null   int64  
     6   –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                         1290 non-null   int64  
     7   –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏                    1290 non-null   float64
     8   –ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è                 1290 non-null   object 
     9   —Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç  1290 non-null   int64  
     10  –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª   1290 non-null   int64  
     11  –æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞                       1290 non-null   int64  
     12  —Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç                     1290 non-null   int64  
     13  –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü         1290 non-null   float64
     14  –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü             1290 non-null   float64
     15  –≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                1290 non-null   float64
     16  –≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü               1290 non-null   int64  
     17  –≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                  1290 non-null   int64  
     18  –ø—Ä–∏–±—ã–ª—å                              1290 non-null   float64
    dtypes: float64(6), int64(10), object(3)
    memory usage: 201.6+ KB


<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>

–¢–∞–∫–∂–µ —Å –ø–æ–º–æ—â—å—é –ª—É—á—à–µ–π –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏, –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å –ø–æ–º–æ—â—å—é `random_search`, –Ω–∞–π–¥–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–º–µ—Å—Ç–∏–º –≤ –¥–∞—Ç–∞—Å–µ—Ç `cust_seg` –≤ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü `–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞` (**–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ø–∞–¥–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**).


```python
proba = random_search.predict_proba(merged_market_file.drop(['–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å', 'id'], axis=1))
cust_seg['–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞'] = proba[:, 1]
```


```python
cust_seg.nunique()
```




    id                                     1290
    –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å                 2
    —Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞                               2
    —Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å                        2
    –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å                       41
    –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å                      3
    –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                            656
    –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏                        41
    –ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è                      6
    —Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç       6
    –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª       11
    –æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞                           10
    —Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç                         20
    –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü            786
    –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü               1114
    –≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                  1232
    –≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü                   19
    –≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                      20
    –ø—Ä–∏–±—ã–ª—å                                 397
    –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞                      1274
    dtype: int64



–í–∏–¥–Ω–æ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω6–∏–µ –ø—Ä–∏–±—ã–ª–∏ —Ä–∞–∑–±–∏—Ç—ã –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º. 


```python
cust_seg.sample(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–ø—Ä–∏–±—ã–ª—å</th>
      <th>–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>321</th>
      <td>215677</td>
      <td>1</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–¥–∞</td>
      <td>4.6</td>
      <td>4</td>
      <td>993</td>
      <td>0.24</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>2</td>
      <td>3</td>
      <td>9</td>
      <td>11</td>
      <td>4538.0</td>
      <td>4829.0</td>
      <td>5211.2</td>
      <td>17</td>
      <td>16</td>
      <td>3.98</td>
      <td>0.221925</td>
    </tr>
    <tr>
      <th>400</th>
      <td>215756</td>
      <td>0</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>5.4</td>
      <td>4</td>
      <td>923</td>
      <td>0.15</td>
      <td>–ö—É—Ö–æ–Ω–Ω–∞—è –ø–æ—Å—É–¥–∞</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>10</td>
      <td>4943.0</td>
      <td>5205.5</td>
      <td>5563.0</td>
      <td>18</td>
      <td>17</td>
      <td>5.23</td>
      <td>0.058876</td>
    </tr>
    <tr>
      <th>992</th>
      <td>216349</td>
      <td>0</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>5.5</td>
      <td>4</td>
      <td>341</td>
      <td>0.16</td>
      <td>–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>10</td>
      <td>5394.0</td>
      <td>5230.5</td>
      <td>5218.8</td>
      <td>13</td>
      <td>11</td>
      <td>2.32</td>
      <td>0.081246</td>
    </tr>
    <tr>
      <th>1219</th>
      <td>216576</td>
      <td>0</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–¥–∞</td>
      <td>5.8</td>
      <td>4</td>
      <td>176</td>
      <td>0.28</td>
      <td>–î–æ–º–∞—à–Ω–∏–π —Ç–µ–∫—Å—Ç–∏–ª—å</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>5150.0</td>
      <td>4334.0</td>
      <td>3756.8</td>
      <td>18</td>
      <td>15</td>
      <td>3.20</td>
      <td>0.061626</td>
    </tr>
    <tr>
      <th>237</th>
      <td>215593</td>
      <td>1</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–Ω–µ—Ç</td>
      <td>4.6</td>
      <td>3</td>
      <td>947</td>
      <td>0.33</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>6</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>4414.0</td>
      <td>3141.0</td>
      <td>4005.5</td>
      <td>8</td>
      <td>9</td>
      <td>3.12</td>
      <td>0.832327</td>
    </tr>
  </tbody>
</table>
</div>



<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ùå\
<font color='red'> ~~–ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –ø–∞, –Ω—É–∂–Ω–µ–Ω –∫–ª–∞—Å—Å 1.~~</font>

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–∏ `–ø—Ä–∏–±—ã–ª—å` –∏	`–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞`.


```python
cust_seg[['–ø—Ä–∏–±—ã–ª—å','–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞']].describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>–ø—Ä–∏–±—ã–ª—å</th>
      <td>1290.0</td>
      <td>3.998977</td>
      <td>1.010638</td>
      <td>0.860000</td>
      <td>3.300000</td>
      <td>4.050000</td>
      <td>4.670000</td>
      <td>7.430000</td>
    </tr>
    <tr>
      <th>–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞</th>
      <td>1290.0</td>
      <td>0.382340</td>
      <td>0.362178</td>
      <td>0.003031</td>
      <td>0.075561</td>
      <td>0.214696</td>
      <td>0.803683</td>
      <td>0.999992</td>
    </tr>
  </tbody>
</table>
</div>



- –í –ø–æ–ª—É—á–µ–Ω–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –≤–∏–¥–Ω–æ, —á—Ç–æ 75% –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª–µ–µ 3.3 —É.–µ. –∏ —Ç–µ–Æ –∫—Ç–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç –±–æ–ª—å—à–µ –∏ –Ω–∞–¥–æ —É—á–∏—Ç—ã–≤–∞—Ç—å.
- –í–∏–¥–Ω–æ, —á—Ç–æ —É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π (75%) –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ø–∞–¥–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 0.8.

–£–±–µ—Ä–µ–º –≤—Å–µ –Ω–µ–Ω—É–∂–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–µ–≥–º–µ–Ω—Ç.


```python
### —Å–æ–∑–¥–∞–µ–º —Ü–≤–µ—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É –¥–ª—è –∞–∫—Ü–∏–π
cmap = plt.get_cmap('Greens')
# –æ–±–æ–∑–Ω–∞—á–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–µ–≥–º–µ–Ω—Ç
seg=(cust_seg['–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞']>0.8)&(cust_seg['–ø—Ä–∏–±—ã–ª—å']>3.3)
# —Å–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–∫—É–ø–∞–µ–º—ã—Ö –ø–æ –∞–∫—Ü–∏–∏
colors = [cmap(0.4*x+0.3) for x in seg]

plt.figure(figsize=(12, 6))
plt.scatter(x='–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞', y='–ø—Ä–∏–±—ã–ª—å', data=cust_seg,
            c=colors, alpha=0.7)
#plt.colorbar(label='–î–æ–ª—è –ø–æ–∫—É–ø–æ–∫ –ø–æ –∞–∫—Ü–∏–∏')  # –¥–æ–±–∞–≤–∏–º —Ü–≤–µ—Ç–æ–≤—É—é —à–∫–∞–ª—É –¥–ª—è –∞–∫—Ü–∏–π
#plt.legend()
plt.title('–ê–Ω–∞–ª–∏–∑ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–Ω–∏–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–±—ã–ª–∏ –æ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª—è')
plt.xlabel('–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏')
plt.ylabel('–ü—Ä–∏–±—ã–ª—å')
plt.axvline(x=0.8,color='purple',linestyle='--')
plt.axhline(y=3.3,color='purple',linestyle='--')
plt.show()
```


    
![png](output_211_0.png)
    


<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
<font color='green'> –û—Ç–ª–∏—á–Ω–æ!  üëç</font>
<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚ùå\
<font color='red'> <s>–ù—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç –ø–æ –¥–≤—É–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è (`predict_proba()[:, 1]`) –∏ –ø—Ä–∏–±—ã–ª—å), –¥–ª—è —ç—Ç–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä—É–µ–º –¥–≤–∞ –ø–æ—Ä–æ–≥–∞ –ø–æ —ç—Ç–∏–º –æ—Å—è–º, –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ —ç—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏–µ.
![](https://i.postimg.cc/DZ3GSqwK/102458.png)

–≠—Ç–æ, —É—Å–ª–æ–≤–Ω–æ, —Ç–µ —Å –∫–µ–º –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Ä–∞–±–æ—Ç–∞—Ç—å.\
–ó–∞—Ç–µ–º –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≥—Ä—É–ø–ø—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ –∞–∫—Ü–∏–æ–Ω–Ω—ã–º –ø–æ–∫—É–ø–∫–∞–º) –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —ç—Ç–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å–æ –≤—Å–µ–º–∏ –æ—Å—Ç–∞–ª—å–Ω—å–Ω—ã–º–∏–º –ø–æ –¥—Ä—É–≥–∏–º —Ñ–∞–∫—Ç–æ—Ä–∞–º, –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–∏–π (–º–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–ª–∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞—Ç—å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã). –ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.</s></font>
–°–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç `target`, –∫—É–¥–∞ –ø–æ–º–µ—Å—Ç–∏–º –ª–∏—à—å –Ω—É–∂–Ω—ã–µ –Ω–∞–º –∑–Ω–∞—á–µ–Ω–∏—è.


```python
target=cust_seg.query('(–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞>0.8)&(–ø—Ä–∏–±—ã–ª—å>3.3)')
```


```python
target.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 250 entries, 0 to 1278
    Data columns (total 20 columns):
     #   Column                               Non-Null Count  Dtype  
    ---  ------                               --------------  -----  
     0   id                                   250 non-null    int64  
     1   –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å            250 non-null    int64  
     2   —Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞                          250 non-null    object 
     3   —Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å                   250 non-null    object 
     4   –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å                   250 non-null    float64
     5   –º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å                 250 non-null    int64  
     6   –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                         250 non-null    int64  
     7   –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏                    250 non-null    float64
     8   –ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è                 250 non-null    object 
     9   —Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç  250 non-null    int64  
     10  –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª   250 non-null    int64  
     11  –æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞                       250 non-null    int64  
     12  —Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç                     250 non-null    int64  
     13  –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü         250 non-null    float64
     14  –≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü             250 non-null    float64
     15  –≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                250 non-null    float64
     16  –≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü               250 non-null    int64  
     17  –≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü                  250 non-null    int64  
     18  –ø—Ä–∏–±—ã–ª—å                              250 non-null    float64
     19  –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞                    250 non-null    float64
    dtypes: float64(7), int64(10), object(3)
    memory usage: 41.0+ KB


–°–æ–∑–¥–∞–¥–∏–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –¢–∞–∫ –∫–∞–∫ —Ç–æ—á–Ω–∞—è –ø—Ä–∏—Ä–æ–¥–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–Ω–≥–æ–≤—É—é –∫–æ—Ä–µ–ª—è—Ü–∏—é –°–ø–∏—Ä–º–∞–Ω–∞.


```python
correlation_matrix = target.drop(['id'], axis=1).corr(method='spearman')
plt.figure(figsize=(15, 6))
sns.heatmap(correlation_matrix, annot=True, cmap='Greens')
plt.yticks()
plt.title(f'–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏')
plt.show()
```


    
![png](output_218_0.png)
    


–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É–º–µ—Ä–µ–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è   –º–µ–∂–¥—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –¥–æ–ª–µ–π –ø–æ–∫—É–ø–æ–∫ –ø–æ –∞–∫—Ü–∏—è–º(`0.42`), –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (`0.34`) –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∑–∞ –≤–∏–∑–∏—Ç (`0,31`). 

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ü–µ–Ω–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –ø–æ–∫—É–ø–æ–∫ –ø–æ –∞–∫—Ü–∏—è–º –Ω–∞ –≤—ã—Ä—É—á–∫—É –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

–ü–æ—Å–º–æ—Ç—Ä–∏–º –ø–æ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø—ã.


```python
target.sample(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
      <th>—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</th>
      <th>–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</th>
      <th>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
      <th>–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</th>
      <th>–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</th>
      <th>–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</th>
      <th>—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü</th>
      <th>–ø—Ä–∏–±—ã–ª—å</th>
      <th>–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>130</th>
      <td>215484</td>
      <td>1</td>
      <td>–ø—Ä–µ–º–∏—É–º</td>
      <td>–Ω–µ—Ç</td>
      <td>2.9</td>
      <td>5</td>
      <td>448</td>
      <td>0.23</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>4</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
      <td>4267.0</td>
      <td>5059.0</td>
      <td>5018.7</td>
      <td>5</td>
      <td>7</td>
      <td>5.64</td>
      <td>0.959282</td>
    </tr>
    <tr>
      <th>275</th>
      <td>215631</td>
      <td>1</td>
      <td>—Å—Ç–∞–Ω–¥–∞—Ä—Ç</td>
      <td>–Ω–µ—Ç</td>
      <td>4.6</td>
      <td>5</td>
      <td>345</td>
      <td>0.28</td>
      <td>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>4566.0</td>
      <td>5020.5</td>
      <td>4802.1</td>
      <td>6</td>
      <td>7</td>
      <td>3.47</td>
      <td>0.964724</td>
    </tr>
  </tbody>
</table>
</div>



### –ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø—ã


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
def pie_dg1(data, column):
    columns_counts = data[column].value_counts()
    plt.figure(figsize=(5, 5))
    plt.pie(columns_counts, labels=columns_counts.index, autopct='%1.1f%%')
    plt.title(f'–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ "{column}"')
    plt.show()
    
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
def draw_hist1(data, column):
    plt.figure(figsize=(7, 5))
    sns.set()
    sns.histplot(data=data, x=column, kde=True, bins=15, color='green')
    plt.title(f'–ü–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è "{column}"')
    plt.xlabel(column, fontsize=14)
    plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞', fontsize=14)
    plt.show()
    
 # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü   
    
 # —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
def pie_dg2(data1,data2, column):
    fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(20, 5))
    columns_counts1 = data1[column].value_counts()
    columns_counts2 = data2[column].value_counts()
    plt.figure(figsize=(5, 5))
   
    axes[0].pie(columns_counts1, labels=columns_counts1.index, autopct='%1.1f%%',normalize=True)
    axes[1].pie(columns_counts2, labels=columns_counts2.index, autopct='%1.1f%%',normalize=True)
    axes[0].set_title(f'–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ "{column}" –ø—Ä–∏ –¥–æ–ª–µ –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –º–µ–Ω—å—à–µ 0.6')
    axes[1].set_title(f'–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ "{column}" –ø—Ä–∏ –¥–æ–ª–µ –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –±–æ–ª—å—à–µ 0.6')
    plt.show()
    
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
def draw_hist2(data1,data2, column):
    plt.figure(figsize=(7, 5))
    sns.set()
    sns.histplot(data=data1, x=column, kde=True, bins=15, color='green')
    sns.histplot(data=data2, x=column, kde=True, bins=15, color='blue')
    plt.title(f'–ü–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è "{column}"')
    plt.xlabel(column, fontsize=14)
    plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞', fontsize=14)
    plt.legend(['–º–µ–Ω—å—à–µ 0.6','–±–æ–ª—å—à–µ 0.6'])
    plt.show()   
```

–ü–æ—Å—Ç—Ä–æ–∏–º –∫—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏–æ–±—Ä–µ—Ç–∞–ª–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å –ø–æ–Ω–∏–∂–µ–Ω–æ–π –∏ —Å–æ—Ö—Ä–∞–Ω–Ω–µ–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é.


```python
cat = ['–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è','—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞', '—Ä–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å','–ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å']# –∫–∞—Ç–µ–≥—à–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
num = ['–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å', '–º–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å',
    '–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', '—Å—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
    '–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', '–æ—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞', '—Å—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç',
    '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '–≤—ã—Ä—É—á–∫–∞_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
    '–≤—ã—Ä—É—á–∫–∞_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü', '–≤—Ä–µ–º—è_–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü',
    '–≤—Ä–µ–º—è_—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü','–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å_—Å–ø–∞–¥–∞','–ø—Ä–∏–±—ã–ª—å']#–∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
```


```python
# –≤—ã–∑–æ–≤–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏ –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–ª–∏ –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫–∏
draw_hist1(target, '–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏')
```


    
![png](output_227_0.png)
    



```python
target['–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏'].describe().T
```




    count    250.000000
    mean       0.522280
    std        0.311872
    min        0.120000
    25%        0.280000
    50%        0.350000
    75%        0.930000
    max        0.990000
    Name: –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏, dtype: float64



–í–∏–¥–Ω–æ, —á—Ç–æ –¥–æ–ª—è –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –¥–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞. 


```python
(target.query('–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏<0.6'))['–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏'].describe().T
```




    count    162.000000
    mean       0.296605
    std        0.061726
    min        0.120000
    25%        0.240000
    50%        0.300000
    75%        0.350000
    max        0.400000
    Name: –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏, dtype: float64




```python
(target.query('–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏>0.6'))['–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏'].describe().T
```




    count    88.000000
    mean      0.937727
    std       0.043727
    min       0.740000
    25%       0.930000
    50%       0.940000
    75%       0.980000
    max       0.990000
    Name: –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏, dtype: float64



–û–¥–∏–Ω –∫–ª–∞—Å—Ç–µ—Ä –æ—Ç 0 –¥–æ 0.4, –≤—Ç–æ—Ä–æ–π –æ—Ç 0.74 –¥–æ 1. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ, –ø–µ—Ä–≤–∞—è –ø–æ–¥–≥—Ä—É–ø–ø–∞ –ø–æ–ª—É—á–∏–ª–∞ –º–∞–ª–æ –∞–∫—Ü–∏–π, –∞ –≤—Ç–æ—Ä–∞—è –º–Ω–æ–≥–æ. –ù–æ —Ç–µ –∏ –¥—Ä—É–≥–∏–µ –±—Ä–∞–ª–∏ –∏—Ö, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –≤ –∞–∫—Ü–∏–æ–æ–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º.

–†–∞–∑–¥–µ–ª–∏–º –¥–∞—Ç–∞—Å–µ—Ç `target` –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–ª—å—à–µ –¥–æ–ª—è –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ 0.6 –∏–ª–∏ –Ω–µ—Ç.


```python
# —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
target1=target.query('–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏<0.6')
target2=target.query('–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏>0.6')
```


```python
target1.shape
```




    (162, 20)




```python
target2.shape
```




    (88, 20)



–ö–∞–∫ –≤–∏–¥–Ω–æ –≤ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫  –º–µ–Ω—å—à–µ 0.4 –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±–æ–ª—å—à–µ —á–µ–º —Ç–µ—Ö, —É –∫–æ–≥–æ –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –±–æ–ª—å—à–µ 0.74

–ü–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –ø–æ–¥–≥—Ä—É–ø–ø–∞—Ö.


```python
# –≤—ã–∑–æ–≤–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏ –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
for i in num:
    draw_hist2(target1,target2, i)
   
    
```


    
![png](output_239_0.png)
    



    
![png](output_239_1.png)
    



    
![png](output_239_2.png)
    



    
![png](output_239_3.png)
    



    
![png](output_239_4.png)
    



    
![png](output_239_5.png)
    



    
![png](output_239_6.png)
    



    
![png](output_239_7.png)
    



    
![png](output_239_8.png)
    



    
![png](output_239_9.png)
    



    
![png](output_239_10.png)
    



    
![png](output_239_11.png)
    



    
![png](output_239_12.png)
    



    
![png](output_239_13.png)
    



    
![png](output_239_14.png)
    


**–í—ã–≤–æ–¥**: –ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ù–æ –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –≤—ã—Ä—É—á–∫–∏ –∑–∞ —Ç—Ä–∏ –ø—Ä–µ–¥—ã–¥—É—à–∏—Ö –º–µ—Å—è—Ü–∞ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –∏–º–µ–µ—Ç –¥–æ–ª—é –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –º–µ–Ω—å—à–µ 0.6, –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–∏–∫:
- –í –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–º –º–µ—Å—è—Ü–µ —Å–ª–∞–±—ã–π –ø—Ä–∏ –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ 4400-4800.
- –í –ø—Ä–µ–¥—ã–¥—É—â–µ–º –º–µ—Å—è—Ü–µ –∑–∞–º–µ—Ç–Ω—ã–π –ø—Ä–∏ –¥–∏–∞–ø–æ–∑–æ–Ω–µ 5000-6000.
- –í —Ç–µ–∫—É—â–µ–º –∑–∞–º–µ—Ç–Ω—ã–π –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ 5000-6500.
–≠—Ç–æ –º–æ–∂–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å, —á—Ç–æ –∞–∫—Ü–∏–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –≤ –¥–∞–Ω–Ω–æ–º –¥–∏–∞–ø–æ–∑–æ–Ω–µ —Ü–µ–Ω –±—ã–ª–æ —Ç—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏.
–î–ª—è —Ç–µ—Ö, –∫—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ –∞–∫—Ü–∏–π, –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ø–∞–¥–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ 1.0, –≤ —Ç–æ –≤—Ä–µ–º—è –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫ 0,95. –≠—Ç–æ –º–æ–∂–Ω–æ, –æ–±—ä—è—Å–Ω–∏—Ç—å, —á—Ç–æ —Ç–µ –∫—Ç–æ –∏–º–µ–ª —Å–∫–∏–¥–∫—É —É–∂–µ –∫—É–ø–∏–ª–∏ –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä, –∞ —Ü–µ–Ω–∞ –±–µ–∑ –∞–∫—Ü–∏–∏ –∏—Ö –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç.

–ü—Ä–æ–≤–µ–¥–µ–º –∞–Ω–∞–ª–∏–∑ –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.


```python
for i in cat:
    pie_dg2(target1,target2, i)
```


    
![png](output_242_0.png)
    



    <Figure size 360x360 with 0 Axes>



    
![png](output_242_2.png)
    



    <Figure size 360x360 with 0 Axes>



    
![png](output_242_4.png)
    



    <Figure size 360x360 with 0 Axes>



    
![png](output_242_6.png)
    



    <Figure size 360x360 with 0 Axes>


**–í—ã–≤–æ–¥**: –ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –±–æ–ª—å—â–µ –≤—Å–µ–≥–æ —Ä–∞–∑–ª–∏—á–∏–π –≤ —Ä–∞–∑–¥–µ–ª–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤. 
- `–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã` –∏ `–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞` –±–æ–ª—å—à–µ –ø–æ–∫—É–ø–∞—é—Ç –±–µ–∑ —Å–∫–∏–¥–∫–∏.
- `–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π` –±–æ–ª—å—à–µ –ø–æ–∫—É–ø–∞—é—Ç –ø–æ –∞–∫—Ü–∏–∏.
–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ —Å –≤—ã—Å–æ–∫–æ–π –¥–æ–ª–µ–π –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –∏–º–µ–µ—Ç –º–µ–Ω—å—à–∏—é –¥–æ–ª—é —Å–µ—Ä–≤–∏—Å–∞ —Ç–∏–ø–∞ –ü—Ä–µ–º–∏—É–º. –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –ü—Ä–µ–º–∏—É–º —Å–ø–æ—Å–æ–±–µ–Ω –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å, —á–∞—Å—Ç—å –∞–∫—Ü–∏–π.

–ú–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ –∞–∫—Ü–∏–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π `–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã` –∏ `–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞` —Ç—Ä—É–¥–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏—Ö –Ω–∞–π—Ç–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–ø–∞–¥—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π` –∞–∫—Ü–∏–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–∏—Å—ã—Ç–∏–≤–∞–µ—Ç—Å—è –∏ —Ç–µ—Ä—è–µ—Ç –¥–∞–ª—å–Ω–µ–π—â–∏–π –∏–Ω—Ç–µ—Ä–µ—Å –∏—Ö –ø–æ–∫—É–ø–∞—Ç—å.

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>

**–í—ã–≤–æ–¥—ã:**

–î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ —Ü–µ–ª–µ–≤–∞—è –≥—Ä—É–ø–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–π –ø—Ä–∏–±—ã–ª—å—é, –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–∞–≥–∞–∑–∏–Ω–æ–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞, –±–æ–ª—å—à–µ 4 (—Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏) –∏ –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è–Ω–æ—Å—Ç—å—é —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚Äî –±–æ–ª–µ–µ 80%. 

–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É–º–µ—Ä–µ–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –¥–æ–ª–µ–π –ø–æ–∫—É–ø–æ–∫ –ø–æ –∞–∫—Ü–∏—è–º(`0.42`), –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (`0.34`) –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∑–∞ –≤–∏–∑–∏—Ç (`0,31`). –¢–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∑–∞ –≤–∏–∑–∏—Ç —Å–ª–æ–∂–Ω–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å (—ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ä–∞–±–æ—Ç–æ–π –≤—Å–µ–≥–æ —Å–∞–π—Ç–∞), —Ç–æ –±—ã–ª–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –≤–ª–∏—è–Ω–∏–µ –∞–∫—Ü–∏–π. 

–í —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ –¥–æ–ª—è –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –¥–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞. –û–¥–∏–Ω –∫–ª–∞—Å—Ç–µ—Ä –æ—Ç 0 –¥–æ 0.4, –≤—Ç–æ—Ä–æ–π –æ—Ç 0.74 –¥–æ 1. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ, –ø–µ—Ä–≤–∞—è –ø–æ–¥–≥—Ä—É–ø–ø–∞ –ø–æ–ª—É—á–∏–ª–∞ –º–∞–ª–æ –∞–∫—Ü–∏–π, –∞ –≤—Ç–æ—Ä–∞—è –º–Ω–æ–≥–æ. –ù–æ —Ç–µ –∏ –¥—Ä—É–≥–∏–µ –±—Ä–∞–ª–∏ –∏—Ö, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –≤ –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º. –ö–∞–∫ –≤–∏–¥–Ω–æ –≤ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫  –º–µ–Ω—å—à–µ 0.4 –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±–æ–ª—å—à–µ —á–µ–º —Ç–µ—Ö, —É –∫–æ–≥–æ –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –±–æ–ª—å—à–µ 0.74.

–ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –¥–æ–ª–∏ –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ù–æ –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –≤—ã—Ä—É—á–∫–∏ –∑–∞ —Ç—Ä–∏ –ø—Ä–µ–¥—ã–¥—É—à–∏—Ö –º–µ—Å—è—Ü–∞ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –∏–º–µ–µ—Ç –¥–æ–ª—é –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –º–µ–Ω—å—à–µ 0.6, –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–∏–∫:
- –í –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–º –º–µ—Å—è—Ü–µ —Å–ª–∞–±—ã–π –ø—Ä–∏ –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ 4400-4800.
- –í –ø—Ä–µ–¥—ã–¥—É—â–µ–º –º–µ—Å—è—Ü–µ –∑–∞–º–µ—Ç–Ω—ã–π –ø—Ä–∏ –¥–∏–∞–ø–æ–∑–æ–Ω–µ 5000-6000.
- –í —Ç–µ–∫—É—â–µ–º –∑–∞–º–µ—Ç–Ω—ã–π –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ 5000-6500.
–≠—Ç–æ –º–æ–∂–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å, —á—Ç–æ –∞–∫—Ü–∏–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –≤ –¥–∞–Ω–Ω–æ–º –¥–∏–∞–ø–æ–∑–æ–Ω–µ —Ü–µ–Ω –±—ã–ª–æ —Ç—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏.
–î–ª—è —Ç–µ—Ö, –∫—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ –∞–∫—Ü–∏–π, –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ø–∞–¥–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ 1.0, –≤ —Ç–æ –≤—Ä–µ–º—è –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫ 0,95. –≠—Ç–æ –º–æ–∂–Ω–æ, –æ–±—ä—è—Å–Ω–∏—Ç—å, —á—Ç–æ —Ç–µ –∫—Ç–æ –∏–º–µ–ª —Å–∫–∏–¥–∫—É —É–∂–µ –∫—É–ø–∏–ª–∏ –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä, –∞ —Ü–µ–Ω–∞ –±–µ–∑ –∞–∫—Ü–∏–∏ –∏—Ö –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç. –ó–Ω–∞—á–∏—Ç –∞–∫—Ü–∏–∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è.

–ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –±–æ–ª—å—â–µ –≤—Å–µ–≥–æ —Ä–∞–∑–ª–∏—á–∏–π –≤ —Ä–∞–∑–¥–µ–ª–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤. 
- `–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã` –∏ `–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞` –±–æ–ª—å—à–µ –ø–æ–∫—É–ø–∞—é—Ç –±–µ–∑ —Å–∫–∏–¥–∫–∏.
- `–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π` –±–æ–ª—å—à–µ –ø–æ–∫—É–ø–∞—é—Ç –ø–æ –∞–∫—Ü–∏–∏.

–ú–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ –∞–∫—Ü–∏–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π `–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã` –∏ `–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞` —Ç—Ä—É–¥–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏—Ö –Ω–∞–π—Ç–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–ø–∞–¥—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π` –∞–∫—Ü–∏–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–∏—Å—ã—Ç–∏–≤–∞–µ—Ç—Å—è –∏ —Ç–µ—Ä—è–µ—Ç –¥–∞–ª—å–Ω–µ–π—â–∏–π –∏–Ω—Ç–µ—Ä–µ—Å –∏—Ö –ø–æ–∫—É–ø–∞—Ç—å.

–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ —Å –≤—ã—Å–æ–∫–æ–π –¥–æ–ª–µ–π –∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –∏–º–µ–µ—Ç –º–µ–Ω—å—à–∏—é –¥–æ–ª—é —Å–µ—Ä–≤–∏—Å–∞ —Ç–∏–ø–∞ –ü—Ä–µ–º–∏—É–º. –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –ü—Ä–µ–º–∏—É–º —Å–ø–æ—Å–æ–±–µ–Ω –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å, —á–∞—Å—Ç—å –∞–∫—Ü–∏–π.





---------

–ò—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:

1. –ù—É–∂–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ—Ñ–µ–ª—å –∏ –Ω–∞–π—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
2. –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤ `–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã` –∏ `–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞`—Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Å–¥–µ–ª–∞—Ç—å –∏—Ö –¥–æ—Å—Ç—É–ø–Ω–µ–µ, —á—Ç–æ–±—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–∞ —Å–∞–π—Ç–µ. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ —Å–∫–∏–¥–æ–∫ –Ω–∞ —Ç–æ–≤–∞—Ä—ã —Å —Ü–µ–Ω–æ–π 4000-6000.
3. –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ `–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π` —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ü–∏–π, —á—Ç–æ–±—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –Ω–µ –ø—Ä–µ—Å—ã—à–∞–ª–∏—Å—å. –ë—É–¥—É—Ç –º–µ–Ω—å—à–µ –ø–æ–∫—É–ø–∞—Ç—å –≤ –º–µ—Å—è—Ü, –Ω–æ –æ—Å—Ç–∞–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç–µ—é

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
<font color='green'> üëç</font>

## –û–±—â–∏–π –≤—ã–≤–æ–¥

<u>–ó–∞–¥–∞—á–∞</u>: —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ ¬´–í –æ–¥–∏–Ω –∫–ª–∏–∫¬ª, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

–î–ª—è —Ä–∞–±–æ—Ç—ã –±—ã–ª–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ —á–µ—Ç—ã—Ä–µ —Ñ–∞–π–ª–∞:
* `market_file.csv`: —Ç–∞–±–ª–∏—Ü–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –Ω–∞ —Å–∞–π—Ç–µ, –æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è—Ö —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º –∏ –µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–º –ø–æ–≤–µ–¥–µ–Ω–∏–∏.
* `market_money.csv`: —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –≤—ã—Ä—É—á–∫–µ, –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—É—á–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è, —Ç–æ –µ—Å—Ç—å —Å–∫–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –≤—Å–µ–≥–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª –∑–∞ –ø–µ—Ä–∏–æ–¥ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–∞–π—Ç–æ–º.
* `market_time.csv`: —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –≤—Ä–µ–º–µ–Ω–∏ (–≤ –º–∏–Ω—É—Ç–∞—Ö), –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–æ–≤—ë–ª –Ω–∞ —Å–∞–π—Ç–µ –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞.
* `money.csv`: —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞: –∫–∞–∫—É—é –ø—Ä–∏–±—ã–ª—å –ø–æ–ª—É—á–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω –æ—Ç –ø—Ä–æ–¥–∞–∂ –∫–∞–∂–¥–æ–º—É –ø–æ–∫—É–ø–∞—Ç–µ–ª—é.

–ù–∞ —ç—Ç–∞–ø–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤, —É–¥–∞–ª–µ–Ω—ã –≤—ã–±—Ä–æ—Å—ã, –¥—É–±–ª–∏–∫–∞—Ç—ã —è–≤–Ω—ã–µ –∏ –Ω–µ—è–≤–Ω—ã–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–µ –±—ã–ª–∏, —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ —Ç–∞–∫–∂–µ –Ω–µ –±—ã–ª–æ –≤–≤–∏–¥—É –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è.

–ë—ã–ª –ø—Ä–æ–≤–µ–¥–µ–Ω –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–∞–∫–∏—Ö-–ª–∏–±–æ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∏–ª–∏ –æ—Ç–æ—Ä–≤–∞–Ω–Ω—ã—Ö –æ—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –Ω–µ –±—ã–ª–æ.

–ë—ã–ª–∏ –æ—Ç—Ç–æ–±—Ä–∞–Ω—ã –∫–ª–µ–µ–Ω—Ç—ã –∫–æ—Ç–æ–ø—Ä—ã–µ —Å–æ–≤–µ—Ä—à–∞–ª–∏ –ø–æ–∫—É–ø–∫–∏ –≤ —Ç–µ—á–µ–Ω–∏–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç—Ä–µ—Ö –º–µ—Å—è—Ü–µ–≤. –î–ª—è —ç—Ç–æ–≥–æ –±—ã–ª–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã —Ç–∞–±–ª–∏—Ü—ã, –∏ –ø–æ–ª—É—á–µ–Ω—ã –ø–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –æ—Ç—Ä–∞–∂–∞—é—â–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Å—Ä–æ–∫. –ë—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –≤—ã—Å–æ–∫–æ–π –∏ –∑–∞–º–µ—Ç–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π.

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –±—ã–ª–∏ –≤—ã–±—Ä–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –º–æ–¥–µ–ª–∏: `KNeighborsClassifier()`, `DecisionTreeClassifier()`, `LogisticRegression()` –∏ `SVC()` —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –î–ª—è –ø–æ–¥–±–æ—Ä–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤—ã–±–æ—Ä–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –º–µ—Ç–æ–¥ `RandomizedSearchCV`. –î–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ø–∞–π–ø–ª–∞–π–Ω—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞–º–∏ (`OneHotEncoder()`, `OrdinalEncoder()`, `StandardScaler()`, `MinMaxScaler()`). –õ—É—á—à–µ–π –º–æ–¥–µ–ª—å—é –≤—ã–±—Ä–∞–Ω–∞ –º–æ–¥–µ–ª—å **SVC** —Å –ø–∞—Ä–∞–º–µ—Ä–∞–º–∏ C=1, degree=4, gamma=1, kernel='linear', probability=True –∏ random_state=42. –ú–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `0.9`. –ü–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `0.9`. –° –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ SHAP –±—ã–ª–∏ –æ—Ç–æ–±—Ä–∞–Ω—ã –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å —É—á–∏—Ç—ã–≤–∞–ª–∞ –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π.

–í –∫–∞—á–µ—Å—Ç–≤–µ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø—ã –±—ã–ª–∏ –æ—Ç–æ–±—Ä–∞–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏  —Å –≤—ã—Å–æ–∫–∏–º–∏ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ –Ω–∞ –ø–æ–∫—É–ø–∫–∏ –∏ —Å –Ω–µ –Ω–∏–∑–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

<u>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ </u>

1. –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏.

2. –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π `–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—É–∞—Ä—ã` –∏ `–ú–µ–ª–∫–∞—è –±—ã—Ç–æ–≤–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞` —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ–≤—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –∞–∫—Ü–∏–π.

3. –î–ª—è —Ç–µ—Ö –∫—Ç–æ –∏—â–µ—Ç –∏—Ö –Ω–∞ —Å–∞–π—Ç–µ –≤ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∞–∫—Ü–∏–∏, —á—Ç–æ–±—ã –∑–∞–≤–ª–µ—á –∏—Ö. 

4. –û—Å–æ–±–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∏–¥–æ–∫ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –≤ —Ü–µ–Ω–æ–≤–æ–º –¥–∏–∞–ø–æ–∑–æ–Ω–µ 4000-6000.

5. –î–ª—è `–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π` –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –∞–∫—Ü–∏–æ–Ω–Ω—É—é –ø–æ–ª–∏—Ç–∏–∫—É –∏ —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —Ä–µ–∫—Ç–∞–º—É –≤ —É—â–µ—Ä–± —Å–∫–∏–¥–∫–∞–º.

–ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–∏–±—ã–ª—å –∏ —É–º–µ–Ω—å—à–∏—Ç—å —Å–Ω–∏–∂–µ–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
<font color='green'> –û—á–µ–Ω—å –ø—Ä–∏—è—Ç–Ω–æ –≤–∏–¥–µ—Ç—å –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Ü–µ –ø—Ä–æ–µ–∫—Ç–∞!\
–ü—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≥–ª–∞–≤–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ–µ–∫—Ç–∞.</font>

<font color='blue'><b>–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>\
<font color='green'>–ê–ª–µ–∫—Å–∞–Ω–¥—Ä, —Ö–æ—Ä–æ—à–∏–π –ø—Ä–æ–µ–∫—Ç –ø–æ–ª—É—á–∏–ª—Å—è!
–ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É. –í–∏–¥–Ω–æ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–æ –º–Ω–æ–≥–æ —É—Å–∏–ª–∏–π.
–í—ã–≤–æ–¥—ã –∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –ø–æ–ª—É—á–∏–ª–∏—Å—å —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã–º–∏, –∏—Ö –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —á–∏—Ç–∞—Ç—å.
</font>

<font color='steelblue'>–ù–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –µ—â—ë —Å—Ç–æ–∏—Ç –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å - –µ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—é –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–≤–æ–∏—Ö —à–∞–≥–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞. –¢–∞–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —è –æ—Ç–º–µ—Ç–∏–ª –∂—ë–ª—Ç—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏. –ë—É–¥–µ—Ç –∑–¥–æ—Ä–æ–≤–æ, –µ—Å–ª–∏ —Ç—ã —É—á—Ç—ë—à—å –∏—Ö - —Ç–∞–∫ –ø—Ä–æ–µ–∫—Ç —Å—Ç–∞–Ω–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–º.

–¢–∞–∫–∂–µ –≤ —Ä–∞–±–æ—Ç–µ –µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è. –ö —ç—Ç–∏–º –∑–∞–º–µ—á–∞–Ω–∏—è–º —è –æ—Å—Ç–∞–≤–∏–ª –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫—Ä–∞—Å–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–µ—á–∏—Å–ª–∏–ª –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π. –£–≤–µ—Ä–µ–Ω, —Ç—ã –±—ã—Å—Ç—Ä–æ —Å —ç—Ç–∏–º —É–ø—Ä–∞–≤–∏—à—å—Å—è:)

–ï—Å–ª–∏ –æ —Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ —Ä–∞–º–∫–∞—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –±—É–¥—É—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã - –æ—Å—Ç–∞–≤—å –∏—Ö, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, –∏ —è –æ—Ç–≤–µ—á—É –Ω–∞ –Ω–∏—Ö –≤–æ –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–µ–≤—å—é.

–¢–∞–∫–∂–µ –±—É–¥—É —Ä–∞–¥ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ —Ç–≤–æ–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–æ–µ–∫—Ç—É –∏–ª–∏ –Ω–∞ –∫–∞–∫–∏–µ-–ª–∏–±–æ –¥—Ä—É–≥–∏–µ, –µ—Å–ª–∏ –æ–Ω–∏ —É —Ç–µ–±—è –∏–º–µ—é—Ç—Å—è - –æ—Å—Ç–∞–≤—å –∏—Ö –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, –∏ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å:)</font>

<font color='blue'><b>–ñ–¥—É —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Ä–µ–≤—å—é. –î–æ –≤—Å—Ç—Ä–µ—á–∏ :) </b></font>

<font color='blue'><b>–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2</b></font>\
<font color='green'>–ê–ª–µ–∫—Å–∞–Ω–¥—Ä, –±–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É.
</font>

<font color='blue'>–ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</font>
<ul><font color='red'>–ü–æ–ø—Ä–∞–≤—å –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ.</font></ul>
<ul><font color='red'>–ü–æ–ø—Ä–∞–≤—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.</font></ul>

<font color='blue'><b>–ñ–¥—É –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ–µ–∫—Ç–∞ :)</b></font>

<font color='blue'><b>–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3</b></font>\
<font color='green'> –ê–ª–µ–∫—Å–∞–Ω–¥—Ä, –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω—è—Ç! \
–í—Å–µ —ç—Ç–∞–ø—ã –ø—Ä–æ–π–¥–µ–Ω—ã. –í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —É—á—Ç–µ–Ω—ã.\
–ù–∞–¥–µ—é—Å—å, —Ç–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</font> \
<font color='blue'><b>–°–ø–∞—Å–∏–±–æ, —É–¥–∞—á–∏ –≤ –æ—Å–≤–æ–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏!</b></font>
