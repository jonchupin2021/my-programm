<div class="alert alert-info">
–ü—Ä–∏–≤–µ—Ç, –ê–ª–µ–∫—Å–∞–Ω–¥—Ä! –ú–µ–Ω—è –∑–æ–≤—É—Ç –°–≤–µ—Ç–ª–∞–Ω–∞ –ß–∏—Ö –∏ —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç. –ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ—é –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ. –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—â–∞—Ç—å—Å—è –Ω–∞ ¬´—Ç—ã¬ª. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —É–¥–æ–±–Ω–æ - –¥–∞–π –∑–Ω–∞—Ç—å, –∏ –º—ã –ø–µ—Ä–µ–π–¥–µ–º –Ω–∞ ¬´–≤—ã¬ª.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –ó–µ–ª—ë–Ω—ã–º —Ü–≤–µ—Ç–æ–º –æ—Ç–º–µ—á–µ–Ω—ã —É–¥–∞—á–Ω—ã–µ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.
</div>
<div class="alert alert-warning">
<b>ü§î –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</b> –ñ—ë–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º –≤—ã–¥–µ–ª–µ–Ω–æ —Ç–æ, —á—Ç–æ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É. –¢—ã –º–æ–∂–µ—à—å —É—á–µ—Å—Ç—å —ç—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—É–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∏–ª–∏ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Å–µ–π—á–∞—Å (–æ–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ).
</div>
<div class="alert alert-danger">
<b>üòî –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</b> –ö—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º –≤—ã–¥–µ–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö, —è –Ω–µ —Å–º–æ–≥—É –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–æ–µ–∫—Ç :(
</div>
<div class="alert alert-info">
<b>üëÇ –°–æ–≤–µ—Ç:</b> –ö–∞–∫–∏–µ-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
</div>
–î–∞–≤–∞–π —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –¥–∏–∞–ª–æ–≥–µ: –µ—Å–ª–∏ —Ç—ã —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø–æ –º–æ–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º ‚Äî –ø–∏—à–∏ –æ–± —ç—Ç–æ–º.
–ú–Ω–µ –±—É–¥–µ—Ç –ª–µ–≥—á–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —Ç—ã –≤—ã–¥–µ–ª–∏—à—å —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
<div class="alert alert-info"> <b>üéì –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫.</div>
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –í—Å—ë —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã—Å—Ç—Ä–µ–µ.
 </div>

–ü—Ä–æ—ç–∫—Ç: –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –±–∏–∑–Ω–µ—Å–µ –∏ —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é. –î–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞—Ö, –∞ –¥–ª—è –Ω–µ–∫—Ç–æ—Ä—ã—Ö –∏—Ö –º–Ω–µ–Ω–∏–µ –æ —Ä–∞–±–æ—Ç–µ –∏ –¥–∞–Ω–Ω—ã–µ –æ —É–≤–æ–ª—å–Ω–µ–Ω–∏—è—Ö. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª–∞ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç —Ä–∞–±–æ—Ç—ã –∏ —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø—Ä–æ—ç–∫—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ, –∏ —Å–æ—Å—Ç–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â–∏–µ —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ. –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É –º–æ–∂–Ω–æ –ª–µ–≥—á–µ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –±–∏–∑–Ω–µ—Å—Å-–≤–æ–ø—Ä–æ—Å—ã.


```python
# –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–∏–ø—ã
!pip install shap -q
!pip install phik  -q
!pip install matplotlib==3.5.0 -q
!pip install scikit-learn==1.3.2 -q
```


```python
# –∑–∞–≥—Ä—É–∂–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import pandas as pd
from sklearn.linear_model import LinearRegression
from sklearn.tree import DecisionTreeRegressor
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.pipeline import Pipeline
from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import OneHotEncoder, OrdinalEncoder, StandardScaler, MinMaxScaler, RobustScaler
from sklearn.impute import SimpleImputer
from sklearn.metrics import roc_auc_score
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import GridSearchCV
from sklearn.model_selection import RandomizedSearchCV
from sklearn.linear_model import LogisticRegression
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.svm import SVC
from sklearn.feature_selection import SelectKBest, f_classif
from sklearn.preprocessing import StandardScaler, PolynomialFeatures
from sklearn.datasets import make_classification
from sklearn import svm
from sklearn import model_selection, metrics
from sklearn.metrics import make_scorer
import phik
import shap
from phik.report import plot_correlation_matrix
from phik import report
from sklearn.impute import SimpleImputer 
from sklearn.ensemble import RandomForestClassifier
pd.set_option('display.max_columns', None)
%matplotlib inline
```

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω—É–∂–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏!
</div>

# –ó–∞–¥–∞–Ω–∏–µ 1. –°–æ—Å—Ç–æ–≤–ª–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏.

## –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö


```python
# –∑–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª—ã 
train = pd.read_csv('/datasets/train_job_satisfaction_rate.csv') # —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
data = pd.read_csv('/datasets/test_features.csv') # –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
target = pd.read_csv('/datasets/test_target_job_satisfaction_rate.csv') # —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
```

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –î–∞—Ç–∞—Å–µ—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã!
</div>

## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞–∂–¥—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏.


```python
train.sample(2)# —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>dept</th>
      <th>level</th>
      <th>workload</th>
      <th>employment_years</th>
      <th>last_year_promo</th>
      <th>last_year_violations</th>
      <th>supervisor_evaluation</th>
      <th>salary</th>
      <th>job_satisfaction_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1398</th>
      <td>115447</td>
      <td>technology</td>
      <td>middle</td>
      <td>high</td>
      <td>6</td>
      <td>no</td>
      <td>no</td>
      <td>3</td>
      <td>57600</td>
      <td>0.44</td>
    </tr>
    <tr>
      <th>1374</th>
      <td>673606</td>
      <td>technology</td>
      <td>middle</td>
      <td>high</td>
      <td>7</td>
      <td>no</td>
      <td>no</td>
      <td>3</td>
      <td>56400</td>
      <td>0.55</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 4000 entries, 0 to 3999
    Data columns (total 10 columns):
     #   Column                 Non-Null Count  Dtype  
    ---  ------                 --------------  -----  
     0   id                     4000 non-null   int64  
     1   dept                   3994 non-null   object 
     2   level                  3996 non-null   object 
     3   workload               4000 non-null   object 
     4   employment_years       4000 non-null   int64  
     5   last_year_promo        4000 non-null   object 
     6   last_year_violations   4000 non-null   object 
     7   supervisor_evaluation  4000 non-null   int64  
     8   salary                 4000 non-null   int64  
     9   job_satisfaction_rate  4000 non-null   float64
    dtypes: float64(1), int64(4), object(5)
    memory usage: 312.6+ KB


 –í–∏–¥–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–æ –æ–Ω–∏ —á–∞—Å—Ç–æ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ç–∞–∫ –∫–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö —Ç—Ä—É–¥–Ω–æ. –ü—Ä–æ–ø—É—Å–∫–∏ –µ—Å—Ç—å –ª–∏–Ω—å –≤ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ –æ—Ç–¥–µ–ª–æ–≤ –∏ —É—Ä–æ–≤–Ω–µ–π. 

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

–Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞–ø–∏—Å–∞–Ω—ã –ø–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏ –∏ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –ø–ª–æ—Ö–æ –≤ –Ω–µ–º —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è, –ª—É—á—à–µ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–∏–µ.


```python
column_mapping = {
    'dept': '–æ—Ç–¥–µ–ª',
    'level': '—É—Ä–æ–≤–µ–Ω—å',
    'workload': '–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å',
    'employment_years': '—Å—Ç–∞–∂',
    'last_year_promo': '–ø–æ–≤—ã—à–µ–Ω–∏–µ',
    'last_year_violations': '–Ω–∞—Ä—É—à–µ–Ω–∏–µ',
    'supervisor_evaluation': '–æ—Ü–µ–Ω–∫–∞',
    'salary': '–∑–∞—Ä–ø–ª–∞—Ç–∞',  
    'job_satisfaction_rate': '—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ',
    }

train.rename(columns=column_mapping, inplace=True)
```


```python
train.sample(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1176</th>
      <td>313180</td>
      <td>technology</td>
      <td>middle</td>
      <td>medium</td>
      <td>4</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>52800</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>1437</th>
      <td>479323</td>
      <td>sales</td>
      <td>middle</td>
      <td>high</td>
      <td>8</td>
      <td>no</td>
      <td>no</td>
      <td>3</td>
      <td>55200</td>
      <td>0.51</td>
    </tr>
  </tbody>
</table>
</div>




```python
#–î–ª—è –Ω–∞—á–∞–ª–æ –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–µ—Ç –ª–∏ —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.
train.duplicated().sum()
```




    0




```python
# –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã —Å—Ä–µ–¥–∏ –∏–Ω–¥–µ–∫—Å–æ–≤.
train['id'].duplicated().sum()
```




    0



–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã 


```python
num=['—Å—Ç–∞–∂','–æ—Ü–µ–Ω–∫–∞','–∑–∞—Ä–ø–ª–∞—Ç–∞','—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ'] # –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ
cat=['–æ—Ç–¥–µ–ª','—É—Ä–æ–≤–µ–Ω—å','–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å','–ø–æ–≤—ã—à–µ–Ω–∏–µ','–Ω–∞—Ä—É—à–µ–Ω–∏–µ'] # –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ
```


```python
for i in cat:
    print('–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ',i,' - —ç—Ç–æ',train[i].unique())
```

    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –æ—Ç–¥–µ–ª  - —ç—Ç–æ ['sales' 'hr' 'technology' 'purchasing' 'marketing' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ —É—Ä–æ–≤–µ–Ω—å  - —ç—Ç–æ ['junior' 'middle' 'sinior' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  - —ç—Ç–æ ['medium' 'high' 'low']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']


–û—à–∏–±–æ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>


```python
data.info() # –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2000 entries, 0 to 1999
    Data columns (total 9 columns):
     #   Column                 Non-Null Count  Dtype 
    ---  ------                 --------------  ----- 
     0   id                     2000 non-null   int64 
     1   dept                   1998 non-null   object
     2   level                  1999 non-null   object
     3   workload               2000 non-null   object
     4   employment_years       2000 non-null   int64 
     5   last_year_promo        2000 non-null   object
     6   last_year_violations   2000 non-null   object
     7   supervisor_evaluation  2000 non-null   int64 
     8   salary                 2000 non-null   int64 
    dtypes: int64(4), object(5)
    memory usage: 140.8+ KB


–í–∏–¥–Ω–æ, —á—Ç–æ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –≤ –¥–≤–∞ —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ —á–µ–º –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π.

–ü–æ–≤—Ç–æ—Ä–∏–º –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤


```python
column_mapping = {
    'dept': '–æ—Ç–¥–µ–ª',
    'level': '—É—Ä–æ–≤–µ–Ω—å',
    'workload': '–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å',
    'employment_years': '—Å—Ç–∞–∂',
    'last_year_promo': '–ø–æ–≤—ã—à–µ–Ω–∏–µ',
    'last_year_violations': '–Ω–∞—Ä—É—à–µ–Ω–∏–µ',
    'supervisor_evaluation': '–æ—Ü–µ–Ω–∫–∞',
    'salary': '–∑–∞—Ä–ø–ª–∞—Ç–∞',  
    #'job_satisfaction_rate': '—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ',
    }

data.rename(columns=column_mapping, inplace=True)
```


```python
data.sample(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1549</th>
      <td>310595</td>
      <td>sales</td>
      <td>sinior</td>
      <td>high</td>
      <td>4</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>70800</td>
    </tr>
    <tr>
      <th>1016</th>
      <td>173430</td>
      <td>purchasing</td>
      <td>middle</td>
      <td>high</td>
      <td>5</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>58800</td>
    </tr>
  </tbody>
</table>
</div>



–ü–æ—Å–º–æ—Ç—Ä–∏–º –µ—Å—Ç—å –ª–∏ —è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã.


```python
data.duplicated().sum()
```




    0




```python
# –µ—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –∏–Ω–¥–µ–∫—Å–∞—Ö
data['id'].duplicated().sum()
```




    0



–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤


```python
for i in cat:
    print('–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ',i,' - —ç—Ç–æ',data[i].unique())
```

    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –æ—Ç–¥–µ–ª  - —ç—Ç–æ ['marketing' 'hr' 'sales' 'purchasing' 'technology' nan ' ']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ —É—Ä–æ–≤–µ–Ω—å  - —ç—Ç–æ ['junior' 'middle' 'sinior' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  - —ç—Ç–æ ['medium' 'low' 'high' ' ']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']


–í–∏–¥–Ω–æ, —á—Ç–æ –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç–∏ –µ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏, –Ω–æ –≤ —Å—Ç–æ–ª–±—Ü–µ `–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å` –∏ `–æ—Ç–¥–µ–ª` –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ ''. –≠—Ç–æ –ø—Ä–æ–ø—É—Å–∫–∏, –Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º, –ø–æ—è—Ç–æ–º—É –µ–≥–æ –Ω–∞–¥–æ –∏–∑–º–µ–Ω–∏—Ç—å.


```python
for i in cat:
    data[i]=data[i].replace(' ', np.nan)
```

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–Ω–æ–≤–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.


```python
for i in cat:
    print('–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ',i,' - —ç—Ç–æ',data[i].unique())
```

    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –æ—Ç–¥–µ–ª  - —ç—Ç–æ ['marketing' 'hr' 'sales' 'purchasing' 'technology' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ —É—Ä–æ–≤–µ–Ω—å  - —ç—Ç–æ ['junior' 'middle' 'sinior' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  - —ç—Ç–æ ['medium' 'low' 'high' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']


–ö–∞–∫ –≤–∏–¥–Ω–æ –æ—à–∏–±–æ–∫ –±–æ–ª—å—à–µ –Ω–µ—Ç.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>


```python
target.head(2) # —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>job_satisfaction_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>130604</td>
      <td>0.74</td>
    </tr>
    <tr>
      <th>1</th>
      <td>825977</td>
      <td>0.75</td>
    </tr>
  </tbody>
</table>
</div>




```python
target.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2000 entries, 0 to 1999
    Data columns (total 2 columns):
     #   Column                 Non-Null Count  Dtype  
    ---  ------                 --------------  -----  
     0   id                     2000 non-null   int64  
     1   job_satisfaction_rate  2000 non-null   float64
    dtypes: float64(1), int64(1)
    memory usage: 31.4 KB


–ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–µ—Ç. 


```python
# –ó–∞–º–µ–Ω–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–µ
target.rename(columns={'job_satisfaction_rate': '—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ'}, inplace=True)
target.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2000 entries, 0 to 1999
    Data columns (total 2 columns):
     #   Column        Non-Null Count  Dtype  
    ---  ------        --------------  -----  
     0   id            2000 non-null   int64  
     1   —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ  2000 non-null   float64
    dtypes: float64(1), int64(1)
    memory usage: 31.4 KB



```python
#–ì–ª–∞–≤–Ω–æ–µ –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–Ω–¥–µ–∫—Å—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç.
(data['id']==target['id']).sum()
```




    0




```python
data.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>485046</td>
      <td>marketing</td>
      <td>junior</td>
      <td>medium</td>
      <td>2</td>
      <td>no</td>
      <td>no</td>
      <td>5</td>
      <td>28800</td>
    </tr>
    <tr>
      <th>1</th>
      <td>686555</td>
      <td>hr</td>
      <td>junior</td>
      <td>medium</td>
      <td>1</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>467458</td>
      <td>sales</td>
      <td>middle</td>
      <td>low</td>
      <td>5</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>19200</td>
    </tr>
  </tbody>
</table>
</div>




```python
target.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>130604</td>
      <td>0.74</td>
    </tr>
    <tr>
      <th>1</th>
      <td>825977</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>418490</td>
      <td>0.60</td>
    </tr>
  </tbody>
</table>
</div>



–í–ø–æ–ª–Ω–µ –≤–æ–∑–º–æ–∂–Ω–æ, —á—Ç–æ –∏–Ω–¥–µ–∫—Å—ã –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–µ –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ.


```python
(data.sort_values(by='id').reset_index(drop=True)['id']==target.sort_values(by='id').reset_index(drop=True)['id']).sum()
```




    2000



–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ü–µ–ª–µ–≤–æ–π —Å–æ–≤–ø–∞–¥–∞–ø—é—Ç.

**–í—ã–≤–æ–¥** –ë—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Ç–∞–±–ª–∏—Ü–∞. –í –Ω–∏—Ö –Ω–µ –±—ã–ª–æ –Ω–µ–π–¥–µ–Ω–æ –æ–ø–µ—á–∞—Ç–æ–∫. –ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

## –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–ø–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ç–∞–±–ª–∏—Ü.


```python
train.describe().T # –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>4000.0</td>
      <td>544957.621000</td>
      <td>257883.104622</td>
      <td>100954.00</td>
      <td>322836.75</td>
      <td>534082.50</td>
      <td>771446.00</td>
      <td>999521.0</td>
    </tr>
    <tr>
      <th>—Å—Ç–∞–∂</th>
      <td>4000.0</td>
      <td>3.718500</td>
      <td>2.542513</td>
      <td>1.00</td>
      <td>2.00</td>
      <td>3.00</td>
      <td>6.00</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <td>4000.0</td>
      <td>3.476500</td>
      <td>1.008812</td>
      <td>1.00</td>
      <td>3.00</td>
      <td>4.00</td>
      <td>4.00</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <td>4000.0</td>
      <td>33926.700000</td>
      <td>14900.703838</td>
      <td>12000.00</td>
      <td>22800.00</td>
      <td>30000.00</td>
      <td>43200.00</td>
      <td>98400.0</td>
    </tr>
    <tr>
      <th>—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ</th>
      <td>4000.0</td>
      <td>0.533995</td>
      <td>0.225327</td>
      <td>0.03</td>
      <td>0.36</td>
      <td>0.56</td>
      <td>0.71</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>



–í —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–Ω–æ, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º 3 –≥–æ–¥—ã, –º–∞–∫—Å–∏–º—É–º 10. –õ—É—á—à–∞—è –æ—Ü–µ–Ω–∫–∞ —ç—Ç–æ 5 (–∫–∞–∫ –∏ —Å–ª–µ–¥–æ–≤–∞–ª–æ –æ–∂–∏–¥–∞—Ç—å), –≤ —Å—Ä–µ–¥–Ω–µ–º —ç—Ç–æ 3,5 ( –ø–æ –º–µ–¥–∏–∞–Ω–µ 4) –¥–∞ –∏ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –æ—Ü–µ–Ω–æ–∫ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É 3 –∏ 4. –ó–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ –æ—Ç 12 –¥–æ 98,4 —Ç—ã—Å., –∞ –≤—Å—Ä–µ–¥–Ω–µ–º —Å–æ—Å—Ç–æ–≤–ª—è–µ—Ç 30 —Ç—ã—Å. (–º–µ–¥–∏–∞–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–ª–∏–∫–æ). –ó–Ω–∞—á–µ–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç —Ä–∞–±–æ—Ç—ã –µ—Å—Ç—å —Ä–∞–∑–Ω–æ–µ, –Ω–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —ç—Ç–æ 0.5. 


```python
data.describe().T # —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>2000.0</td>
      <td>552765.2135</td>
      <td>253851.326129</td>
      <td>100298.0</td>
      <td>339052.0</td>
      <td>550793.0</td>
      <td>765763.75</td>
      <td>999029.0</td>
    </tr>
    <tr>
      <th>—Å—Ç–∞–∂</th>
      <td>2000.0</td>
      <td>3.6665</td>
      <td>2.537222</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>6.00</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <td>2000.0</td>
      <td>3.5265</td>
      <td>0.996892</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.00</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <td>2000.0</td>
      <td>34066.8000</td>
      <td>15398.436729</td>
      <td>12000.0</td>
      <td>22800.0</td>
      <td>30000.0</td>
      <td>43200.00</td>
      <td>96000.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
target.describe().T # —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>2000.0</td>
      <td>552765.21350</td>
      <td>253851.326129</td>
      <td>100298.00</td>
      <td>339052.00</td>
      <td>550793.00</td>
      <td>765763.75</td>
      <td>999029.0</td>
    </tr>
    <tr>
      <th>—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ</th>
      <td>2000.0</td>
      <td>0.54878</td>
      <td>0.220110</td>
      <td>0.03</td>
      <td>0.38</td>
      <td>0.58</td>
      <td>0.72</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>



–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã–µ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

### –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤

–î–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–æ–∞—Ö.

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ –Ω–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏–∏: –±—É–¥–µ–º —Å—Ç—Ä–æ–∏—Ç—å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –∏ —è—â–∏–∫–∏ —Å —É—Å–∞–º–∏ –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.


```python
# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –¥–ª—è –≤—ã–±–æ—Ä–æ–∫
def plot_hist(df1,df2,column):
    # –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è
    plt.subplot(1, 2, 2)
    plt.hist(df1[column], bins=10, alpha=0.5, color="blue")
    plt.title("—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞")
    plt.xlabel(column)
    plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")

    # –¥–ª—è —Ç–µ—Å—Ç–æ–≤–∞—è
    plt.subplot(1, 2, 1)
    plt.hist(df2[column], bins=10, alpha=0.5, color="green")
    plt.title("–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞")
    plt.xlabel(column)
    plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")

    plt.tight_layout()
    plt.show()

# –Ø—â–∏–∫ —Å —É—Å–∞–º–∏
def plot_box(df1, df2, column):
    plt.figure(figsize=(10, 6))

    # –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
    plt.subplot(1, 2, 2)
    sns.boxplot(data=df1, y=column, color='blue')
    plt.title("–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞")
    plt.ylabel(column)

    # –¥–ª—è —Ç–µ—Å—Ç
    plt.subplot(1, 2, 1)
    sns.boxplot(data=df2, y=column, color='green')
    plt.title("–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞")
    plt.ylabel(column)

    plt.tight_layout()
    plt.show()
    
        
def plot_cat(df1,df2,column):
    
    fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(20, 5))
    
    print(column)

    dn1=df1[column].value_counts()
    axes[0].pie(dn1,labels=dn1.index,autopct='%1.1f%%')
    axes[0].set_title('–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ ', fontweight='bold')

    
    dn2=df2[column].value_counts()
    axes[1].pie(dn2,labels=dn2.index, autopct='%1.1f%%')
    axes[1].set_title('–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ ', fontweight='bold')
    
    plt.show()

    
```


```python
for i in ['—Å—Ç–∞–∂','–æ—Ü–µ–Ω–∫–∞','–∑–∞—Ä–ø–ª–∞—Ç–∞']:
    plot_hist(train,data,i)
    plot_box(train,data,i)
```


    
![png](output_65_0.png)
    



    
![png](output_65_1.png)
    



    
![png](output_65_2.png)
    



    
![png](output_65_3.png)
    



    
![png](output_65_4.png)
    



    
![png](output_65_5.png)
    



```python
plot_hist(train,target,'—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ')
plot_box(train,target,'—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ')
```


    
![png](output_66_0.png)
    



    
![png](output_66_1.png)
    


–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ—Ö–æ–∂–∏–º –æ–±—Ä–∞–∑–æ–º –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏.


```python
for i in ['–æ—Ç–¥–µ–ª','—É—Ä–æ–≤–µ–Ω—å','–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å','–ø–æ–≤—ã—à–µ–Ω–∏–µ','–Ω–∞—Ä—É—à–µ–Ω–∏–µ']:
    plot_cat(train,data,i)
```

    –æ—Ç–¥–µ–ª



    
![png](output_68_1.png)
    


    —É—Ä–æ–≤–µ–Ω—å



    
![png](output_68_3.png)
    


    –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å



    
![png](output_68_5.png)
    


    –ø–æ–≤—ã—à–µ–Ω–∏–µ



    
![png](output_68_7.png)
    


    –Ω–∞—Ä—É—à–µ–Ω–∏–µ



    
![png](output_68_9.png)
    


–†–∞–∑–ª–∏—á–∏—è –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–æ–∫–≤ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 1%. –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö –ª–∏–±–æ –º–ª–∞–¥—à–∏–µ –ª–∏–±–æ —Å—Ä–µ–¥–Ω–µ–µ.

–í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–º–µ—é –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–æ–¥–Ω–∏ –±–æ–ª—å—à–∏ –¥—Ä—É–≥–∏—Ö –º–∞–∫—Å–∏–º—É–º –≤ –¥–≤–∞ —Ä–∞–∑–∞), –∫—Ä–æ–º–µ —Å—Ç–æ–±—Ü–∞ –æ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö.–ù–∞—Ä—É–µ–Ω–∏—è —Å–æ–≤–µ—Ä—à–∏–ª–∏ –æ–∫–æ–ª–æ 13% —Ä–∞–±–æ—Ç–Ω–∏–æ–∫–≤. –ü–æ–≤—ã—à–µ–Ω–∏–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç –ª–∏—à—å —Ç–æ–ª—å–∫–æ —Ç—Ä–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞. –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–º–µ–µ—Ç —Å—Ä–µ–¥–Ω–µ—é –∑–∞—Ä—É–∂–µ–Ω–æ—Å—Ç—å.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

### –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

–ú–∞—Ç—Ä–∏—Ü–∞ Phik —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –≤ –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –º–∞—Ç—Ä–∏—Ü—É, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∞ –º–æ–∂–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –Ω–µ —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏, –Ω–æ –∏ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. –ê –Ω–∞–º —ç—Ç—É –Ω—É–∂–Ω–æ —Å —Ü–µ–ª—å—é –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö.


```python
train_copy = train.drop('id', axis=1)


# —Ä–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Phik
correlation_matrix = phik.phik_matrix(train_copy ) #interval_cols=ic

# –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
plt.figure(figsize=(20, 15))
sns.heatmap(correlation_matrix, annot=True, cmap="coolwarm")

plt.title("–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (Phik)")
plt.show();
```

    interval columns not set, guessing: ['—Å—Ç–∞–∂', '–æ—Ü–µ–Ω–∫–∞', '–∑–∞—Ä–ø–ª–∞—Ç–∞', '—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ']



    
![png](output_74_1.png)
    


–î–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—ã –æ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç–∏ –∏ —É—Ä–æ–≤–Ω—è –∑–∞–Ω–∏–º–∞–µ–º–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏, —É—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞–∂–∞, –∞ —Ç–∞–∫–∂–µ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –æ—Ç –Ω–µ—ë.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ! –ú–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é, –ø–æ–¥—Ö–æ–¥—è—â—É—é –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
</div>

–î–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã data –∏ target  —Ç–∞–±–ª–∏—Ü—É test, —á—Ç–æ–±—ã –±—ã–ª–æ –ø—Ä–æ—â–µ –ø—Ä–æ–≤—Å–µ—Ç–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–π —Ç–µ—Å—Ç.


```python
test=data.merge(target,how='outer')
```


```python
test.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 2000 entries, 0 to 1999
    Data columns (total 10 columns):
     #   Column        Non-Null Count  Dtype  
    ---  ------        --------------  -----  
     0   id            2000 non-null   int64  
     1   –æ—Ç–¥–µ–ª         1997 non-null   object 
     2   —É—Ä–æ–≤–µ–Ω—å       1999 non-null   object 
     3   –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  1999 non-null   object 
     4   —Å—Ç–∞–∂          2000 non-null   int64  
     5   –ø–æ–≤—ã—à–µ–Ω–∏–µ     2000 non-null   object 
     6   –Ω–∞—Ä—É—à–µ–Ω–∏–µ     2000 non-null   object 
     7   –æ—Ü–µ–Ω–∫–∞        2000 non-null   int64  
     8   –∑–∞—Ä–ø–ª–∞—Ç–∞      2000 non-null   int64  
     9   —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ  2000 non-null   float64
    dtypes: float64(1), int64(4), object(5)
    memory usage: 171.9+ KB



```python
test.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>485046</td>
      <td>marketing</td>
      <td>junior</td>
      <td>medium</td>
      <td>2</td>
      <td>no</td>
      <td>no</td>
      <td>5</td>
      <td>28800</td>
      <td>0.79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>686555</td>
      <td>hr</td>
      <td>junior</td>
      <td>medium</td>
      <td>1</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>30000</td>
      <td>0.72</td>
    </tr>
    <tr>
      <th>2</th>
      <td>467458</td>
      <td>sales</td>
      <td>middle</td>
      <td>low</td>
      <td>5</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>19200</td>
      <td>0.64</td>
    </tr>
  </tbody>
</table>
</div>



–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–µ–ø–µ—Ä—å –∫–æ—Ä–µ–ª—è—Ü–∏—é —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.


```python
test_copy = test.drop('id', axis=1)


# —Ä–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Phik
correlation_matrix = phik.phik_matrix(test_copy ) #interval_cols=ic

# –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
plt.figure(figsize=(20, 15))
sns.heatmap(correlation_matrix, annot=True, cmap="coolwarm")

plt.title("–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (Phik)")
plt.show();
```

    interval columns not set, guessing: ['—Å—Ç–∞–∂', '–æ—Ü–µ–Ω–∫–∞', '–∑–∞—Ä–ø–ª–∞—Ç–∞', '—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ']



    
![png](output_82_1.png)
    


–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–∞–∫–∏–µ –∂–µ –∫–∞–∫ –∏ –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –æ–±—É—á–∏–≤—à–∏—Å—å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö.


**–í—ã–≤–æ–¥** 
–¢–µ—Å—Ç–æ–≤—ã–µ –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Ö–æ–∂–∏.
–í —Å—Ä–µ–¥–Ω–µ–º 3 –≥–æ–¥—ã, –º–∞–∫—Å–∏–º—É–º 10. –õ—É—á—à–∞—è –æ—Ü–µ–Ω–∫–∞ —ç—Ç–æ 5 (–∫–∞–∫ –∏ —Å–ª–µ–¥–æ–≤–∞–ª–æ –æ–∂–∏–¥–∞—Ç—å), –≤ —Å—Ä–µ–¥–Ω–µ–º —ç—Ç–æ 3,5 ( –ø–æ –º–µ–¥–∏–∞–Ω–µ 4) –¥–∞ –∏ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –æ—Ü–µ–Ω–æ–∫ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É 3 –∏ 4. –ó–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ –æ—Ç 12 –¥–æ 98,4 —Ç—ã—Å., –∞ –≤—Å—Ä–µ–¥–Ω–µ–º —Å–æ—Å—Ç–æ–≤–ª—è–µ—Ç 30 —Ç—ã—Å. (–º–µ–¥–∏–∞–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–ª–∏–∫–æ). –ó–Ω–∞—á–µ–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç —Ä–∞–±–æ—Ç—ã –µ—Å—Ç—å —Ä–∞–∑–Ω–æ–µ, –Ω–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —ç—Ç–æ 0.5. 
–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—ã –æ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç–∏ –∏ —É—Ä–æ–≤–Ω—è –∑–∞–Ω–∏–º–∞–µ–º–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏, —É—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞–∂–∞, –∞ —Ç–∞–∫–∂–µ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –æ—Ç –Ω–µ—ë. –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö –ª–∏–±–æ –º–ª–∞–¥—à–∏–µ –ª–∏–±–æ —Å—Ä–µ–¥–Ω–µ–µ.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–∞–ª—å–Ω–µ–π—â–µ–º –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –ª—É—á—à–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–π–ø–ª–∞–Ω.

–î–ª—è –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ—á–∏—Å–ª–∏–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

- –æ—Ç–¥–µ–ª, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ ‚Äî –Ω—É–∂–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é OneHotEncoder —Ç.–∫ –∏—Ö –æ—Ç–¥–µ–ª—ã –Ω–µ–ª—å–∑—è –Ω–∏ –∫–∞–∫ —Å–æ–æ—Ç–Ω–µ—Å—Ç–∏, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∏–º–µ—é—Ç —Ç–æ–ª—å–∫–æ –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è..
- —É—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –∑–∞–Ω—è—Ç–æ—Å—Ç—å ‚Äî –Ω—É–∂–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é OrdinalEncoder, —Ç.–∫. –∏—Ö –º–æ–∂–µ–Ω–æ —Å–æ–æ—Ç–Ω–µ—Å—Ç–∏.
- —Å—Ç–∞–∂, –æ—Ü–µ–Ω–∫–∞ —Ä–∞–±–æ—Ç—ã –∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ - –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å.
- –£–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ - —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫. 

–í –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö –ø—Ä–æ–ø—É—Å–∫–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ–º –∏—Ö –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –•–æ—Ä–æ—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ, –º–æ–ª–æ–¥–µ—Ü!
</div>

–ù–æ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏


```python
# —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
train.drop(['id'],axis=1).duplicated().sum()
```




    245




```python
# —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
test.drop(['id'],axis=1).duplicated().sum()
```




    83



–°–æ–∑–¥–∞–¥–∏–º –≤—ã–±–æ—Ä–∫–∏, –¥–µ–ª–∏—Ç—å –∏—Ö –Ω–µ –Ω–∞–¥–æ.


```python
X_train=train.drop(['id','—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ'],axis=1)
y_train=train['—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ']
X_test=test.drop(['id','—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ'],axis=1)
y_test=test['—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ']

```


```python
# –ü–æ—Å–º–æ—Ç—Ä–∏–º, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –≤—Å–µ —Å–¥–µ–ª–∞–Ω–æ
X_train.sample()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2915</th>
      <td>purchasing</td>
      <td>middle</td>
      <td>high</td>
      <td>3</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>55200</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ü—Ä–∏–∑–Ω–∞–∫–∏
ohe_columns = ['–æ—Ç–¥–µ–ª', '–ø–æ–≤—ã—à–µ–Ω–∏–µ', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ'] #OneHotEncoder
ord_columns = ['—É—Ä–æ–≤–µ–Ω—å', '–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å'] #OrdinalEncoder
num_columns = ['—Å—Ç–∞–∂', '–æ—Ü–µ–Ω–∫–∞', '–∑–∞—Ä–ø–ª–∞—Ç–∞'] #StandardScaler

```


```python
# —Å–æ–∑–¥–∞–¥–∏–º –ø–∞–π–ª–∞–π–Ω
# —É–±–µ—Ä–µ–º –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –∏ –∑–∞–º–µ–Ω–∏–º –∏—Ö –Ω–∞ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã–µ
ohe_pipe = Pipeline(
    [('simpleImputer_ohe', SimpleImputer(missing_values=np.nan, strategy='most_frequent')),
     ('ohe', OneHotEncoder(drop='first', handle_unknown='ignore', sparse_output=False))
    ]
)

# –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ
ord_pipe = Pipeline(
    [('simpleImputer_before_ord', SimpleImputer(missing_values=np.nan, strategy='most_frequent')),
     ('ord',  OrdinalEncoder(
                categories=[
                    ['junior', 'middle', 'sinior'], 
                    ['low', 'medium', 'high']
                ], 
                handle_unknown='use_encoded_value', unknown_value=np.nan
            )
        ),
     ('simpleImputer_after_ord', SimpleImputer(missing_values=np.nan, strategy='most_frequent')),

    ]
)

# –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ
data_preprocessor = ColumnTransformer(
    [('ohe', ohe_pipe, ohe_columns),
     ('ord', ord_pipe, ord_columns),
     ('num', StandardScaler(), num_columns)
    ], 
    remainder='passthrough'
)

# —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
pipe_final = Pipeline([
    ('preprocessor', data_preprocessor),
    ('models', LinearRegression())
])
```

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

–î–ª—è –±–æ–ª—å—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –ª–∏–Ω–µ–π–Ω—É—é –º–æ–¥–µ–ª—å , –Ω–æ –∏ –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π.


```python
# –°–æ–∑–¥–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π
RANDOM_STATE = 100
TEST_SIZE = 0.25

param_grid = [

    {
        'models': [LinearRegression()],
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']   
    },

    {
        'models': [DecisionTreeRegressor(random_state=RANDOM_STATE)],
        'models__max_depth': range(5, 15),
        'models__max_features': range(5, 15),
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']  
    }
]
```


```python
# –°–æ–∑–¥–∞–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è SMAPE –∏ –Ω–∞ –µ—ë –æ—Å–æ–Ω–≤–µ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—É—é –º–µ—Ç—Ä–∏–∫—É
def smape(y_true, y_pred):
    return 100/len(y_true) * np.sum(2 * np.abs(y_pred - y_true) / (np.abs(y_true) + np.abs(y_pred)))

smape_scorer = make_scorer(score_func=smape, greater_is_better=False)
```

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ, –º–µ—Ç—Ä–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∞!
</div>

## –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ë–ª–∞–≥–æ–¥–∞—Ä—è –≤—ã—à–µ –æ–ø–∏—Å–∞–Ω–æ–º—É –ø–∞–π–ø–ª–∞–Ω—É –º–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –¥–≤–µ –º–æ–¥–µ–ª–∏ (–ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å–∏—é –∏ –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π) –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–æ–µ –∏–∑ –Ω–∏—Ö –ª—É—á—à–µ–µ –∏ –ø—Ä–∏ –∫–∞–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö.


```python
grid_search = GridSearchCV(
    pipe_final,
    param_grid,
    n_jobs=-1,
    cv=5,
    scoring=smape_scorer
)
grid_search.fit(X_train, y_train)
```




<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "‚ñ∏";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "‚ñæ";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;preprocessor&#x27;,
                                        ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                                                          transformers=[(&#x27;ohe&#x27;,
                                                                         Pipeline(steps=[(&#x27;simpleImputer_ohe&#x27;,
                                                                                          SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                                                         (&#x27;ohe&#x27;,
                                                                                          OneHotEncoder(drop=&#x27;first&#x27;,
                                                                                                        handle_unknown=&#x27;ignore&#x27;,
                                                                                                        sparse_output=False))]),
                                                                         [&#x27;–æ—Ç–¥–µ–ª&#x27;,
                                                                          &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;,
                                                                          &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]),
                                                                        (&#x27;ord&#x27;,
                                                                         Pipeline(steps=[(&#x27;simpleI...
             param_grid=[{&#x27;models&#x27;: [LinearRegression()],
                          &#x27;preprocessor__num&#x27;: [StandardScaler(),
                                                MinMaxScaler(),
                                                &#x27;passthrough&#x27;]},
                         {&#x27;models&#x27;: [DecisionTreeRegressor(random_state=100)],
                          &#x27;models__max_depth&#x27;: range(5, 15),
                          &#x27;models__max_features&#x27;: range(5, 15),
                          &#x27;preprocessor__num&#x27;: [StandardScaler(),
                                                MinMaxScaler(),
                                                &#x27;passthrough&#x27;]}],
             scoring=make_scorer(smape, greater_is_better=False))</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" ><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;preprocessor&#x27;,
                                        ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                                                          transformers=[(&#x27;ohe&#x27;,
                                                                         Pipeline(steps=[(&#x27;simpleImputer_ohe&#x27;,
                                                                                          SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                                                         (&#x27;ohe&#x27;,
                                                                                          OneHotEncoder(drop=&#x27;first&#x27;,
                                                                                                        handle_unknown=&#x27;ignore&#x27;,
                                                                                                        sparse_output=False))]),
                                                                         [&#x27;–æ—Ç–¥–µ–ª&#x27;,
                                                                          &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;,
                                                                          &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]),
                                                                        (&#x27;ord&#x27;,
                                                                         Pipeline(steps=[(&#x27;simpleI...
             param_grid=[{&#x27;models&#x27;: [LinearRegression()],
                          &#x27;preprocessor__num&#x27;: [StandardScaler(),
                                                MinMaxScaler(),
                                                &#x27;passthrough&#x27;]},
                         {&#x27;models&#x27;: [DecisionTreeRegressor(random_state=100)],
                          &#x27;models__max_depth&#x27;: range(5, 15),
                          &#x27;models__max_features&#x27;: range(5, 15),
                          &#x27;preprocessor__num&#x27;: [StandardScaler(),
                                                MinMaxScaler(),
                                                &#x27;passthrough&#x27;]}],
             scoring=make_scorer(smape, greater_is_better=False))</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" ><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                                   transformers=[(&#x27;ohe&#x27;,
                                                  Pipeline(steps=[(&#x27;simpleImputer_ohe&#x27;,
                                                                   SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                                  (&#x27;ohe&#x27;,
                                                                   OneHotEncoder(drop=&#x27;first&#x27;,
                                                                                 handle_unknown=&#x27;ignore&#x27;,
                                                                                 sparse_output=False))]),
                                                  [&#x27;–æ—Ç–¥–µ–ª&#x27;, &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;,
                                                   &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]),
                                                 (&#x27;ord&#x27;,
                                                  Pipeline(steps=[(&#x27;simpleImputer_before_ord&#x27;,
                                                                   SimpleImp...gy=&#x27;most_frequent&#x27;)),
                                                                  (&#x27;ord&#x27;,
                                                                   OrdinalEncoder(categories=[[&#x27;junior&#x27;,
                                                                                               &#x27;middle&#x27;,
                                                                                               &#x27;sinior&#x27;],
                                                                                              [&#x27;low&#x27;,
                                                                                               &#x27;medium&#x27;,
                                                                                               &#x27;high&#x27;]],
                                                                                  handle_unknown=&#x27;use_encoded_value&#x27;,
                                                                                  unknown_value=nan)),
                                                                  (&#x27;simpleImputer_after_ord&#x27;,
                                                                   SimpleImputer(strategy=&#x27;most_frequent&#x27;))]),
                                                  [&#x27;—É—Ä–æ–≤–µ–Ω—å&#x27;, &#x27;–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å&#x27;]),
                                                 (&#x27;num&#x27;, StandardScaler(),
                                                  [&#x27;—Å—Ç–∞–∂&#x27;, &#x27;–æ—Ü–µ–Ω–∫–∞&#x27;,
                                                   &#x27;–∑–∞—Ä–ø–ª–∞—Ç–∞&#x27;])])),
                (&#x27;models&#x27;, LinearRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                  transformers=[(&#x27;ohe&#x27;,
                                 Pipeline(steps=[(&#x27;simpleImputer_ohe&#x27;,
                                                  SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                 (&#x27;ohe&#x27;,
                                                  OneHotEncoder(drop=&#x27;first&#x27;,
                                                                handle_unknown=&#x27;ignore&#x27;,
                                                                sparse_output=False))]),
                                 [&#x27;–æ—Ç–¥–µ–ª&#x27;, &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;, &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]),
                                (&#x27;ord&#x27;,
                                 Pipeline(steps=[(&#x27;simpleImputer_before_ord&#x27;,
                                                  SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                 (&#x27;ord&#x27;,
                                                  OrdinalEncoder(categories=[[&#x27;junior&#x27;,
                                                                              &#x27;middle&#x27;,
                                                                              &#x27;sinior&#x27;],
                                                                             [&#x27;low&#x27;,
                                                                              &#x27;medium&#x27;,
                                                                              &#x27;high&#x27;]],
                                                                 handle_unknown=&#x27;use_encoded_value&#x27;,
                                                                 unknown_value=nan)),
                                                 (&#x27;simpleImputer_after_ord&#x27;,
                                                  SimpleImputer(strategy=&#x27;most_frequent&#x27;))]),
                                 [&#x27;—É—Ä–æ–≤–µ–Ω—å&#x27;, &#x27;–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å&#x27;]),
                                (&#x27;num&#x27;, StandardScaler(),
                                 [&#x27;—Å—Ç–∞–∂&#x27;, &#x27;–æ—Ü–µ–Ω–∫–∞&#x27;, &#x27;–∑–∞—Ä–ø–ª–∞—Ç–∞&#x27;])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" ><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">ohe</label><div class="sk-toggleable__content"><pre>[&#x27;–æ—Ç–¥–µ–ª&#x27;, &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;, &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" ><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" ><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(drop=&#x27;first&#x27;, handle_unknown=&#x27;ignore&#x27;, sparse_output=False)</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" ><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">ord</label><div class="sk-toggleable__content"><pre>[&#x27;—É—Ä–æ–≤–µ–Ω—å&#x27;, &#x27;–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" ><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" ><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">OrdinalEncoder</label><div class="sk-toggleable__content"><pre>OrdinalEncoder(categories=[[&#x27;junior&#x27;, &#x27;middle&#x27;, &#x27;sinior&#x27;],
                           [&#x27;low&#x27;, &#x27;medium&#x27;, &#x27;high&#x27;]],
               handle_unknown=&#x27;use_encoded_value&#x27;, unknown_value=nan)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox" ><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox" ><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>[&#x27;—Å—Ç–∞–∂&#x27;, &#x27;–æ—Ü–µ–Ω–∫–∞&#x27;, &#x27;–∑–∞—Ä–ø–ª–∞—Ç–∞&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox" ><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox" ><label for="sk-estimator-id-13" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre></pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox" ><label for="sk-estimator-id-14" class="sk-toggleable__label sk-toggleable__label-arrow">passthrough</label><div class="sk-toggleable__content"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-15" type="checkbox" ><label for="sk-estimator-id-15" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div></div></div></div></div></div>




```python
# –æ–ø—Ä–µ–¥–µ–ª–∏–º –ª—É—á—à–∏—é –º–æ–¥–µ–ª—å –∏ –µ—ë —Ä–∞—Ä–∞–º–µ—Ç—Ä—ã
best_model = grid_search.best_estimator_
print('–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\n\n', grid_search.best_estimator_)
print ('–ú–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:', round(grid_search.best_score_*(-1),4))
```

    –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
    
     Pipeline(steps=[('preprocessor',
                     ColumnTransformer(remainder='passthrough',
                                       transformers=[('ohe',
                                                      Pipeline(steps=[('simpleImputer_ohe',
                                                                       SimpleImputer(strategy='most_frequent')),
                                                                      ('ohe',
                                                                       OneHotEncoder(drop='first',
                                                                                     handle_unknown='ignore',
                                                                                     sparse_output=False))]),
                                                      ['–æ—Ç–¥–µ–ª', '–ø–æ–≤—ã—à–µ–Ω–∏–µ',
                                                       '–Ω–∞—Ä—É—à–µ–Ω–∏–µ']),
                                                     ('ord',
                                                      Pipeline(steps=[('simpleImputer_before_ord',
                                                                       SimpleImp...
                                                                       OrdinalEncoder(categories=[['junior',
                                                                                                   'middle',
                                                                                                   'sinior'],
                                                                                                  ['low',
                                                                                                   'medium',
                                                                                                   'high']],
                                                                                      handle_unknown='use_encoded_value',
                                                                                      unknown_value=nan)),
                                                                      ('simpleImputer_after_ord',
                                                                       SimpleImputer(strategy='most_frequent'))]),
                                                      ['—É—Ä–æ–≤–µ–Ω—å', '–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å']),
                                                     ('num', 'passthrough',
                                                      ['—Å—Ç–∞–∂', '–æ—Ü–µ–Ω–∫–∞',
                                                       '–∑–∞—Ä–ø–ª–∞—Ç–∞'])])),
                    ('models',
                     DecisionTreeRegressor(max_depth=14, max_features=10,
                                           random_state=100))])
    –ú–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ: 14.837


–ö–∞–∫ –≤–∏–¥–Ω–æ –º–µ—Ç—Ä–∏–∫–∞ SMAPE –ø–æ—á—Ç–∏ —Ä–∞–≤–Ω–∞ 15 –Ω–æ –º–µ–Ω—å—à–µ. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ, –Ω—É–∂–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!
</div>


```python
print(f'SMAPE-–º–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏:{round(smape(y_test, best_model.predict(X_test)),4)}')
```

    SMAPE-–º–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏:13.9711


–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª—å —Ç–æ–∂–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–∏–µ–º–ª–µ–º–æ (–¥–∞–∂–µ –Ω–µ–º–Ω–æ–≥–æ –ª—É—á—à–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö).

## –í—ã–≤–æ–¥—ã

–í —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:
* –ë—ã–ª–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
* –ë—ã–ª–∏ –Ω–∞–π–¥–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö
* –ë—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –º–µ—Ç–æ–¥ –∏—Ö –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
* –ë—ã–ª–∞ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω –ø–∞–π–ø–ª–∞–Ω –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫ –æ–±—É—á–µ–Ω–∏—é
* –ë—ã–ª–∏ –æ–±—É—á–µ–Ω—ã –¥–≤–µ –º–æ–¥–µ–ª–∏ (–¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π –∏ –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è) —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –±—ã–ª–∞ –ø–æ–ª—É—á–µ–Ω–∞ –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç —Ä–∞–±–æ—Ç—ã: DecisionTreeRegressor(max_depth=14, max_features=10,random_state=100)). –ï—ë –º–µ—Ç—Ä–∏–∫–∞ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ–≤–ª—è–µ—Ç 13.9711, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –ø—Ä–∏–µ–º–ª–µ–Ω–æ—Å—Ç–∏ –µ—ë –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –º–æ–ª–æ–¥–µ—Ü!
</div>

# –ó–∞–¥–∞—á–∞ 2

## –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ó–∞–≥—Ä—É–∑–∏–º –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ


```python
train_new = pd.read_csv('/datasets/train_quit.csv') # —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
data_new = pd.read_csv('/datasets/test_features.csv') # —Ç–µ—Å—Ç–æ–≤—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
target_new = pd.read_csv('/datasets/test_target_quit.csv') # —Ç–µ—Å—Ç–æ–≤—ã–µ —Ü–µ–ª–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```

## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö


```python
# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
train_new.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>dept</th>
      <th>level</th>
      <th>workload</th>
      <th>employment_years</th>
      <th>last_year_promo</th>
      <th>last_year_violations</th>
      <th>supervisor_evaluation</th>
      <th>salary</th>
      <th>quit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>723290</td>
      <td>sales</td>
      <td>middle</td>
      <td>high</td>
      <td>2</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>54000</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>814010</td>
      <td>sales</td>
      <td>junior</td>
      <td>medium</td>
      <td>2</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>27600</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>155091</td>
      <td>purchasing</td>
      <td>middle</td>
      <td>medium</td>
      <td>5</td>
      <td>no</td>
      <td>no</td>
      <td>1</td>
      <td>37200</td>
      <td>no</td>
    </tr>
    <tr>
      <th>3</th>
      <td>257132</td>
      <td>sales</td>
      <td>junior</td>
      <td>medium</td>
      <td>2</td>
      <td>no</td>
      <td>yes</td>
      <td>3</td>
      <td>24000</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>910140</td>
      <td>marketing</td>
      <td>junior</td>
      <td>medium</td>
      <td>2</td>
      <td>no</td>
      <td>no</td>
      <td>5</td>
      <td>25200</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∏—Ö
train_new.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 4000 entries, 0 to 3999
    Data columns (total 10 columns):
     #   Column                 Non-Null Count  Dtype 
    ---  ------                 --------------  ----- 
     0   id                     4000 non-null   int64 
     1   dept                   4000 non-null   object
     2   level                  4000 non-null   object
     3   workload               4000 non-null   object
     4   employment_years       4000 non-null   int64 
     5   last_year_promo        4000 non-null   object
     6   last_year_violations   4000 non-null   object
     7   supervisor_evaluation  4000 non-null   int64 
     8   salary                 4000 non-null   int64 
     9   quit                   4000 non-null   object
    dtypes: int64(4), object(6)
    memory usage: 312.6+ KB


–ü—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è. –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö —Ç–æ–∂–µ –ø–æ–¥—Ö–æ–¥–∏—Ç. –ù–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞–¥–æ–ª —Å–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–∏–µ.


```python
train_new.rename(columns=column_mapping, inplace=True)
train_new.rename(columns={'quit':'—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'}, inplace=True)
column_mapping
```




    {'dept': '–æ—Ç–¥–µ–ª',
     'level': '—É—Ä–æ–≤–µ–Ω—å',
     'workload': '–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å',
     'employment_years': '—Å—Ç–∞–∂',
     'last_year_promo': '–ø–æ–≤—ã—à–µ–Ω–∏–µ',
     'last_year_violations': '–Ω–∞—Ä—É—à–µ–Ω–∏–µ',
     'supervisor_evaluation': '–æ—Ü–µ–Ω–∫–∞',
     'salary': '–∑–∞—Ä–ø–ª–∞—Ç–∞'}




```python
train_new.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>723290</td>
      <td>sales</td>
      <td>middle</td>
      <td>high</td>
      <td>2</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>54000</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>814010</td>
      <td>sales</td>
      <td>junior</td>
      <td>medium</td>
      <td>2</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>27600</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏–∏
for i in ['–æ—Ç–¥–µ–ª','—É—Ä–æ–≤–µ–Ω—å','–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å','–ø–æ–≤—ã—à–µ–Ω–∏–µ','–Ω–∞—Ä—É—à–µ–Ω–∏–µ','—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ']:
    print('–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ',i,' - —ç—Ç–æ',train_new[i].unique())
```

    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –æ—Ç–¥–µ–ª  - —ç—Ç–æ ['sales' 'purchasing' 'marketing' 'technology' 'hr']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ —É—Ä–æ–≤–µ–Ω—å  - —ç—Ç–æ ['middle' 'junior' 'sinior']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  - —ç—Ç–æ ['high' 'medium' 'low']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']


–ù–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –æ—à–∏–±–æ–∫ –Ω–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è


```python
# –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã
train_new.duplicated().sum()
```




    0




```python
# –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
train_new['id'].duplicated().sum()
```




    0




```python
# –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
train_new.drop(['id','—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'],axis=1).duplicated().sum()
```




    1545




```python
print(1545/4000*100,'% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–º–µ—é—Ç —Å—Ö–æ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ')
```

    38.625 % —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–º–µ—é—Ç —Å—Ö–æ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ


<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É


```python
data_new.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2000 entries, 0 to 1999
    Data columns (total 9 columns):
     #   Column                 Non-Null Count  Dtype 
    ---  ------                 --------------  ----- 
     0   id                     2000 non-null   int64 
     1   dept                   1998 non-null   object
     2   level                  1999 non-null   object
     3   workload               2000 non-null   object
     4   employment_years       2000 non-null   int64 
     5   last_year_promo        2000 non-null   object
     6   last_year_violations   2000 non-null   object
     7   supervisor_evaluation  2000 non-null   int64 
     8   salary                 2000 non-null   int64 
    dtypes: int64(4), object(5)
    memory usage: 140.8+ KB


–í–∏–¥–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Å—Ç–æ–ª—Ü–∞—Ö –æ—Ç–¥–µ–ª –∏ —É—Ä–æ–≤–µ–Ω—å.


```python
# –ù—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
data_new.rename(columns=column_mapping, inplace=True)
```


```python
data_new.sample()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>644</th>
      <td>705199</td>
      <td>marketing</td>
      <td>middle</td>
      <td>medium</td>
      <td>3</td>
      <td>no</td>
      <td>yes</td>
      <td>1</td>
      <td>39600</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –†–∞—Å–º–æ—Ç—Ä–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
for i in ['–æ—Ç–¥–µ–ª','—É—Ä–æ–≤–µ–Ω—å','–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å','–ø–æ–≤—ã—à–µ–Ω–∏–µ','–Ω–∞—Ä—É—à–µ–Ω–∏–µ']:
    print('–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ',i,' - —ç—Ç–æ',data[i].unique())
```

    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –æ—Ç–¥–µ–ª  - —ç—Ç–æ ['marketing' 'hr' 'sales' 'purchasing' 'technology' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ —É—Ä–æ–≤–µ–Ω—å  - —ç—Ç–æ ['junior' 'middle' 'sinior' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  - —ç—Ç–æ ['medium' 'low' 'high' nan]
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']
    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–±—Ü–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ  - —ç—Ç–æ ['no' 'yes']


–ù–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –Ω–µ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.


```python
# –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã
data_new.duplicated().sum()
```




    0




```python
# –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
data_new['id'].duplicated().sum()
```




    0




```python
# –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
data_new.drop(['id'],axis=1).duplicated().sum()
```




    557




```python
print(557/2000*100,'% –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–¥–∏–Ω–∞–∫–æ–≤—ã')
```

    27.85 % –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–¥–∏–Ω–∞–∫–æ–≤—ã



```python
target_new.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2000 entries, 0 to 1999
    Data columns (total 2 columns):
     #   Column  Non-Null Count  Dtype 
    ---  ------  --------------  ----- 
     0   id      2000 non-null   int64 
     1   quit    2000 non-null   object
    dtypes: int64(1), object(1)
    memory usage: 31.4+ KB



```python
# –ó–∞–º–µ–Ω–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–µ
target_new.rename(columns={'quit': '—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'}, inplace=True)
target_new.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2000 entries, 0 to 1999
    Data columns (total 2 columns):
     #   Column      Non-Null Count  Dtype 
    ---  ------      --------------  ----- 
     0   id          2000 non-null   int64 
     1   —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ  2000 non-null   object
    dtypes: int64(1), object(1)
    memory usage: 31.4+ KB



```python
print('–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞''- —ç—Ç–æ',target_new['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'].unique())
```

    –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞- —ç—Ç–æ ['yes' 'no']



```python
# —Ç–µ–ø–µ—Ä—å –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–Ω–æ—Å—è—Ç—Å—è –ª–∏ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å —Ü–µ–ª–µ–≤—ã–º–∏ –ø–æ id
(data_new.sort_values(by='id').reset_index(drop=True)['id']==target_new.sort_values(by='id').reset_index(drop=True)['id']).sum()
```




    2000



–ö–∞–∫ –≤–∏–¥–Ω–æ –≤—Å–µ –≤–ø–æ—Ä—è–¥–∫–µ –∏ –ø–æ—ç—Ç–æ–º—É –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É


```python
test_new=data_new.merge(target_new,on='id',how='inner')
test_new.sample()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>551</th>
      <td>226834</td>
      <td>technology</td>
      <td>junior</td>
      <td>medium</td>
      <td>1</td>
      <td>no</td>
      <td>no</td>
      <td>5</td>
      <td>34800</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




```python
test_new.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 2000 entries, 0 to 1999
    Data columns (total 10 columns):
     #   Column        Non-Null Count  Dtype 
    ---  ------        --------------  ----- 
     0   id            2000 non-null   int64 
     1   –æ—Ç–¥–µ–ª         1998 non-null   object
     2   —É—Ä–æ–≤–µ–Ω—å       1999 non-null   object
     3   –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  2000 non-null   object
     4   —Å—Ç–∞–∂          2000 non-null   int64 
     5   –ø–æ–≤—ã—à–µ–Ω–∏–µ     2000 non-null   object
     6   –Ω–∞—Ä—É—à–µ–Ω–∏–µ     2000 non-null   object
     7   –æ—Ü–µ–Ω–∫–∞        2000 non-null   int64 
     8   –∑–∞—Ä–ø–ª–∞—Ç–∞      2000 non-null   int64 
     9   —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ    2000 non-null   object
    dtypes: int64(4), object(6)
    memory usage: 171.9+ KB


–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–ø–æ–∏–∑–æ—à–ª–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –æ—à–∏–±–æ–∫ –Ω–µ—Ç

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

## –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö


```python
#–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
train_new.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>4000.0</td>
      <td>552099.28375</td>
      <td>260158.031387</td>
      <td>100222.0</td>
      <td>327785.75</td>
      <td>546673.0</td>
      <td>781497.75</td>
      <td>999915.0</td>
    </tr>
    <tr>
      <th>—Å—Ç–∞–∂</th>
      <td>4000.0</td>
      <td>3.70150</td>
      <td>2.541852</td>
      <td>1.0</td>
      <td>2.00</td>
      <td>3.0</td>
      <td>6.00</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <td>4000.0</td>
      <td>3.47475</td>
      <td>1.004049</td>
      <td>1.0</td>
      <td>3.00</td>
      <td>4.0</td>
      <td>4.00</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <td>4000.0</td>
      <td>33805.80000</td>
      <td>15152.415163</td>
      <td>12000.0</td>
      <td>22800.00</td>
      <td>30000.0</td>
      <td>43200.00</td>
      <td>96000.0</td>
    </tr>
  </tbody>
</table>
</div>



–í —Å—Ä–µ–¥–Ω–µ–º —Ä–∞–±–æ—Ç–Ω–∏–∫–∏ —Å–ª—É–∂–∞—Ç 3,7 –ª–µ—Ç –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ 10. –û—Ü–µ–Ω–∫–∏ —É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–µ–∂–¥—É 3 –∏ 4. –ó–∞—Ä–ø–ª–∞—Ç–∞ –≤ —Å—Ä–µ–¥–Ω–µ–∏ 30 —Ç—ã—Å. –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ –æ—Ç 12 —Ç—ã—Å. –¥–æ 96 —Ç—ã—Å.


```python
test_new.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>2000.0</td>
      <td>552765.2135</td>
      <td>253851.326129</td>
      <td>100298.0</td>
      <td>339052.0</td>
      <td>550793.0</td>
      <td>765763.75</td>
      <td>999029.0</td>
    </tr>
    <tr>
      <th>—Å—Ç–∞–∂</th>
      <td>2000.0</td>
      <td>3.6665</td>
      <td>2.537222</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>6.00</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <td>2000.0</td>
      <td>3.5265</td>
      <td>0.996892</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.00</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <td>2000.0</td>
      <td>34066.8000</td>
      <td>15398.436729</td>
      <td>12000.0</td>
      <td>22800.0</td>
      <td>30000.0</td>
      <td>43200.00</td>
      <td>96000.0</td>
    </tr>
  </tbody>
</table>
</div>



–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ö–æ–∂–∏ –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–º–∏.

–î–ª—è –¥–∞–ª—å–Ω–µ–π—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –Ω—É–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏.


```python
# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
for i in ['—Å—Ç–∞–∂','–æ—Ü–µ–Ω–∫–∞','–∑–∞—Ä–ø–ª–∞—Ç–∞']:
    plot_hist(train_new,test_new,i)
    plot_box(train_new,test_new,i)
```


    
![png](output_157_0.png)
    



    
![png](output_157_1.png)
    



    
![png](output_157_2.png)
    



    
![png](output_157_3.png)
    



    
![png](output_157_4.png)
    



    
![png](output_157_5.png)
    


–í–∏–¥–Ω–æ, —á—Ç–æ –≤ –æ–±–æ–∏—Ö –≤—ã–±–æ–∫–∞ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –±—ã–ª–∞ –Ω–∞–Ω—è—Ç–æ –º–∞–∫—Å–∏–º—É–º 5 –ª–µ—Ç –Ω–∞–∑–∞–¥. –í–∏–¥–Ω–æ —á—Ç–æ —á–µ–º –±–æ–ª—å—à–µ –∑–∞—Ä–ø–ª–∞—Ç–∞, —Ç–µ–º –º–µ–Ω—å—à–µ —Ä–æ–±–æ—Ç–Ω–∏–∫–æ–≤ –µ—ë –ø–æ–ª—É—á–∞—é—Ç. –°–≤–µ—Ä—Ö–≤—ã—Å–æ–∫—É—é –∑–∞—Ä–ø–ª–∞—Ç—É —ç—Ç–æ –≤—ã—à–µ 70 —Ç—ã—Å.


```python
for i in ['–æ—Ç–¥–µ–ª','—É—Ä–æ–≤–µ–Ω—å','–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å','–ø–æ–≤—ã—à–µ–Ω–∏–µ','–Ω–∞—Ä—É—à–µ–Ω–∏–µ','—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ']:
    plot_cat(train_new,test_new,i)
```

    –æ—Ç–¥–µ–ª



    
![png](output_159_1.png)
    


    —É—Ä–æ–≤–µ–Ω—å



    
![png](output_159_3.png)
    


    –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å



    
![png](output_159_5.png)
    


    –ø–æ–≤—ã—à–µ–Ω–∏–µ



    
![png](output_159_7.png)
    


    –Ω–∞—Ä—É—à–µ–Ω–∏–µ



    
![png](output_159_9.png)
    


    —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ



    
![png](output_159_11.png)
    


–í–∏–¥–Ω–æ, —á—Ç–æ 28,2 % —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —É–≤–æ–ª–∏–ª–∏—Å—å. –ù–∞—Ä—É–µ–Ω–∏—è —Å–æ–≤–µ—Ä—à–∏–ª–∏ –æ–∫–æ–ª–æ 13% —Ä–∞–±–æ—Ç–Ω–∏–æ–∫–≤. –ü–æ–≤—ã—à–µ–Ω–∏–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç –ª–∏—à—å —Ç–æ–ª—å–∫–æ —Ç—Ä–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞. –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–º–µ–µ—Ç —Å—Ä–µ–¥–Ω–µ—é –∑–∞—Ä—É–∂–µ–Ω–æ—Å—Ç—å.


```python
# –ü—Ä–æ–≤–µ–¥–µ–º –∫–æ—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑, —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
train_copy = train_new.drop('id', axis=1)


# —Ä–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Phik
correlation_matrix = phik.phik_matrix(train_copy ) #interval_cols=ic

# –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
plt.figure(figsize=(20, 15))
sns.heatmap(correlation_matrix, annot=True, cmap="coolwarm")

plt.title("–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (Phik)")
plt.show();
```

    interval columns not set, guessing: ['—Å—Ç–∞–∂', '–æ—Ü–µ–Ω–∫–∞', '–∑–∞—Ä–ø–ª–∞—Ç–∞']



    
![png](output_161_1.png)
    


–í–∏–¥–Ω–æ, —á—Ç–æ –∑–∞—Ä–ø–ª–∞—Ç–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å –∏ —É—Ä–æ–≤–Ω–µ–º, –∞ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤–∏—è–µ—Ç –∏ —Å—Ç–∞–∂–± –Ω–æ –Ω–µ —Å–∏–ª—å–Ω–æ.  –í–∏–¥–Ω–æ, —á—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ –Ω–∞ —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ –≤–ª–∏—è–µ—Ç —Å—Ç–∞–∂ –∏ –∑–∞—Ä–ø–ª–∞—Ç–∞.


```python
# –ü—Ä–æ–≤–µ–¥–µ–º –∫–æ—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑, —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
test_copy = train_new.drop('id', axis=1)


# —Ä–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Phik
correlation_matrix = phik.phik_matrix(train_copy ) #interval_cols=ic

# –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
plt.figure(figsize=(20, 15))
sns.heatmap(correlation_matrix, annot=True, cmap="coolwarm")

plt.title("–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (Phik)")
plt.show();
```

    interval columns not set, guessing: ['—Å—Ç–∞–∂', '–æ—Ü–µ–Ω–∫–∞', '–∑–∞—Ä–ø–ª–∞—Ç–∞']



    
![png](output_163_1.png)
    


–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–µ–Ω—ã—Ö —Å—Ö–æ–∂–∏.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —É–≤–æ–ª—å–Ω–µ–Ω–∏–π

–ö–∞–∫ –≤–∏–¥–Ω–æ —Å—Ç–∞–∂ –∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ –æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ –≤–ª–∏—è–Ω–∏–µ. –ù–æ —Å–ª–µ–¥—É–µ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫ –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è —É —É–≤–æ–ª–∏–≤—à–∏—Ö—Å—è –∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è.


```python
# —Å–æ–∑–¥–∞–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è
train_new.query('—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ=="no"').describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>2872.0</td>
      <td>555066.499652</td>
      <td>260962.518935</td>
      <td>100469.0</td>
      <td>329560.5</td>
      <td>548319.5</td>
      <td>793533.5</td>
      <td>999915.0</td>
    </tr>
    <tr>
      <th>—Å—Ç–∞–∂</th>
      <td>2872.0</td>
      <td>4.430710</td>
      <td>2.544635</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <td>2872.0</td>
      <td>3.643106</td>
      <td>0.965295</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <td>2872.0</td>
      <td>37702.228412</td>
      <td>15218.977339</td>
      <td>12000.0</td>
      <td>25200.0</td>
      <td>34800.0</td>
      <td>46800.0</td>
      <td>96000.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Å–æ–∑–¥–∞–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è —É–≤–æ–ª–µ–Ω—ã—Ö
train_new.query('—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ=="yes"').describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>1128.0</td>
      <td>544544.457447</td>
      <td>258059.498361</td>
      <td>100222.0</td>
      <td>325073.0</td>
      <td>545003.5</td>
      <td>756296.0</td>
      <td>999158.0</td>
    </tr>
    <tr>
      <th>—Å—Ç–∞–∂</th>
      <td>1128.0</td>
      <td>1.844858</td>
      <td>1.274920</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <td>1128.0</td>
      <td>3.046099</td>
      <td>0.973291</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <td>1128.0</td>
      <td>23885.106383</td>
      <td>9351.599505</td>
      <td>12000.0</td>
      <td>16800.0</td>
      <td>22800.0</td>
      <td>27600.0</td>
      <td>79200.0</td>
    </tr>
  </tbody>
</table>
</div>



–í–∏–¥–Ω–æ, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —É–≤–æ–ª–∏–≤—à–∏–µ—Å—è —Ä–∞–±–æ—Ç–∞–ª–∏ 1-2 –≥–æ–¥–∞, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è 4 –≥–æ–¥–∞. –ó–∞—Ä–ø–ª–∞—Ç–∞ —É–≤–æ–ª–∏–≤—à–∏—Ö—Å—è —Å–æ—Å—Ç–æ–≤–ª—è–µ—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º 17-18 —Ç—ã—Å. –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è 25-47 —Ç—ã—Å. –î–∞ –∏ –æ—Ü–µ–Ω–∫–∏ —Ä–∞–±–æ—Ç—É —É —É–≤–æ–ª–∏–≤—à–∏—Ö—Å—è –Ω–µ–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ.

–ú–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å —á—Ç–æ —É–≤–æ–ª—å–Ω—è—é—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º, —Ç–µ –∫—Ç–æ –ø—Ä–æ—Ä–æ–±–æ—Ç–∞–ª –º–∞–ª–æ –∏ –º–∞–ª–æ —á–µ–≥–æ –¥–æ—Å—Ç–∏–≥.


```python
# —Å–æ–∑–¥–∞–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è
test_new.query('—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ=="no"').describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>1436.0</td>
      <td>548680.699164</td>
      <td>254730.637881</td>
      <td>100298.0</td>
      <td>327477.75</td>
      <td>546372.0</td>
      <td>761578.5</td>
      <td>998900.0</td>
    </tr>
    <tr>
      <th>—Å—Ç–∞–∂</th>
      <td>1436.0</td>
      <td>4.330780</td>
      <td>2.540800</td>
      <td>1.0</td>
      <td>2.00</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <td>1436.0</td>
      <td>3.716574</td>
      <td>0.958965</td>
      <td>1.0</td>
      <td>3.00</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <td>1436.0</td>
      <td>37645.403900</td>
      <td>15503.475156</td>
      <td>12000.0</td>
      <td>25200.00</td>
      <td>33600.0</td>
      <td>48000.0</td>
      <td>96000.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Å–æ–∑–¥–∞–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è —É–≤–æ–ª–µ–Ω—ã—Ö
test_new.query('—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ=="yes"').describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>564.0</td>
      <td>563164.792553</td>
      <td>251523.775926</td>
      <td>103221.0</td>
      <td>358969.5</td>
      <td>554657.0</td>
      <td>781640.25</td>
      <td>999029.0</td>
    </tr>
    <tr>
      <th>—Å—Ç–∞–∂</th>
      <td>564.0</td>
      <td>1.975177</td>
      <td>1.552888</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.00</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <td>564.0</td>
      <td>3.042553</td>
      <td>0.926211</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>4.00</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <td>564.0</td>
      <td>24955.319149</td>
      <td>10650.300744</td>
      <td>12000.0</td>
      <td>18000.0</td>
      <td>22800.0</td>
      <td>30000.00</td>
      <td>80400.0</td>
    </tr>
  </tbody>
</table>
</div>



–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ —Å–æ–≤–ø–∞–¥–≤–∞–µ—Ç

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

### –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤

–î–ª—è –±–æ–ª—å—à–µ–π –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã –≥—Ä–∞—Ñ–∏–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–µ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–¥–∂—É —É–≤–æ–ª–∏–≤—à–∏–º–∏—Å—è –∏ –æ—Å—Ç–∞–≤—à–∏–º–∏—Å—è.


```python
def plot_num(df,column):
    
    plt.title(column)
    df1=df.loc[df['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ']=='no']
    df2=df.loc[df['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ']=='yes']
    # —É–≤–æ–ª–µ–Ω–Ω—ã–µ
    plt.subplot(1, 1, 1)
    plt.hist(df2[column], bins=10, alpha=0.5, color="blue")
    #plt.title("—É–≤–æ–ª–µ–Ω—ã–µ")
    plt.xlabel(column)
    plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")

    # –æ—Å—Ç–∞–≤—à–∏–µ—Å—è
    plt.subplot(1, 1, 1)
    plt.hist(df1[column], bins=10, alpha=0.5, color="green")
    #plt.title("–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞")
    plt.xlabel(column)
    plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
    plt.legend(['—É–≤–æ–ª–µ–Ω–Ω—ã–µ','–æ—Å—Ç–∞–≤—à–∏–µ—Å—è'])
    plt.tight_layout()
    plt.show()
    
def p_cat(df,column):
    
    plt.title(column)
    df1=df.loc[df['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ']=='no',column].value_counts()
    df2=df.loc[df['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ']=='yes',column].value_counts()
    # —É–≤–æ–ª–µ–Ω–Ω—ã–µ
    plt.subplot(1, 2, 2)
    plt.pie(df2,labels=df2.index,autopct='%1.1f%%')
    plt.title("—É–≤–æ–ª–µ–Ω—ã–µ")
    plt.xlabel(column)
    #plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")

    # –æ—Å—Ç–∞–≤—à–∏–µ—Å—è
    plt.subplot(1, 2, 1)
    plt.pie(df1,labels=df1.index,autopct='%1.1f%%')
    plt.title("–æ—Å—Ç–∞–≤—à–∏–µ—Å—è")
    plt.xlabel(column)
    #plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
    #plt.legend(['—É–≤–æ–ª–µ–Ω–Ω—ã–µ','–æ—Å—Ç–∞–≤—à–∏–µ—Å—è'])
    plt.tight_layout()
    plt.show()    
```

–°–æ–∑–¥–∞–¥–∏–º –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤


```python
# —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
for i in ['—Å—Ç–∞–∂','–æ—Ü–µ–Ω–∫–∞','–∑–∞—Ä–ø–ª–∞—Ç–∞']:
    plot_num(train_new,i)

```


    
![png](output_180_0.png)
    



    
![png](output_180_1.png)
    



    
![png](output_180_2.png)
    


–í–∏–¥–Ω–æ, —á—Ç–æ —É –≤–æ–ª–∏–≤—à–∏—Ö—Å—è –Ω–∏–∑–∫–∏–π —Å—Ç–∞–¥ –¥–æ 4 –ª–µ—Ç –∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ –¥–æ 40 —Ç—ã—Å.. –¢–∞–∫–∂–µ —É —É–≤–æ–ª–∏–≤—â–∏—Ö—Å—è —Ä–µ–¥–∫–∏ –æ—Ü–µ–Ω–∫–∏ –≤—ã—à–µ 3.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>


```python
train_new.sample()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1238</th>
      <td>369771</td>
      <td>purchasing</td>
      <td>junior</td>
      <td>medium</td>
      <td>1</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>22800</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




```python
for i in ['–æ—Ç–¥–µ–ª','—É—Ä–æ–≤–µ–Ω—å','–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å','–ø–æ–≤—ã—à–µ–Ω–∏–µ','–Ω–∞—Ä—É—à–µ–Ω–∏–µ']:
    p_cat(train_new,i)
```


    
![png](output_184_0.png)
    



    
![png](output_184_1.png)
    



    
![png](output_184_2.png)
    



    
![png](output_184_3.png)
    



    
![png](output_184_4.png)
    


–í–∏–¥–Ω–æ, —á—Ç–æ —É–≤–æ–ª—å–Ω–µ–Ω–∏—è –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –æ—Ç–¥–µ–ª–∞. –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —É–≤–æ–ª–∏–≤—à–∏—Ö—Å—è - —ç—Ç–æ —É—Ä–æ–≤–µ–Ω—å –º–ª–∞–¥—à–∏–π —Å –Ω–∏–∑–∫–æ–π –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å—é.  –¢–∞–∫–∂–µ –æ–Ω–∏ –ø–æ–ª—É—á–∞—é—Ç –∫—É–¥–∞ –º–µ–Ω—å—à–µ –ø–æ–≤—ã—à–µ–Ω–∏–π –∏ –∏–º–µ—é—Ç –±–æ–ª—å—à–µ –Ω–∞—Ä—É—à–µ–Ω–∏–π.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>


```python
# —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
for i in ['—Å—Ç–∞–∂','–æ—Ü–µ–Ω–∫–∞','–∑–∞—Ä–ø–ª–∞—Ç–∞']:
    plot_num(test_new,i)
```


    
![png](output_187_0.png)
    



    
![png](output_187_1.png)
    



    
![png](output_187_2.png)
    



```python
for i in ['–æ—Ç–¥–µ–ª','—É—Ä–æ–≤–µ–Ω—å','–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å','–ø–æ–≤—ã—à–µ–Ω–∏–µ','–Ω–∞—Ä—É—à–µ–Ω–∏–µ']:
    p_cat(test_new,i)
```


    
![png](output_188_0.png)
    



    
![png](output_188_1.png)
    



    
![png](output_188_2.png)
    



    
![png](output_188_3.png)
    



    
![png](output_188_4.png)
    


–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ –ø–æ—Ö–æ–∂–∏.

**–í—ã–≤–æ–¥** : –ü–æ—Ä—Ç—Ä–µ—Ç —É–≤–æ–ª–∏–≤—à–µ–≥–æ—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º: —Ä–∞–±–æ—Ç–∞–ª –Ω–µ –±–æ–ª–µ–µ 4 –ª–µ—Ç, –∏–º–µ–µ—Ç –∑–∞—Ä–ø–ª–∞—Ç—É –Ω–µ –±–æ–ª–µ–µ 40 —Ç—ã—Å., –∏–º–µ–µ—Ç –º–ª–∞–¥—â–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–µ –ø–æ–ª—É—á–∞–ª –ø–æ–≤—ã—à–µ–Ω–∏–π. –≠—Ç–æ –≤—Å–µ –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç –∏—Å–∫–∞—Ç—å –¥—Ä—É–≥–∏—É—é —Ä–∞–±–æ—Ç—É.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞

–ù–æ –µ—Å—Ç—å –∏ –µ—â–µ –æ–¥–∏–Ω –ø—Ä–∏–∑–Ω–∞–∫ - —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç —Ä–∞–±–æ—Ç—ã.

–ë—ã–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –º–æ–¥–µ–ª—å –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –Ω–∞–π—Ç–∏ —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ –æ—Ç —Ä–∞–±–æ—Ç—ã.
–ß—Ç–æ–±—ã –Ω–µ —É—Å–ª–æ–∂–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–∏—é –º–æ–¥–µ–ª—å –¥–æ–±–∞–≤–∏–º –Ω–∞–π–¥–µ–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏—è –≤ —Ç–∞–±–ª–∏—Ü—ã.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ! –¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –≤—Å–µ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
</div>


```python
train_new['—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ'] = best_model.predict(train_new)# —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ
test_new['—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ'] = best_model.predict(test_new)# —Ç–µ—Å—Ç–æ–≤—ã–µ
```

    /opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py:228: UserWarning: Found unknown categories in columns [0] during transform. These unknown categories will be encoded as all zeros
      warnings.warn(


–ü–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∏–ª–∏—Å—å.


```python
train_new.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 4000 entries, 0 to 3999
    Data columns (total 11 columns):
     #   Column        Non-Null Count  Dtype  
    ---  ------        --------------  -----  
     0   id            4000 non-null   int64  
     1   –æ—Ç–¥–µ–ª         4000 non-null   object 
     2   —É—Ä–æ–≤–µ–Ω—å       4000 non-null   object 
     3   –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  4000 non-null   object 
     4   —Å—Ç–∞–∂          4000 non-null   int64  
     5   –ø–æ–≤—ã—à–µ–Ω–∏–µ     4000 non-null   object 
     6   –Ω–∞—Ä—É—à–µ–Ω–∏–µ     4000 non-null   object 
     7   –æ—Ü–µ–Ω–∫–∞        4000 non-null   int64  
     8   –∑–∞—Ä–ø–ª–∞—Ç–∞      4000 non-null   int64  
     9   —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ    4000 non-null   object 
     10  —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ  4000 non-null   float64
    dtypes: float64(1), int64(4), object(6)
    memory usage: 343.9+ KB



```python
test_new.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 2000 entries, 0 to 1999
    Data columns (total 11 columns):
     #   Column        Non-Null Count  Dtype  
    ---  ------        --------------  -----  
     0   id            2000 non-null   int64  
     1   –æ—Ç–¥–µ–ª         1998 non-null   object 
     2   —É—Ä–æ–≤–µ–Ω—å       1999 non-null   object 
     3   –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å  2000 non-null   object 
     4   —Å—Ç–∞–∂          2000 non-null   int64  
     5   –ø–æ–≤—ã—à–µ–Ω–∏–µ     2000 non-null   object 
     6   –Ω–∞—Ä—É—à–µ–Ω–∏–µ     2000 non-null   object 
     7   –æ—Ü–µ–Ω–∫–∞        2000 non-null   int64  
     8   –∑–∞—Ä–ø–ª–∞—Ç–∞      2000 non-null   int64  
     9   —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ    2000 non-null   object 
     10  —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ  2000 non-null   float64
    dtypes: float64(1), int64(4), object(6)
    memory usage: 187.5+ KB


–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ –∑–∞–≤–∏—Å—è—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏—è –æ—Ç —Ä–∞–±–æ—Ç—ã —É —É–≤–æ–ª–µ–Ω—ã—Ö –∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è


```python
plot_num(train_new,'—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ')
```


    
![png](output_201_0.png)
    


–í–∏–¥–Ω–æ, —á—Ç–æ –≤ —Ü–µ–ª–æ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∫—É–¥–∞ –±–æ–ª–µ–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω—ã –æ—Ç —Ä–∞–±–æ—Ç—ã, —á–µ–º —É–≤–æ–ª–∏–≤—à–∏–µ—Å—è

–¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –∑–∞–º–µ–Ω–∏—Ç—å —É–≤–æ–ª—å–Ω–µ–Ω–∏–µ —Å –¥–∞ –∏ –Ω–µ—Ç –Ω–∞ —á–∏—Å–ª–æ 1 –∏ 0 —Å–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ—é


```python
train_new['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'] = train_new['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'].apply(lambda x: 1 if x =='yes' else 0)
test_new['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'] = test_new['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'].apply(lambda x: 1 if x =='yes' else 0)
```

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø–∞–π–ø–ª–∞–π–Ω.

–î–ª—è –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ—á–∏—Å–ª–∏–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

- –æ—Ç–¥–µ–ª, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ ‚Äî –Ω—É–∂–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é OneHotEncoder —Ç.–∫ –∏—Ö –æ—Ç–¥–µ–ª—ã –Ω–µ–ª—å–∑—è –Ω–∏ –∫–∞–∫ —Å–æ–æ—Ç–Ω–µ—Å—Ç–∏, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∏–º–µ—é—Ç —Ç–æ–ª—å–∫–æ –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è..
- —É—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –∑–∞–Ω—è—Ç–æ—Å—Ç—å ‚Äî –Ω—É–∂–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é OrdinalEncoder, —Ç.–∫. –∏—Ö –º–æ–∂–µ–Ω–æ —Å–æ–æ—Ç–Ω–µ—Å—Ç–∏.
- —Å—Ç–∞–∂, –æ—Ü–µ–Ω–∫–∞ —Ä–∞–±–æ—Ç—ã, —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ –∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ - –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å.
- –£–≤–æ–ª—å–Ω–µ–Ω–∏–µ - —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫. 

–í –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö –ø—Ä–æ–ø—É—Å–∫–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ–º –∏—Ö –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ.


```python
train_new.sample()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ</th>
      <th>—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>353</th>
      <td>625643</td>
      <td>technology</td>
      <td>junior</td>
      <td>medium</td>
      <td>5</td>
      <td>no</td>
      <td>no</td>
      <td>3</td>
      <td>31200</td>
      <td>0</td>
      <td>0.28</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Ä–∞–∑–¥–µ–ª–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞ –≤—Ö–æ–¥–Ω—ã–µ –∏ —Ü–µ–ª–µ–≤—ã–µ
X_train=train_new.drop(['id','—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'],axis=1)
y_train=train_new['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ']
X_test=test_new.drop(['id','—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ'],axis=1)
y_test=test_new['—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ']
```


```python
X_test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–æ—Ç–¥–µ–ª</th>
      <th>—É—Ä–æ–≤–µ–Ω—å</th>
      <th>–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å</th>
      <th>—Å—Ç–∞–∂</th>
      <th>–ø–æ–≤—ã—à–µ–Ω–∏–µ</th>
      <th>–Ω–∞—Ä—É—à–µ–Ω–∏–µ</th>
      <th>–æ—Ü–µ–Ω–∫–∞</th>
      <th>–∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>marketing</td>
      <td>junior</td>
      <td>medium</td>
      <td>2</td>
      <td>no</td>
      <td>no</td>
      <td>5</td>
      <td>28800</td>
      <td>0.866667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hr</td>
      <td>junior</td>
      <td>medium</td>
      <td>1</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>30000</td>
      <td>0.676667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>sales</td>
      <td>middle</td>
      <td>low</td>
      <td>5</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>19200</td>
      <td>0.657143</td>
    </tr>
    <tr>
      <th>3</th>
      <td>sales</td>
      <td>middle</td>
      <td>low</td>
      <td>6</td>
      <td>no</td>
      <td>no</td>
      <td>4</td>
      <td>19200</td>
      <td>0.655000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>hr</td>
      <td>middle</td>
      <td>medium</td>
      <td>5</td>
      <td>no</td>
      <td>no</td>
      <td>5</td>
      <td>40800</td>
      <td>0.792000</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ü—Ä–∏–∑–Ω–∞–∫–∏
ohe_columns = ['–æ—Ç–¥–µ–ª', '–ø–æ–≤—ã—à–µ–Ω–∏–µ', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ'] #OneHotEncoder
ord_columns = ['—É—Ä–æ–≤–µ–Ω—å', '–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å'] #OrdinalEncoder
num_columns = ['—Å—Ç–∞–∂', '–æ—Ü–µ–Ω–∫–∞', '–∑–∞—Ä–ø–ª–∞—Ç–∞','—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ'] #StandardScaler
```


```python
# —Å–æ–∑–¥–∞–¥–∏–º –ø–∞–π–ª–∞–π–Ω
# —É–±–µ—Ä–µ–º –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –∏ –∑–∞–º–µ–Ω–∏–º –∏—Ö –Ω–∞ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã–µ
ohe_pipe = Pipeline(
    [('simpleImputer_ohe', SimpleImputer(missing_values=np.nan, strategy='most_frequent')),
     ('ohe', OneHotEncoder(drop='first', handle_unknown='ignore', sparse_output=False))
    ]
)

# –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ
ord_pipe = Pipeline(
    [('simpleImputer_before_ord', SimpleImputer(missing_values=np.nan, strategy='most_frequent')),
     ('ord',  OrdinalEncoder(
                categories=[
                    ['junior', 'middle', 'sinior'], 
                    ['low', 'medium', 'high']
                ], 
                handle_unknown='use_encoded_value', unknown_value=np.nan
            )
        ),
     ('simpleImputer_after_ord', SimpleImputer(missing_values=np.nan, strategy='most_frequent')),

    ]
)

# –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ
data_preprocessor = ColumnTransformer(
    [('ohe', ohe_pipe, ohe_columns),
     ('ord', ord_pipe, ord_columns),
     ('num', StandardScaler(), num_columns)
    ], 
    remainder='passthrough'
)

# —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
pipe_final = Pipeline([
    ('preprocessor', data_preprocessor),
    ('models', LinearRegression())
])
```

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

–ë—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π: –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π, –º–µ—Ç–æ–¥ –±–ª–∏–∂–Ω–∏—Ö —Å–æ—Å–µ–¥–µ–π –∏ –º–µ—Ç–æ–¥ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞. –ë—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω –ª—É—á—à–∏–π –∏–∑ –Ω–∏—Ö.


```python
RANDOM_STATE = 100
TEST_SIZE = 0.25
# –°–æ–∑–¥–∞–µ–º –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –º–æ–¥–µ–ª–µ–π
param_grid = [

    {
        'models': [RandomForestClassifier()],
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']   
    },

    {
        'models': [DecisionTreeClassifier(random_state=RANDOM_STATE)],
        'models__max_depth': range(5, 15),
        'models__max_features': range(5, 15),
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']  
    },
    {
        'models': [KNeighborsClassifier()],
        'models__n_neighbors': range(10, 20),
        'preprocessor__num': [StandardScaler(), MinMaxScaler(), 'passthrough']   
    }
]
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –±—ã–ª–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–æ—Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ–∑–¥–∞–Ω–∏—é –º–æ–¥–µ–ª–∏.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –í—Å–µ –≤–µ—Ä–Ω–æ!
</div>

## –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —É–≤–æ–ª—å–Ω–µ–Ω–∏–π

–ë–ª–∞–≥–æ–¥–∞—Ä—è –≤—ã—à–µ–æ–ø–∏—Å–∞–Ω–æ–º—É –ø–∞–π–ø–ª–∞–π–Ω—É –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –ª—É—á—à–∏—é —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å. –í –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å ROC-AUC. 


```python
grid_search = GridSearchCV(
    pipe_final,
    param_grid,
    n_jobs=-1,
    cv=5,
    scoring='roc_auc'
)
grid_search.fit(X_train, y_train)
```




<style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "‚ñ∏";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "‚ñæ";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;preprocessor&#x27;,
                                        ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                                                          transformers=[(&#x27;ohe&#x27;,
                                                                         Pipeline(steps=[(&#x27;simpleImputer_ohe&#x27;,
                                                                                          SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                                                         (&#x27;ohe&#x27;,
                                                                                          OneHotEncoder(drop=&#x27;first&#x27;,
                                                                                                        handle_unknown=&#x27;ignore&#x27;,
                                                                                                        sparse_output=False))]),
                                                                         [&#x27;–æ—Ç–¥–µ–ª&#x27;,
                                                                          &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;,
                                                                          &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]),
                                                                        (&#x27;ord&#x27;,
                                                                         Pipeline(steps=[(&#x27;simpleI...
                                                &#x27;passthrough&#x27;]},
                         {&#x27;models&#x27;: [DecisionTreeClassifier(random_state=100)],
                          &#x27;models__max_depth&#x27;: range(5, 15),
                          &#x27;models__max_features&#x27;: range(5, 15),
                          &#x27;preprocessor__num&#x27;: [StandardScaler(),
                                                MinMaxScaler(),
                                                &#x27;passthrough&#x27;]},
                         {&#x27;models&#x27;: [KNeighborsClassifier()],
                          &#x27;models__n_neighbors&#x27;: range(10, 20),
                          &#x27;preprocessor__num&#x27;: [StandardScaler(),
                                                MinMaxScaler(),
                                                &#x27;passthrough&#x27;]}],
             scoring=&#x27;roc_auc&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-16" type="checkbox" ><label for="sk-estimator-id-16" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5,
             estimator=Pipeline(steps=[(&#x27;preprocessor&#x27;,
                                        ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                                                          transformers=[(&#x27;ohe&#x27;,
                                                                         Pipeline(steps=[(&#x27;simpleImputer_ohe&#x27;,
                                                                                          SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                                                         (&#x27;ohe&#x27;,
                                                                                          OneHotEncoder(drop=&#x27;first&#x27;,
                                                                                                        handle_unknown=&#x27;ignore&#x27;,
                                                                                                        sparse_output=False))]),
                                                                         [&#x27;–æ—Ç–¥–µ–ª&#x27;,
                                                                          &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;,
                                                                          &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]),
                                                                        (&#x27;ord&#x27;,
                                                                         Pipeline(steps=[(&#x27;simpleI...
                                                &#x27;passthrough&#x27;]},
                         {&#x27;models&#x27;: [DecisionTreeClassifier(random_state=100)],
                          &#x27;models__max_depth&#x27;: range(5, 15),
                          &#x27;models__max_features&#x27;: range(5, 15),
                          &#x27;preprocessor__num&#x27;: [StandardScaler(),
                                                MinMaxScaler(),
                                                &#x27;passthrough&#x27;]},
                         {&#x27;models&#x27;: [KNeighborsClassifier()],
                          &#x27;models__n_neighbors&#x27;: range(10, 20),
                          &#x27;preprocessor__num&#x27;: [StandardScaler(),
                                                MinMaxScaler(),
                                                &#x27;passthrough&#x27;]}],
             scoring=&#x27;roc_auc&#x27;)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-17" type="checkbox" ><label for="sk-estimator-id-17" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                                   transformers=[(&#x27;ohe&#x27;,
                                                  Pipeline(steps=[(&#x27;simpleImputer_ohe&#x27;,
                                                                   SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                                  (&#x27;ohe&#x27;,
                                                                   OneHotEncoder(drop=&#x27;first&#x27;,
                                                                                 handle_unknown=&#x27;ignore&#x27;,
                                                                                 sparse_output=False))]),
                                                  [&#x27;–æ—Ç–¥–µ–ª&#x27;, &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;,
                                                   &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]),
                                                 (&#x27;ord&#x27;,
                                                  Pipeline(steps=[(&#x27;simpleImputer_before_ord&#x27;,
                                                                   SimpleImp...nt&#x27;)),
                                                                  (&#x27;ord&#x27;,
                                                                   OrdinalEncoder(categories=[[&#x27;junior&#x27;,
                                                                                               &#x27;middle&#x27;,
                                                                                               &#x27;sinior&#x27;],
                                                                                              [&#x27;low&#x27;,
                                                                                               &#x27;medium&#x27;,
                                                                                               &#x27;high&#x27;]],
                                                                                  handle_unknown=&#x27;use_encoded_value&#x27;,
                                                                                  unknown_value=nan)),
                                                                  (&#x27;simpleImputer_after_ord&#x27;,
                                                                   SimpleImputer(strategy=&#x27;most_frequent&#x27;))]),
                                                  [&#x27;—É—Ä–æ–≤–µ–Ω—å&#x27;, &#x27;–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å&#x27;]),
                                                 (&#x27;num&#x27;, StandardScaler(),
                                                  [&#x27;—Å—Ç–∞–∂&#x27;, &#x27;–æ—Ü–µ–Ω–∫–∞&#x27;, &#x27;–∑–∞—Ä–ø–ª–∞—Ç–∞&#x27;,
                                                   &#x27;—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ&#x27;])])),
                (&#x27;models&#x27;, LinearRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox" ><label for="sk-estimator-id-18" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                  transformers=[(&#x27;ohe&#x27;,
                                 Pipeline(steps=[(&#x27;simpleImputer_ohe&#x27;,
                                                  SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                 (&#x27;ohe&#x27;,
                                                  OneHotEncoder(drop=&#x27;first&#x27;,
                                                                handle_unknown=&#x27;ignore&#x27;,
                                                                sparse_output=False))]),
                                 [&#x27;–æ—Ç–¥–µ–ª&#x27;, &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;, &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]),
                                (&#x27;ord&#x27;,
                                 Pipeline(steps=[(&#x27;simpleImputer_before_ord&#x27;,
                                                  SimpleImputer(strategy=&#x27;most_frequent&#x27;)),
                                                 (&#x27;ord&#x27;,
                                                  OrdinalEncoder(categories=[[&#x27;junior&#x27;,
                                                                              &#x27;middle&#x27;,
                                                                              &#x27;sinior&#x27;],
                                                                             [&#x27;low&#x27;,
                                                                              &#x27;medium&#x27;,
                                                                              &#x27;high&#x27;]],
                                                                 handle_unknown=&#x27;use_encoded_value&#x27;,
                                                                 unknown_value=nan)),
                                                 (&#x27;simpleImputer_after_ord&#x27;,
                                                  SimpleImputer(strategy=&#x27;most_frequent&#x27;))]),
                                 [&#x27;—É—Ä–æ–≤–µ–Ω—å&#x27;, &#x27;–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å&#x27;]),
                                (&#x27;num&#x27;, StandardScaler(),
                                 [&#x27;—Å—Ç–∞–∂&#x27;, &#x27;–æ—Ü–µ–Ω–∫–∞&#x27;, &#x27;–∑–∞—Ä–ø–ª–∞—Ç–∞&#x27;,
                                  &#x27;—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ&#x27;])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox" ><label for="sk-estimator-id-19" class="sk-toggleable__label sk-toggleable__label-arrow">ohe</label><div class="sk-toggleable__content"><pre>[&#x27;–æ—Ç–¥–µ–ª&#x27;, &#x27;–ø–æ–≤—ã—à–µ–Ω–∏–µ&#x27;, &#x27;–Ω–∞—Ä—É—à–µ–Ω–∏–µ&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox" ><label for="sk-estimator-id-20" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-21" type="checkbox" ><label for="sk-estimator-id-21" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(drop=&#x27;first&#x27;, handle_unknown=&#x27;ignore&#x27;, sparse_output=False)</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox" ><label for="sk-estimator-id-22" class="sk-toggleable__label sk-toggleable__label-arrow">ord</label><div class="sk-toggleable__content"><pre>[&#x27;—É—Ä–æ–≤–µ–Ω—å&#x27;, &#x27;–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox" ><label for="sk-estimator-id-23" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox" ><label for="sk-estimator-id-24" class="sk-toggleable__label sk-toggleable__label-arrow">OrdinalEncoder</label><div class="sk-toggleable__content"><pre>OrdinalEncoder(categories=[[&#x27;junior&#x27;, &#x27;middle&#x27;, &#x27;sinior&#x27;],
                           [&#x27;low&#x27;, &#x27;medium&#x27;, &#x27;high&#x27;]],
               handle_unknown=&#x27;use_encoded_value&#x27;, unknown_value=nan)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-25" type="checkbox" ><label for="sk-estimator-id-25" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-26" type="checkbox" ><label for="sk-estimator-id-26" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>[&#x27;—Å—Ç–∞–∂&#x27;, &#x27;–æ—Ü–µ–Ω–∫–∞&#x27;, &#x27;–∑–∞—Ä–ø–ª–∞—Ç–∞&#x27;, &#x27;—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-27" type="checkbox" ><label for="sk-estimator-id-27" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox" ><label for="sk-estimator-id-28" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre></pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox" ><label for="sk-estimator-id-29" class="sk-toggleable__label sk-toggleable__label-arrow">passthrough</label><div class="sk-toggleable__content"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox" ><label for="sk-estimator-id-30" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div></div></div></div></div></div>




```python
best_model = grid_search.best_estimator_
print('–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\n\n', grid_search.best_estimator_)
print(f'–ú–µ—Ç—Ä–∏–∫–∞ ROC-AUC –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö: {round(grid_search.best_score_,4)}')
```

    –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
    
     Pipeline(steps=[('preprocessor',
                     ColumnTransformer(remainder='passthrough',
                                       transformers=[('ohe',
                                                      Pipeline(steps=[('simpleImputer_ohe',
                                                                       SimpleImputer(strategy='most_frequent')),
                                                                      ('ohe',
                                                                       OneHotEncoder(drop='first',
                                                                                     handle_unknown='ignore',
                                                                                     sparse_output=False))]),
                                                      ['–æ—Ç–¥–µ–ª', '–ø–æ–≤—ã—à–µ–Ω–∏–µ',
                                                       '–Ω–∞—Ä—É—à–µ–Ω–∏–µ']),
                                                     ('ord',
                                                      Pipeline(steps=[('simpleImputer_before_ord',
                                                                       SimpleImp...)),
                                                                      ('ord',
                                                                       OrdinalEncoder(categories=[['junior',
                                                                                                   'middle',
                                                                                                   'sinior'],
                                                                                                  ['low',
                                                                                                   'medium',
                                                                                                   'high']],
                                                                                      handle_unknown='use_encoded_value',
                                                                                      unknown_value=nan)),
                                                                      ('simpleImputer_after_ord',
                                                                       SimpleImputer(strategy='most_frequent'))]),
                                                      ['—É—Ä–æ–≤–µ–Ω—å', '–∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç—å']),
                                                     ('num', 'passthrough',
                                                      ['—Å—Ç–∞–∂', '–æ—Ü–µ–Ω–∫–∞', '–∑–∞—Ä–ø–ª–∞—Ç–∞',
                                                       '—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ'])])),
                    ('models', RandomForestClassifier())])
    –ú–µ—Ç—Ä–∏–∫–∞ ROC-AUC –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö: 0.9315



```python
print(f'–ú–µ—Ç—Ä–∏–∫–∞ ROC-AUC –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: {round(roc_auc_score(y_test, grid_search.predict_proba(X_test)[:, 1]),4)}')
```

    –ú–µ—Ç—Ä–∏–∫–∞ ROC-AUC –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.9243


    /opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py:228: UserWarning: Found unknown categories in columns [0] during transform. These unknown categories will be encoded as all zeros
      warnings.warn(


**–í—ã–≤–æ–¥—ã** –õ—É—á—à–µ–π –º–æ–¥–µ–ª—å—é –æ–∫–∞–∑–∞–ª–∞—Å—å RandomForestClassifier(). –ù–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã–µ –µ—ë –º–µ—Ç—Ä–∏–∫–∞ 0.9327, –∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö 0.9252. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –º–æ–¥–µ–ª—å –≤–ø–æ–ª–Ω–µ —É—Å–ø–µ—à–Ω–∞. –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —É–≤–æ–ª—å–Ω–µ–Ω–∏—è –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ —Å–ª–æ–∂–Ω–∞.

<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –º–æ–ª–æ–¥–µ—Ü!
</div>

# –í—ã–≤–æ–¥

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ—à–∞–ª–∞—Å—å —Ü–µ–ª—å—é —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å—Å–∞. –î–ª—è —ç—Ç–æ–≥–æ –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö, –∞ —Ç–∞–∫–∂–µ –∏—Ö –º–Ω–µ–Ω–∏—è –æ —Ä–∞–±–æ—Ç–µ. –î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–µ–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç —Ä–∞–±–æ—Ç—ã. –ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–π –º–æ–¥–µ–ª–∏ –Ω—É–∂–Ω–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–∫–∂–µ –º–æ–¥–µ–ª—å –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∂–∏—Ç –æ—Ç—Ç–æ–∫ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤.
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Ä–∞–±–æ—Ç—É –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤:
- –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫ –∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–µ–π.
- –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–∑–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
- —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â–µ–π —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç —Ä–∞–±–æ—Ç—ã.
- –∞–Ω–∞–ª–∏–∑ —É–≤–æ–ª—å–Ω–µ–Ω–∏–π –∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ä–µ—Ç–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ —É–≤–æ–ª–∏–≤—à–µ–≥–æ—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.
- –∞–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç —Ä–∞–±–æ—Ç—ã –Ω–∞ —É–≤–æ–ª—å–Ω–µ–Ω–∏—è.
- —Å–æ—Å—Ç–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —É–≤–æ–ª—å–Ω–µ–Ω–∏–π.
- –ø—Ä–∏–Ω—è—Ç–∏–µ –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏–π.

–í —Ö–æ–¥–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏ (–∏—Ö –∑–∞–º–µ–Ω—è–ª–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ—Å—Ç–æ–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏) –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ –≤ —Ä–∞–∑–¥–µ–ª–µ –æ—Ç–¥–µ–ª—ã –±—ã–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø–∏—Å–∞–ª–∏ –∫–∞–∫ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª–∞, –ø–æ—ç—Ç–æ–º—É –∏—Ö –ø—Ä–∏—à–ª–æ—Å—å –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞–ø—Ä–æ–ø—É—Å–∫–∏. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏—à–ª–æ—Å—å —Å–æ–µ–¥–∏–Ω–∏—Ç—å, —á—Ç–æ–±—ã –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ —Ü–µ–ª–µ–≤—ã–º. –î—Ä—É–≥–∏—Ö –æ–ø–µ—á–∞—Ç–æ–∫ –∏ –æ—à–∏–±–æ–∫ –Ω–µ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –≥–æ—Ç–æ–≤—ã –∫ –¥–∞–ª—å–Ω–µ–π—â–µ–º—É –∞–Ω–∞–ª–∏–∑—É.

–í —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Ö–æ–∂–∏.–ë—ã–ª —Å–æ—Å—Ç–∞–≤–ª–µ–Ω –ø–æ—Ä—Ç—Ä–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞: –≤ —Å—Ä–µ–¥–Ω–µ–º —Ä–∞–±–æ—Ç–∞–µ—Ç 3 –≥–æ–¥–∞, –º–∞–∫—Å–∏–º—É–º 10, –ª—É—á—à–∞—è –æ—Ü–µ–Ω–∫–∞ —ç—Ç–æ 5 (–∫–∞–∫ –∏ —Å–ª–µ–¥–æ–≤–∞–ª–æ –æ–∂–∏–¥–∞—Ç—å), –≤ —Å—Ä–µ–¥–Ω–µ–º —ç—Ç–æ 3,5 ( –ø–æ –º–µ–¥–∏–∞–Ω–µ 4) –¥–∞ –∏ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –æ—Ü–µ–Ω–æ–∫ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É 3 –∏ 4, –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ –æ—Ç 12 –¥–æ 98,4 —Ç—ã—Å., –∞ –≤—Å—Ä–µ–¥–Ω–µ–º —Å–æ—Å—Ç–æ–≤–ª—è–µ—Ç 30 —Ç—ã—Å. (–º–µ–¥–∏–∞–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–ª–∏–∫–æ), –∑–Ω–∞—á–µ–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç —Ä–∞–±–æ—Ç—ã –µ—Å—Ç—å —Ä–∞–∑–Ω–æ–µ, –Ω–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —ç—Ç–æ 0.5. 
–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—ã –æ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ—Å—Ç–∏ –∏ —É—Ä–æ–≤–Ω—è –∑–∞–Ω–∏–º–∞–µ–º–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏, —É—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞–∂–∞, –∞ —Ç–∞–∫–∂–µ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –æ—Ç –Ω–µ—ë. –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö –ª–∏–±–æ –º–ª–∞–¥—à–∏–µ –ª–∏–±–æ —Å—Ä–µ–¥–Ω–µ–µ.

–ë—ã–ª–∏ –æ–±—É—á–µ–Ω—ã –¥–≤–µ –º–æ–¥–µ–ª–∏ (–¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π –∏ –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è) —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –±—ã–ª–∞ –ø–æ–ª—É—á–µ–Ω–∞ –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç —Ä–∞–±–æ—Ç—ã: DecisionTreeRegressor(max_depth=14, max_features=10,random_state=100)). –ï—ë –º–µ—Ç—Ä–∏–∫–∞ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ–≤–ª—è–µ—Ç 13.9711, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –ø—Ä–∏–µ–º–ª–µ–Ω–æ—Å—Ç–∏ –µ—ë –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.

–ü–æ—Ä—Ç—Ä–µ—Ç —É–≤–æ–ª–∏–≤—à–µ–≥–æ—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º: —Ä–∞–±–æ—Ç–∞–ª –Ω–µ –±–æ–ª–µ–µ 4 –ª–µ—Ç, –∏–º–µ–µ—Ç –∑–∞—Ä–ø–ª–∞—Ç—É –Ω–µ –±–æ–ª–µ–µ 40 —Ç—ã—Å., –∏–º–µ–µ—Ç –º–ª–∞–¥—â–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–µ –ø–æ–ª—É—á–∞–ª –ø–æ–≤—ã—à–µ–Ω–∏–π. –≠—Ç–æ –≤—Å–µ –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç –∏—Å–∫–∞—Ç—å –¥—Ä—É–≥–∏—É—é —Ä–∞–±–æ—Ç—É. –¢–∞–∫–∂–µ –ø—Ä–∏ –¥–∞–ª—å–Ω–µ–π—â–µ–º –∞–Ω–∞–ª–∏–∑–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç —Ä–∞–±—Ç—ã –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ —É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —É–≤–æ–ª–∏–≤—à–∏—Ö—Å—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –Ω–µ –±–æ–ª—å—à–µ 0,5.

–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π: –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π, –º–µ—Ç–æ–¥ –±–ª–∏–∂–Ω–∏—Ö —Å–æ—Å–µ–¥–µ–π –∏ –º–µ—Ç–æ–¥ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞.–õ—É—á—à–µ–π –º–æ–¥–µ–ª—å—é –æ–∫–∞–∑–∞–ª–∞—Å—å RandomForestClassifier(). –ù–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã–µ –µ—ë –º–µ—Ç—Ä–∏–∫–∞ 0.9327, –∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö 0.9252. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –º–æ–¥–µ–ª—å –≤–ø–æ–ª–Ω–µ —É—Å–ø–µ—à–Ω–∞. –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —É–≤–æ–ª—å–Ω–µ–Ω–∏—è –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ —Å–ª–æ–∂–Ω–∞.

–í –∫–∞—á–µ—Å—Ç–≤–µ —Å–æ–≤–µ—Ç–∞: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–æ—â–µ—Ä—è—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ–≤—ã—à–µ–Ω–∏—è–º–∏ –∏ —Ö–æ—Ä–æ—à–∏–º–∏ –∑–∞—Ä–ø–ª–∞—Ç–∞–º–∏. –ú–Ω–æ–≥–∏–µ —É—Ö–æ–¥—è—Ç, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –º–µ—Å—Ç–æ –ø–æ –ª—É—á—à–µ –Ω–µ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–≤ –∏ 4 –≥–æ–¥–∞. –≠—Ç–∏ 4 –≥–æ–¥–∞ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –∏—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –∏–º–µ—é—â–∏—Ö –Ω–∏–∑–∫–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–æ—Å—Ç–æ–≤–ª–µ–Ω–∏—è –ø–ª–∞–Ω–∞ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –æ–Ω–∏ –º–æ–≥—É—Ç —É–≤–æ–ª–∏—Ç—å—Å—è.




<div class="alert alert-success">
<b>üëç –£—Å–ø–µ—Ö:</b> –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ë—ã–ª–æ –æ—á–µ–Ω—å –ø—Ä–∏—è—Ç–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç!

–û—Å—Ç–∞–≤–ª—é —Ö–æ—Ä–æ—à–∏–π —É—á–µ–±–Ω–∏–∫ –ø–æ ML:
+  https://academy.yandex.ru/handbook/ml

–ù–µ–º–Ω–æ–≥–æ –Ω–æ–≤–æ—Å—Ç–µ–π —Å –º–∏—Ä–∞ DL(–≤–¥—Ä—É–≥ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç):
+  https://habr.com/ru/company/ods/blog/686962/

–í–æ—Ç —Ç—É—Ç –ø—Ä–æ—Ö–æ–¥—è—Ç –≤—Å—è–∫–∏–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è, –º–æ–∂–µ—à—å —Å–µ–±—è –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
+  https://hacks-ai.ru/


–í–æ–∑–º–æ–∂–Ω–æ, —á—Ç–æ –Ω–∏—Ç—å –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è:
+  https://arxiv.org/ftp/arxiv/papers/2201/2201.00650.pdf
+  https://github.com/slgero/testovoe


–ö—É—Ä—Å –æ—Ç –ú–§–¢–ò –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –¥–ª—è DS:

+  https://www.youtube.com/watch?v=xccjt6lOoow&list=PLk4h7dmY2eYHHTyfLyrl7HmP-H3mMAW08&index=1


–¢—É—Ç –º–Ω–æ–≥–æ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π/–ª–µ–∫—Ü–∏–π:

+  https://ods.ai/

stepic NLP/CV:

+  https://stepik.org/course/54098/syllabus
+  https://stepik.org/course/50352/syllabus

–ï—â–µ –µ—Å—Ç—å –æ—Ç –í–®–≠:

+  https://www.youtube.com/watch?v=mwjQaNt8qxk&list=PLEwK9wdS5g0og-DcF1apxutSM0GDLHz_3&ab_channel=%D0%A4%D0%9A%D0%9D%D0%92%D0%A8%D0%AD%E2%80%94%D0%B4%D0%B8%D1%81%D1%82%D0%B0%D0%BD%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B5%D0%B7%D0%B0%D0%BD%D1%8F%D1%82%D0%B8%D1%8F
+  https://github.com/hse-ds/iad-deep-learning

–£–¥–∞—á–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö!!!
</div>


```python

```
